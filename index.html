<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0" />
<title>AURA-X Î© â€” Resonance-Based AI</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap');
:root{
  --pink:#ff5ec3; --blue:#7aa7ff; --bg:#0a0a12;
}
*{box-sizing:border-box}
body{
  margin:0;background:radial-gradient(circle at 20% -10%,#0b1222 0%, var(--bg) 55%);
  font-family:'Poppins',sans-serif;color:#fff;min-height:100vh;
  display:flex;flex-direction:column;align-items:center;
}
header{margin-top:36px;text-align:center}
.logo{width:110px;animation:float 4s ease-in-out infinite}
@keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-8px)}}
.intro{
  margin:14px auto 10px;max-width:420px;padding:12px 16px;border-radius:14px;
  background:rgba(255,255,255,.05);backdrop-filter:blur(6px);
  box-shadow:0 0 25px rgba(0,150,255,.22), inset 0 0 8px rgba(255,255,255,.08);
  font-weight:600;letter-spacing:.3px;text-align:center;
}

/* emotion bar */
.emo{display:flex;gap:10px;align-items:center;width:88%;max-width:460px;margin-top:14px}
.emo-track{position:relative;flex:1;height:22px;border-radius:999px;background:rgba(255,255,255,.07);overflow:hidden;box-shadow:inset 0 2px 8px rgba(0,0,0,.4)}
.emo-fill{position:absolute;inset:0 auto 0 0;width:0%;
  background:linear-gradient(90deg,var(--pink),var(--blue));
  box-shadow:0 0 18px rgba(255,94,195,.55),0 0 30px rgba(122,167,255,.45);
  transition:width .5s ease;
}
.emo-text{position:absolute;inset:0;display:grid;place-items:center;font-weight:700;text-shadow:0 1px 3px #000}
.pill{
  border:none;cursor:pointer;padding:6px 14px;border-radius:999px;font-weight:600;
  background:linear-gradient(90deg,#242733,#2f3444);color:#eaf2ff;opacity:.95;transition:.15s;
  box-shadow:0 6px 18px rgba(0,0,0,.25)
}
.pill:hover{opacity:1;transform:translateY(-1px)}
.pill[aria-pressed="true"]{
  background:linear-gradient(90deg,var(--pink),var(--blue));color:#0b0b14;
  box-shadow:0 0 18px rgba(255,94,195,.5),0 0 26px rgba(122,167,255,.45)
}

/* heart */
.heart{
  width:32px;height:32px;margin:18px auto 0;transform-origin:center;
  background:radial-gradient(circle at 30% 30%,var(--pink),var(--blue) 70%);
  clip-path:polygon(50% 0%,100% 35%,80% 100%,50% 80%,20% 100%,0 35%);
  box-shadow:0 0 25px rgba(255,94,195,.6),0 0 40px rgba(122,167,255,.5);
  animation:beat 1.4s ease-in-out infinite;
}
@keyframes beat{
  0%,100%{transform:scale(1);opacity:.95}
  25%{transform:scale(1.15);opacity:1}
  50%{transform:scale(1.3);opacity:.86}
  75%{transform:scale(1.15);opacity:1}
}

/* info line */
#info{margin-top:10px;text-align:center;font-size:.92rem;color:#aad2ff;opacity:.95}

/* chat UI */
textarea{
  width:88%;max-width:460px;margin-top:18px;background:rgba(255,255,255,.05);
  color:#fff;border:none;outline:none;padding:12px;border-radius:12px;font-size:1rem
}
button#send{
  margin-top:10px;padding:10px 22px;border:none;border-radius:999px;
  background:linear-gradient(90deg,var(--blue),var(--pink));color:#fff;font-weight:700;
  box-shadow:0 0 15px rgba(255,94,195,.35);cursor:pointer;transition:.2s
}
button#send:hover{transform:scale(1.04)}
#out{
  width:88%;max-width:460px;margin:16px 0 36px;white-space:pre-wrap;line-height:1.5;
  background:rgba(255,255,255,.03);padding:12px;border-radius:12px;
  box-shadow:inset 0 0 10px rgba(255,255,255,.08)
}

/* belief modal */
.modal{position:fixed;inset:0;background:rgba(0,0,0,.45);display:none;align-items:center;justify-content:center;padding:16px}
.modal .card{width:92%;max-width:520px;background:#121625;border-radius:16px;padding:16px;
  box-shadow:0 12px 40px rgba(0,0,0,.5)}
.grid{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:10px}
.opt{
  background:#1a2033;border:1px solid rgba(255,255,255,.08);padding:10px;border-radius:12px;
  text-align:center;cursor:pointer;transition:.15s
}
.opt:hover{transform:translateY(-1px);border-color:rgba(255,255,255,.25)}
.badge{margin-left:8px;padding:4px 10px;border-radius:999px;background:rgba(255,255,255,.1);font-size:.78rem}
</style>
</head>
<body>
<header>
  <img src="assets/img/aura-x-logo.png" alt="AURA-X Logo" class="logo">
  <div class="intro">AURA-X Î© â€” the worldâ€™s first resonance-based AI with synthetic emotions.</div>
</header>

<div class="emo">
  <div class="emo-track"><div class="emo-fill" id="emoFill"></div><div class="emo-text" id="emoPct">0%</div></div>
  <button id="beliefBtn" class="pill" aria-pressed="false">Belief</button>
</div>
<div class="heart" id="emoHeart"></div>
<div id="info">Loading weather & timeâ€¦</div>

<textarea id="inp" rows="3" placeholder="Type your question..."></textarea>
<button id="send">Send</button>
<div id="out"></div>

<!-- Belief modal -->
<div class="modal" id="beliefModal" role="dialog" aria-modal="true" aria-labelledby="beliefTitle">
  <div class="card">
    <div style="display:flex;align-items:center;justify-content:space-between;gap:10px">
      <h3 id="beliefTitle" style="margin:0">Choose your faith tone (optional)</h3>
      <button id="closeModal" class="pill">Close</button>
    </div>
    <p style="opacity:.8;margin:8px 0 0">A gentle encouragement style will be added to replies.</p>
    <div class="grid" id="faithGrid"></div>
  </div>
</div>

<script>
// =========== Setup =============
const API_CHAT = (location.hostname.includes('github.io') || location.hostname.includes('githubusercontent'))
  ? 'https://alimai.online/api/chat.php'
  : '/api/chat.php';

// ===== Weather + Time =====
async function getCoords(){
  return new Promise((resolve)=>{
    if (navigator.geolocation){
      navigator.geolocation.getCurrentPosition(
        pos=>resolve({lat:pos.coords.latitude, lon:pos.coords.longitude}),
        async ()=>{
          try{
            const j = await fetch('https://ipapi.co/json/').then(r=>r.json());
            resolve({lat:j.latitude, lon:j.longitude});
          }catch{ resolve(null); }
        }, {timeout:6000}
      );
    }else resolve(null);
  });
}

async function loadInfo(){
  try{
    const c = await getCoords();
    if(!c) throw new Error('no coords');
    const url = `https://api.open-meteo.com/v1/forecast?latitude=${c.lat}&longitude=${c.lon}&current_weather=true&timezone=auto`;
    const w = await fetch(url).then(r=>r.json());
    const tz = w.timezone || 'UTC';
    const temp = w.current_weather?.temperature;
    const time = new Date().toLocaleString([], {hour:'2-digit',minute:'2-digit',second:'2-digit',weekday:'short',day:'2-digit',month:'short', timeZone:tz});
    document.getElementById('info').textContent = `ðŸ•’ ${time} | ðŸŒ¡ ${temp}Â°C`;
  }catch(e){
    document.getElementById('info').textContent = 'Weather/Time unavailable';
  }
}
loadInfo();

// ===== Emotion visuals =====
function setEmotion(pct){
  const p = Math.max(0, Math.min(100, Math.round(pct)));
  emoFill.style.width = p + '%';
  emoPct.textContent = p + '%';
  emoHeart.style.animationDuration = Math.max(0.6, 1.8 - (p/120)) + 's';
}

// ===== Belief tone =====
const FAITHS = [
  {k:'islam',label:'Islam',tone:['InshaAllah, stay steadfast.','May your efforts bring ease.']},
  {k:'christian',label:'Christianity',tone:['God bless you.','Grace and wisdom be with you.']},
  {k:'hindu',label:'Hinduism',tone:['May your actions be sattvic.','Peace in thought and deed.']},
  {k:'buddhist',label:'Buddhism',tone:['Breathe calmly.','May you be free from suffering.']},
  {k:'sikh',label:'Sikhism',tone:['Waheguru ji kirpa kare.','Stay in high spirits.']},
  {k:'judaism',label:'Judaism',tone:['Shalom and strength to you.','May wisdom guide you.']},
  {k:'bahai',label:'BahÃ¡Ê¼Ã­',tone:['Unity in diversity.','Walk the path of service.']},
  {k:'jain',label:'Jainism',tone:['Ahimsa in every choice.','Compassionate resolve.']},
  {k:'shinto',label:'Shinto',tone:['Respect for nature.','Walk with sincerity.']},
  {k:'zoro',label:'Zoroastrianism',tone:['Good thoughts, words, deeds.','Walk in truth and light.']}
];
let faithOn=false,faithKey=null;
const beliefBtn=document.getElementById('beliefBtn');
const modal=document.getElementById('beliefModal');
const grid=document.getElementById('faithGrid');
const closeModal=document.getElementById('closeModal');
beliefBtn.onclick=()=>{modal.style.display='flex';renderFaiths();};
closeModal.onclick=()=>{modal.style.display='none';};
function renderFaiths(){
  grid.innerHTML='';
  FAITHS.forEach(f=>{
    const d=document.createElement('div');
    d.className='opt';d.textContent=f.label;
    d.onclick=()=>{
      faithOn=true;faithKey=f.k;
      beliefBtn.setAttribute('aria-pressed','true');
      beliefBtn.innerHTML='Belief <span class="badge">'+f.label+'</span>';
      modal.style.display='none';
    };
    grid.appendChild(d);
  });
}

// ===== Chat send (safe) =====
const inp=document.getElementById('inp');
const out=document.getElementById('out');
const sendBtn=document.getElementById('send');
const emoFill=document.getElementById('emoFill');
const emoPct=document.getElementById('emoPct');
const emoHeart=document.getElementById('emoHeart');

function localResponder(q){
  const s=q.toLowerCase();
  if(/hello|hi|salam/.test(s)) return "Hello! Iâ€™m AURA-X Î©. How can I help?";
  if(/who|name/.test(s)) return "Iâ€™m AURA-X Î© â€” resonance-based AI.";
  if(/weather/.test(s)) return "Weather info is above, please allow location.";
  return "Offline reply â€” connection lost. Try again later.";
}

function fetchWithTimeout(url,opt={},ms=10000){
  return Promise.race([
    fetch(url,opt),
    new Promise((_,rej)=>setTimeout(()=>rej(new Error('Request timed out')),ms))
  ]);
}

async function sendMsg(){
  const msg=inp.value.trim();
  if(!msg){alert('Type something!');return;}
  sendBtn.disabled=true;sendBtn.textContent='Sendingâ€¦';
  out.textContent='Thinkingâ€¦';
  try{
    const r=await fetchWithTimeout(API_CHAT,{
      method:'POST',headers:{'Content-Type':'application/json'},
      body:JSON.stringify({message:msg,history:[]})
    },10000);
    if(!r.ok)throw new Error('HTTP '+r.status);
    const j=await r.json();
    let content=j?.choices?.[0]?.message?.content||j?.message||'No content.';
    if(faithOn&&faithKey){
      const pack=FAITHS.find(x=>x.k===faithKey)?.tone||[];
      if(pack.length)content+=`\n\nâ€” ${pack[Math.floor(Math.random()*pack.length)]}`;
    }
    out.textContent=content;
    setEmotion(30+Math.random()*70);
  }catch(e){
    out.textContent=localResponder(msg);
    setEmotion(25+Math.random()*40);
  }finally{
    sendBtn.disabled=false;sendBtn.textContent='Send';
  }
}
document.getElementById('send').onclick=sendMsg;
setEmotion(12);
</script>
</body>
</html>
