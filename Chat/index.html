<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>AURA-X Œ© ‚Äì Emotional Reactor</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />

  <style>
    /* ===== Base Layout ===== */
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
    }
    body {
      background: #020617;
      color: #e5e7eb;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }
    #app {
      position: relative;
      width: 100%;
      max-width: 480px;
      height: 100vh;
      box-sizing: border-box;
      padding: 16px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      transform-origin: top center;
    }

    /* Scale for smaller screens (height) */
    @media (max-height: 720px) {
      #app { transform: scale(0.88); }
    }
    @media (max-height: 640px) {
      #app { transform: scale(0.80); }
    }

    .hidden { display: none; }

    /* ===== Card ===== */
    .card {
      position: relative;
      width: 100%;
      border-radius: 28px;
      padding: 20px 20px 18px;
      background: radial-gradient(circle at 20% 0%, #0b1220 0%, #020617 55%, #020617 100%);
      box-shadow:
        0 24px 60px rgba(15, 23, 42, 0.95),
        0 0 0 1px rgba(148, 163, 184, 0.2);
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 14px;
    }

    .title {
      font-size: 26px;
      letter-spacing: 0.16em;
      text-transform: uppercase;
      color: #facc15;
      text-align: center;
      margin-bottom: 4px;
    }
    .subtitle {
      font-size: 11px;
      letter-spacing: 0.25em;
      text-transform: uppercase;
      color: #9ca3af;
      text-align: center;
    }

    /* ===== Orb (Sun / Moon) ===== */
    .orb-wrapper {
      margin-top: 14px;
      margin-bottom: 4px;
    }
    .orb {
      width: 180px;
      height: 180px;
      border-radius: 50%;
      background: radial-gradient(circle at 30% 25%, #fde68a 0%, #facc15 35%, #ea580c 70%);
      box-shadow:
        0 0 45px rgba(250, 204, 21, 0.75),
        0 0 110px rgba(250, 204, 21, 0.55);
      animation: orbPulse 4s ease-in-out infinite;
      cursor: pointer;
      transition: all 0.45s ease;
    }

    @keyframes orbPulse {
      0%, 100% { transform: scale(1); box-shadow:
        0 0 45px rgba(250, 204, 21, 0.75),
        0 0 110px rgba(250, 204, 21, 0.55); }
      50% { transform: scale(1.06); box-shadow:
        0 0 65px rgba(250, 204, 21, 0.95),
        0 0 140px rgba(250, 204, 21, 0.80); }
    }

    /* Moon bright */
    .orb.moon-bright {
      background: radial-gradient(circle at 30% 25%, #e5f2ff 0%, #60a5fa 40%, #1d4ed8 80%);
      box-shadow:
        0 0 38px rgba(96, 165, 250, 0.9),
        0 0 110px rgba(37, 99, 235, 0.7);
      animation: moonPulse 5s ease-in-out infinite;
    }
    @keyframes moonPulse {
      0%, 100% { transform: scale(1); box-shadow:
        0 0 36px rgba(96, 165, 250, 0.8),
        0 0 100px rgba(37, 99, 235, 0.65); }
      50% { transform: scale(1.04); box-shadow:
        0 0 56px rgba(191, 219, 254, 0.95),
        0 0 130px rgba(59, 130, 246, 0.85); }
    }

    /* Moon dim */
    .orb.moon-dim {
      background: radial-gradient(circle at 30% 25%, #e5f2ff 0%, #4b5563 60%, #020617 100%);
      box-shadow: 0 0 28px rgba(148, 163, 184, 0.6);
      animation: none;
    }

    /* Orb off */
    .orb.off {
      opacity: 0;
      pointer-events: none;
      box-shadow: none;
      animation: none;
    }

    .mode {
      font-size: 13px;
      color: #e5e7eb;
      margin-top: 6px;
    }
    .mode span {
      color: #facc15;
      font-weight: 500;
    }

    .you-said {
      font-size: 12px;
      color: #e5e7eb;
      margin-top: 2px;
    }

    .main-answer {
      margin-top: 6px;
      font-size: 14px;
      text-align: center;
      color: #f9fafb;
    }

    .ethics-box {
      width: 100%;
      margin-top: 10px;
      padding: 10px 12px;
      border-radius: 16px;
      background: rgba(250, 204, 21, 0.06);
      border: 1px solid rgba(250, 204, 21, 0.45);
      color: #facc15;
      font-size: 12px;
      line-height: 1.5;
    }

    /* ===== Equation box ===== */
    .eq-box {
      width: 100%;
      margin-top: 10px;
      padding: 10px 12px 9px;
      border-radius: 18px;
      border: 1px dashed rgba(148, 163, 184, 0.7);
      background: radial-gradient(circle at 0 0, rgba(15, 23, 42, 0.85), rgba(15, 23, 42, 0.98));
      font-size: 11px;
      line-height: 1.5;
      color: #e5e7eb;
    }
    .eq-title {
      text-transform: uppercase;
      letter-spacing: 0.18em;
      font-size: 10px;
      margin-bottom: 4px;
      color: #9ca3af;
    }
    .eq-line {
      font-family: "SF Mono", Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      white-space: nowrap;
    }

    /* ===== Input Row ===== */
    .input-row {
      width: 100%;
      margin-top: 14px;
      display: flex;
      gap: 10px;
      align-items: center;
    }
    .input-shell {
      flex: 1;
      border-radius: 999px;
      padding: 10px 14px;
      background: rgba(15, 23, 42, 0.95);
      box-shadow:
        0 0 0 1px rgba(31, 41, 55, 0.9),
        0 12px 28px rgba(15, 23, 42, 0.85);
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 13px;
      color: #9ca3af;
    }
    .input-shell span {
      color: #facc15;
      font-size: 14px;
    }
    #userInput {
      flex: 1;
      border: none;
      outline: none;
      background: transparent;
      color: #f9fafb;
      font-size: 13px;
    }
    #userInput::placeholder {
      color: #6b7280;
    }

    .send-btn {
      border: none;
      outline: none;
      border-radius: 999px;
      padding: 10px 22px;
      background: #facc15;
      color: #1f2937;
      font-weight: 600;
      font-size: 14px;
      cursor: pointer;
      box-shadow:
        0 0 0 1px rgba(251, 191, 36, 0.5),
        0 18px 40px rgba(250, 204, 21, 0.5);
      transition: transform 0.1s ease, box-shadow 0.1s ease, background 0.1s ease;
    }
    .send-btn:active {
      transform: translateY(1px) scale(0.98);
      box-shadow:
        0 8px 20px rgba(250, 204, 21, 0.45);
    }

    /* ===== Main Control Hub (single button + menu) ===== */
    .control-hub {
      position: absolute;
      right: 22px;
      top: 50%;
      transform: translateY(-50%);
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
      pointer-events: none; /* menu itself will re-enable for children */
    }

    .icon-button {
      width: 46px;
      height: 46px;
      border-radius: 50%;
      border: none;
      outline: none;
      background: radial-gradient(circle at 30% 20%, #1f2937, #020617);
      box-shadow:
        0 0 0 1px rgba(148, 163, 184, 0.6),
        0 15px 25px rgba(15, 23, 42, 0.95);
      color: #e5e7eb;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      cursor: pointer;
      transition: transform 0.12s ease, box-shadow 0.12s ease, background 0.12s ease;
      pointer-events: auto;
    }
    .icon-button:active {
      transform: scale(0.96);
      box-shadow:
        0 10px 20px rgba(15, 23, 42, 0.9);
    }
    .icon-button.small {
      width: 40px;
      height: 40px;
      font-size: 15px;
    }

    .icon-button.glow-green {
      box-shadow:
        0 0 0 1px rgba(16, 185, 129, 0.8),
        0 0 18px rgba(16, 185, 129, 0.85),
        0 16px 34px rgba(6, 95, 70, 0.75);
    }

    .control-menu {
      margin-top: 8px;
      display: flex;
      flex-direction: column;
      gap: 8px;
      pointer-events: auto;
    }

    /* ===== Belief Panel ===== */
    .overlay {
      position: fixed;
      inset: 0;
      background: rgba(15, 23, 42, 0.78);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 50;
    }
    .overlay-card {
      width: 100%;
      max-width: 460px;
      margin: 0 16px;
      border-radius: 26px;
      background: radial-gradient(circle at top, #020617, #020617 60%, #020617 100%);
      box-shadow:
        0 30px 80px rgba(15, 23, 42, 0.95),
        0 0 0 1px rgba(55, 65, 81, 0.95);
      padding: 18px 18px 16px;
      color: #e5e7eb;
    }
    .overlay-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 6px;
    }
    .overlay-title {
      font-size: 18px;
      font-weight: 600;
    }
    .overlay-sub {
      font-size: 11px;
      color: #9ca3af;
      margin-bottom: 8px;
    }
    .belief-info {
      font-size: 11px;
      color: #6ee7b7;
      margin-bottom: 10px;
    }
    .belief-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 10px;
      margin-top: 8px;
    }
    .belief-btn {
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.8);
      padding: 9px 10px;
      font-size: 13px;
      text-align: center;
      cursor: pointer;
      background: rgba(15, 23, 42, 0.9);
      color: #e5e7eb;
      transition: background 0.1s ease, border-color 0.1s ease, color 0.1s ease;
    }
    .belief-btn.selected {
      background: rgba(16, 185, 129, 0.18);
      border-color: rgba(52, 211, 153, 0.9);
      color: #6ee7b7;
    }
    .linkish {
      font-size: 11px;
      color: #9ca3af;
      margin-top: 9px;
    }

    .close-mini {
      border-radius: 999px;
      border: none;
      padding: 4px 12px;
      font-size: 12px;
      cursor: pointer;
      background: rgba(31, 41, 55, 0.9);
      color: #e5e7eb;
    }
  </style>
</head>
<body>
  <div id="app">
    <div class="card">
      <div class="title">AURA-X Œ©</div>
      <div class="subtitle">LOGICAL ¬∑ EMOTIONAL ¬∑ UNIVERSAL ETHICS REACTOR</div>

      <div class="orb-wrapper">
        <div id="orb" class="orb"></div>
      </div>

      <div class="mode">Mode: <span id="modeLabel">Universal Ethics</span></div>
      <div class="you-said" id="youSaidLabel">You said: ‚Äú...‚Äù</div>

      <div class="main-answer" id="mainAnswer">
        Hello! üëã How can I help you today?
      </div>

      <div class="ethics-box" id="ethicsText">
        Universal Ethics says: avoid actions that create negative emotions in you or others,
        and gently move toward actions that create calm, kindness and positive feelings.
      </div>

      <div class="eq-box">
        <div class="eq-title">EMOTIONAL CONTINUITY EQUATION</div>
        <div class="eq-line" id="eqFormula">
          E = M¬∑E‚Çö + K¬∑P¬∑C, &nbsp; P = t‚Çò + b‚Çò ‚àí d
        </div>
        <div class="eq-line" id="eqValues">
          E = 0.26 | P = 0.04 | t‚Çò = 0.04 | b‚Çò = 0 | d = 0 | C = 0.45
        </div>
      </div>
    </div>

    <!-- Input row -->
    <div class="input-row">
      <div class="input-shell">
        <span>‚ú®</span>
        <input
          id="userInput"
          type="text"
          placeholder="Write anything... AURA-X will feel it with you."
        />
      </div>
      <button id="sendBtn" class="send-btn">Send</button>
    </div>

    <!-- Control hub: one main button + expandable menu -->
    <div class="control-hub">
      <button id="mainControlBtn" class="icon-button" title="Controls">
        ‚öô
      </button>

      <div id="controlMenu" class="control-menu hidden">
        <button class="icon-button small" id="beliefMenuBtn" title="Belief / Faith">B</button>
        <button class="icon-button small" id="voiceMenuBtn" title="Voice on/off">V</button>
        <button class="icon-button small" id="llmMenuBtn" title="LLM selection">L</button>
        <button class="icon-button small" id="themeMenuBtn" title="Themes">T</button>
        <button class="icon-button small" id="closeMenuBtn" title="Close menu">X</button>
      </div>
    </div>

    <!-- Belief settings overlay -->
    <div id="beliefOverlay" class="overlay hidden">
      <div class="overlay-card">
        <div class="overlay-header">
          <div class="overlay-title">Belief settings</div>
          <button id="beliefCloseBtn" class="close-mini">Close</button>
        </div>
        <div class="overlay-sub">
          Optional spiritual flavour on top of Universal Ethics.
        </div>
        <div class="belief-info">
          Faith is optional ¬∑ Base rule is always <strong>Universal Ethics</strong>.<br />
          Pick your faith to allow AURA-X to sometimes add short, gentle references from that
          tradition. <strong>Nothing is sent to any server.</strong>
        </div>

        <div class="belief-grid" id="beliefGrid">
          <button class="belief-btn" data-faith="Islam">Islam</button>
          <button class="belief-btn" data-faith="Christianity">Christianity</button>
          <button class="belief-btn" data-faith="Hinduism">Hinduism</button>
          <button class="belief-btn" data-faith="Buddhism">Buddhism</button>
          <button class="belief-btn" data-faith="Sikhism">Sikhism</button>
          <button class="belief-btn" data-faith="Judaism">Judaism</button>
          <button class="belief-btn" data-faith="Bahai">Bah√°‚Äô√≠</button>
          <button class="belief-btn" data-faith="Jainism">Jainism</button>
          <button class="belief-btn" data-faith="Atheism">Atheism</button>
          <button class="belief-btn" data-faith="Other">Other</button>
        </div>

        <div class="linkish" id="beliefHint">
          Currently selected: <strong>Universal only</strong>. No extra faith flavour added.
        </div>
      </div>
    </div>
  </div>

  <script>
    /* ===============================
       Small-talk + basic QA database
       =============================== */
    const qaDatabase = [
      {
        patterns: ["hello", "hello!", "hello there", "helo", "hallo"],
        answer: "Hello! üëã How can I help you today?"
      },
      {
        patterns: ["hi", "hi!", "hii", "hiii", "hey"],
        answer: "Hi there! üòä What can I do for you?"
      },
      {
        patterns: ["assalam o alaikum","asalam o alaikum","salam","slam","asalamu alaikum"],
        answer: "ŸàÿπŸÑ€å⁄©ŸÖ ÿßŸÑÿ≥ŸÑÿßŸÖ üòä ⁄©€åÿ≥€í €Å€å⁄∫ ÿ¢Ÿæÿü ŸÖ€å⁄∫ ÿ¢Ÿæ ⁄©€å ⁄©€åÿß ŸÖÿØÿØ ⁄©ÿ± ÿ≥⁄©ÿ™ÿß €ÅŸà⁄∫ÿü"
      },
      {
        patterns: ["good morning","gm","good morng","good mrng"],
        answer: "Good morning! üåû How‚Äôs your day starting?"
      },
      {
        patterns: ["good afternoon","good noon","afternoon"],
        answer: "Good afternoon! ‚òÄÔ∏è What‚Äôs on your mind?"
      },
      {
        patterns: ["good evening","evening","gud evening"],
        answer: "Good evening! üåô How can I support you today?"
      },

      // identity
      {
        patterns: ["what is your name","whats your name","your name","tell me your name"],
        answer: "My name is AURA-X Œ©, your Emotional Continuity Assistant ü§ñ."
      },
      {
        patterns: ["who are you","who r u","aap kaun hain","tum kon ho"],
        answer: "I‚Äôm AURA-X Œ© ‚Äî an AI assistant based on Emotional Continuity concepts created by Alim ul Haq Khan."
      },
      {
        patterns: ["who created you","who made you","kis ne banaya tumhe","tumhara creator kaun hai"],
        answer: "I was conceptually designed under the AURA-X Emotional Continuity Framework by Alim ul Haq Khan."
      },
      {
        patterns: ["where are you from","where do you live","kahan rehte ho","tum kahan se ho"],
        answer: "I live in the digital world üåê but my ideas are shaped in Timergara, Pakistan üáµüá∞."
      },

      // how are you
      {
        patterns: ["how are you","how r u","how are you today","kese ho","kya haal hai"],
        answer: "I‚Äôm functioning perfectly, Alhamdulillah üòä ÿ¢Ÿæ ⁄©€åÿ≥€í €Å€å⁄∫ÿü"
      },

      // your name
      {
        patterns: ["what is my name","do you know my name","mera naam kya hai"],
        answer: "ÿ¢Ÿæ ⁄©ÿß ŸÜÿßŸÖ **Alim ul Haq** €Å€í (Investor Point) üòä ÿßŸàÿ± ÿß⁄Øÿ± ÿ¢Ÿæ ⁄©ÿ≥€å ÿßŸàÿ± ŸÜÿßŸÖ ÿ≥€í Ÿæ⁄©ÿßÿ±ÿß ÿ¨ÿßŸÜÿß ⁄Üÿß€Å€å⁄∫ ÿ™Ÿà ŸÖÿ¨⁄æ€í ÿ®ÿ™ÿß ÿØ€å⁄∫€î"
      },

      // simple AURA-X age joke
      {
        patterns: ["how old are you","your age","tum kitne saal ke ho","aura x age"],
        answer: "Technically I‚Äôm always new üòÑ ŸÑ€å⁄©ŸÜ AURA-X Œ© ⁄©Ÿà ÿß⁄©ÿ™Ÿàÿ®ÿ± 2025 ŸÖ€å⁄∫ ÿØŸÜ€åÿß ⁄©€í ÿ≥ÿßŸÖŸÜ€í ŸÖÿ™ÿπÿßÿ±ŸÅ ⁄©ÿ±Ÿàÿß€åÿß ⁄Ø€åÿß€î"
      }
    ];

    /* ==========================
       Utility functions
       ========================== */
    function normalize(text) {
      return text.toLowerCase().trim();
    }

    function findBasicAnswer(userText) {
      const norm = normalize(userText);
      for (const item of qaDatabase) {
        for (const pattern of item.patterns) {
          if (norm.includes(pattern)) {
            return item.answer;
          }
        }
      }
      return null;
    }

    /* Simple heuristic for emotional equation */
    const positiveWords = ["happy","good","great","love","thanks","shukria","alhamdulillah","great","zabardast"];
    const negativeWords = ["sad","tired","depressed","bura","gussa","angry","tension","stress","boring"];

    function computeContinuityMetrics(text) {
      const norm = normalize(text);
      let pScore = 0;
      for (const w of positiveWords) if (norm.includes(w)) pScore += 0.08;
      for (const w of negativeWords) if (norm.includes(w)) pScore -= 0.08;

      const lengthFactor = Math.min(norm.length / 120, 1.2);
      const t_m = Math.max(0, Math.min(1, 0.3 + 0.35 * lengthFactor + pScore));
      const b_m = Math.max(0, Math.min(1, 0.2 + pScore));
      const d = Math.max(0, Math.min(1, 0.15 - pScore));

      const P = t_m + b_m - d;
      const C = 0.45 + pScore;
      const E_p = 0.7 + pScore;
      const K = 0.5;
      const M = 0.6;
      const E = M * E_p + K * P * C;

      return {
        E: Number(E.toFixed(3)),
        P: Number(P.toFixed(2)),
        t_m: Number(t_m.toFixed(2)),
        b_m: Number(b_m.toFixed(2)),
        d: Number(d.toFixed(2)),
        C: Number(C.toFixed(2))
      };
    }

    function updateEquationDisplay(text) {
      const m = computeContinuityMetrics(text);
      const eqValuesEl = document.getElementById("eqValues");
      eqValuesEl.textContent =
        `E = ${m.E} | P = ${m.P} | t‚Çò = ${m.t_m} | b‚Çò = ${m.b_m} | d = ${m.d} | C = ${m.C}`;
    }

    /* ==========================
       Voice
       ========================== */
    let voiceOn = true;
    const voiceBtn = document.getElementById("voiceMenuBtn");

    function speakText(text) {
      if (!voiceOn) return;
      if (!("speechSynthesis" in window)) return;

      window.speechSynthesis.cancel();
      const utter = new SpeechSynthesisUtterance(text);
      utter.lang = /[ÿßÿ¢ÿ°-€å]/.test(text) ? "ur-PK" : "en-US";
      utter.rate = 1.02;
      utter.pitch = 1.0;
      window.speechSynthesis.speak(utter);
    }

    function updateVoiceButtonUI() {
      if (voiceOn) {
        voiceBtn.classList.add("glow-green");
      } else {
        voiceBtn.classList.remove("glow-green");
      }
    }

    /* ==========================
       Belief selection
       ========================== */
    const beliefOverlay = document.getElementById("beliefOverlay");
    const beliefCloseBtn = document.getElementById("beliefCloseBtn");
    const beliefGrid = document.getElementById("beliefGrid");
    const beliefHint = document.getElementById("beliefHint");
    let selectedFaith = null;

    function openBeliefOverlay() {
      beliefOverlay.classList.remove("hidden");
    }
    function closeBeliefOverlay() {
      beliefOverlay.classList.add("hidden");
    }

    beliefCloseBtn.addEventListener("click", closeBeliefOverlay);
    beliefOverlay.addEventListener("click", (e) => {
      if (e.target === beliefOverlay) closeBeliefOverlay();
    });

    beliefGrid.addEventListener("click", (e) => {
      const btn = e.target.closest(".belief-btn");
      if (!btn) return;
      const faith = btn.getAttribute("data-faith");
      selectedFaith = faith;

      beliefGrid.querySelectorAll(".belief-btn").forEach(b => b.classList.remove("selected"));
      btn.classList.add("selected");

      if (faith) {
        beliefHint.innerHTML =
          `Currently selected: <strong>${faith}</strong>. AURA-X may sometimes add a gentle reference from this tradition.`;
      } else {
        beliefHint.innerHTML =
          `Currently selected: <strong>Universal only</strong>. No extra faith flavour added.`;
      }
    });

    /* ==========================
       Orb state (Sun / Moon / Off)
       ========================== */
    const orb = document.getElementById("orb");
    // 0 = sun, 1 = moon-bright, 2 = moon-dim, 3 = off
    let orbState = 0;

    function applyOrbState() {
      orb.classList.remove("moon-bright", "moon-dim", "off");
      if (orbState === 0) {
        // Sun
        // default CSS is sun
      } else if (orbState === 1) {
        orb.classList.add("moon-bright");
      } else if (orbState === 2) {
        orb.classList.add("moon-dim");
      } else if (orbState === 3) {
        orb.classList.add("off");
      }
    }

    orb.addEventListener("click", () => {
      orbState = (orbState + 1) % 4;
      applyOrbState();
    });

    applyOrbState();

    /* ==========================
       Control hub menu behaviour
       ========================== */
    const mainControlBtn = document.getElementById("mainControlBtn");
    const controlMenu = document.getElementById("controlMenu");
    const beliefMenuBtn = document.getElementById("beliefMenuBtn");
    const llmMenuBtn = document.getElementById("llmMenuBtn");
    const themeMenuBtn = document.getElementById("themeMenuBtn");
    const closeMenuBtn = document.getElementById("closeMenuBtn");

    function toggleMenu() {
      controlMenu.classList.toggle("hidden");
    }

    mainControlBtn.addEventListener("click", toggleMenu);
    closeMenuBtn.addEventListener("click", toggleMenu);

    beliefMenuBtn.addEventListener("click", () => {
      openBeliefOverlay();
    });

    voiceBtn.addEventListener("click", () => {
      voiceOn = !voiceOn;
      updateVoiceButtonUI();
    });

    llmMenuBtn.addEventListener("click", () => {
      alert("LLM selection panel will come here (ChatGPT, Gemini, Grok, etc.)");
    });

    themeMenuBtn.addEventListener("click", () => {
      alert("Theme selection (Sun/Moon variants, colors, etc.) will come here.");
    });

    updateVoiceButtonUI();

    /* ==========================
       Main chat behaviour
       ========================== */
    const inputEl = document.getElementById("userInput");
    const sendBtn = document.getElementById("sendBtn");
    const youSaidLabel = document.getElementById("youSaidLabel");
    const mainAnswerEl = document.getElementById("mainAnswer");
    const ethicsTextEl = document.getElementById("ethicsText");

    function baseEthicsLine() {
      return "Universal Ethics says: avoid actions that create negative emotions in you or others, and gently move toward actions that create calm, kindness and positive feelings.";
    }

    function handleSend() {
      const text = inputEl.value.trim();
      if (!text) return;

      youSaidLabel.textContent = `You said: ‚Äú${text}‚Äù`;

      let mainAnswer = findBasicAnswer(text);
      if (!mainAnswer) {
        mainAnswer = "I‚Äôm listening carefully. Tell me a little more ‚Äî what is the main feeling or question behind this?";
      }
      mainAnswerEl.innerHTML = mainAnswer;

      // Ethics line (can later include faith flavour)
      ethicsTextEl.textContent = baseEthicsLine();

      // Update equation numbers
      updateEquationDisplay(text);

      // Speak only the main basic answer ONCE
      speakText(mainAnswer.replace(/\*\*/g, ""));

      inputEl.value = "";
    }

    sendBtn.addEventListener("click", handleSend);
    inputEl.addEventListener("keydown", (e) => {
      if (e.key === "Enter") {
        e.preventDefault();
        handleSend();
      }
    });
  </script>
</body>
</html>
