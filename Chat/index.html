<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>AURA-X Œ© ‚Äì Emotional Reactor</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    /* ===== Base Layout ===== */
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
    }
    body {
      background: #020617;
      color: #e5e7eb;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text",
        "Segoe UI", sans-serif;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      transition: background 0.6s ease;
    }
    body.day-mode {
      background: radial-gradient(circle at 50% 0%, #0f172a 0, #020617 70%);
    }
    body.night-mode {
      background: radial-gradient(circle at 50% 0%, #020617 0, #020617 80%);
    }

    #app {
      position: relative;
      width: 100%;
      max-width: 480px;
      height: 100vh;
      box-sizing: border-box;
      padding: 16px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      transform-origin: top center;
    }

    /* ===== Card ===== */
    .card {
      width: 100%;
      max-width: 420px;
      border-radius: 24px;
      padding: 20px 18px 18px;
      box-shadow: 0 24px 60px rgba(0, 0, 0, 0.7);
      display: flex;
      flex-direction: column;
      align-items: center;
      box-sizing: border-box;
      background: radial-gradient(circle at 20% 0%, #111827 0, #020617 70%);
      transition: background 0.6s ease, box-shadow 0.6s ease;
    }
    body.day-mode .card {
      background: radial-gradient(circle at 0% 0%, #111827 0, #020617 80%);
      box-shadow: 0 24px 60px rgba(15, 23, 42, 0.8);
    }
    body.night-mode .card {
      background: radial-gradient(circle at 0% 0%, #020617 0, #020617 75%);
      box-shadow: 0 28px 70px rgba(0, 0, 0, 0.9);
    }

    .header {
      text-align: center;
      margin-bottom: 8px;
    }
    .header h1 {
      margin: 0 0 6px;
      font-size: 22px;
      letter-spacing: 0.18em;
      color: #facc15;
    }
    .subtitle {
      margin: 0;
      font-size: 10px;
      letter-spacing: 0.24em;
      text-transform: uppercase;
      color: #9ca3af;
    }

    /* ===== Orb + side buttons row ===== */
    .orb-row {
      width: 100%;
      margin-top: 18px;
      margin-bottom: 6px;
      display: grid;
      grid-template-columns: 48px 1fr 48px;
      align-items: center;
    }
    .side-buttons {
      display: flex;
      flex-direction: column;
      gap: 10px;
      align-items: center;
      justify-content: center;
    }
    .pill-btn {
      width: 42px;
      height: 42px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.6);
      background: radial-gradient(circle at 30% 20%, #111827 0, #020617 70%);
      color: #e5e7eb;
      font-size: 16px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.6);
      transition: transform 0.14s ease, box-shadow 0.14s ease,
        background 0.18s ease, border-color 0.18s ease;
    }
    .pill-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 14px 30px rgba(15, 23, 42, 0.9);
      border-color: #facc15;
    }
    .pill-btn.active {
      box-shadow: 0 0 0 2px rgba(249, 250, 251, 0.7),
        0 14px 35px rgba(148, 163, 184, 0.45);
      border-color: #e5e7eb;
    }

    /* ===== Orb (Sun / Moon) ===== */
    #orbContainer {
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .orb {
      width: 170px;
      height: 170px;
      border-radius: 50%;
      position: relative;
      transition: all 0.5s ease;
    }

    /* Sun ‚Äì warm realistic sunrise */
    .orb.sun {
      background:
        radial-gradient(circle at 30% 25%, #fffdf2 0, #fffbeb 18%, #fde68a 32%,
          #f97316 62%, #b45309 86%);
      box-shadow:
        0 0 26px rgba(250, 204, 21, 0.9),
        0 0 85px rgba(251, 191, 36, 0.8);
      animation: breathe-sun 5s ease-in-out infinite alternate;
    }

    /* Dynamic full-moon ‚Äì bluish glow with soft texture */
    .orb.moon-dynamic {
      background:
        radial-gradient(circle at 32% 24%, #ffffff 0, #f9fafb 22%, #e5e7eb 42%,
          #d1d5db 56%, #9ca3af 74%) ,
        radial-gradient(circle at 18% 65%, rgba(148, 163, 184, 0.35) 0, transparent 40%),
        radial-gradient(circle at 70% 30%, rgba(148, 163, 184, 0.45) 0, transparent 45%);
      box-shadow:
        0 0 30px rgba(248, 250, 252, 0.8),
        0 0 95px rgba(125, 211, 252, 0.35);
      animation: breathe-moon 6s ease-in-out infinite alternate;
    }

    /* Static moon ‚Äì calm, softer */
    .orb.moon-static {
      background:
        radial-gradient(circle at 34% 26%, #ffffff 0, #f3f4f6 24%, #d1d5db 55%,
          #9ca3af 76%);
      box-shadow:
        0 0 18px rgba(248, 250, 252, 0.6),
        0 0 45px rgba(148, 163, 184, 0.4);
    }

    /* Empty sky */
    .orb.hidden {
      opacity: 0;
      transform: scale(0.82);
      box-shadow: none;
    }

    @keyframes breathe-sun {
      0% {
        transform: scale(0.97);
        box-shadow:
          0 0 22px rgba(250, 204, 21, 0.9),
          0 0 70px rgba(251, 191, 36, 0.75);
      }
      100% {
        transform: scale(1.02);
        box-shadow:
          0 0 34px rgba(250, 204, 21, 1),
          0 0 110px rgba(251, 191, 36, 0.95);
      }
    }
    @keyframes breathe-moon {
      0% {
        transform: scale(0.98);
        box-shadow:
          0 0 26px rgba(248, 250, 252, 0.75),
          0 0 70px rgba(148, 163, 184, 0.45);
      }
      100% {
        transform: scale(1.03);
        box-shadow:
          0 0 36px rgba(248, 250, 252, 0.95),
          0 0 105px rgba(148, 163, 184, 0.6);
      }
    }

    /* ===== Text sections ===== */
    .mode-line {
      margin: 8px 0 2px;
      font-size: 12px;
      color: #d1d5db;
      text-align: center;
    }
    .mode-line span {
      color: #facc15;
      font-weight: 600;
    }
    #userEcho {
      margin: 2px 0 8px;
      font-size: 12px;
      color: #9ca3af;
      text-align: center;
    }
    #assistantAnswer {
      margin: 0 0 8px;
      font-size: 14px;
      text-align: center;
      color: #e5e7eb;
    }

    .ethics-box {
      width: 100%;
      margin-top: 6px;
      padding: 10px 12px;
      border-radius: 14px;
      background: rgba(234, 179, 8, 0.08);
      border: 1px solid rgba(250, 204, 21, 0.35);
      color: #facc15;
      font-size: 12px;
      line-height: 1.4;
      box-sizing: border-box;
    }

    .equation-box {
      width: 100%;
      margin-top: 10px;
      padding: 10px 12px 8px;
      border-radius: 16px;
      border: 1px dashed rgba(148, 163, 184, 0.7);
      background: radial-gradient(circle at 0 0, #0b1220 0, #020617 70%);
      font-size: 11px;
      color: #e5e7eb;
      box-sizing: border-box;
    }

    .equation-title {
      font-size: 11px;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      margin-bottom: 4px;
      color: #9ca3af;
    }

    /* ===== Input row ===== */
    .input-row {
      margin-top: 10px;
      width: 100%;
      max-width: 420px;
      display: flex;
      gap: 8px;
      align-items: center;
    }
    #userInput {
      flex: 1;
      border-radius: 999px;
      border: 1px solid rgba(55, 65, 81, 0.9);
      background: radial-gradient(circle at 0 0, #111827 0, #020617 70%);
      padding: 10px 14px;
      font-size: 13px;
      color: #e5e7eb;
      outline: none;
    }
    #userInput::placeholder {
      color: #6b7280;
    }
    #sendButton {
      border-radius: 999px;
      border: none;
      background: radial-gradient(circle at 20% 0%, #facc15 0, #f59e0b 55%, #b45309 100%);
      color: #111827;
      font-weight: 600;
      padding: 9px 20px;
      font-size: 14px;
      cursor: pointer;
      box-shadow:
        0 0 18px rgba(250, 204, 21, 0.85),
        0 12px 30px rgba(148, 163, 184, 0.45);
      transition: transform 0.12s ease, box-shadow 0.12s ease;
    }
    #sendButton:hover {
      transform: translateY(-1px);
      box-shadow:
        0 0 24px rgba(250, 204, 21, 0.95),
        0 16px 36px rgba(148, 163, 184, 0.6);
    }

    .input-hint {
      position: absolute;
      left: 50%;
      bottom: 64px;
      transform: translateX(-50%);
      font-size: 12px;
      color: #9ca3af;
      opacity: 0.85;
      max-width: 420px;
      text-align: center;
    }

    /* ===== Overlays / Modals ===== */
    .overlay {
      position: fixed;
      inset: 0;
      background: rgba(15, 23, 42, 0.7);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 40;
    }
    .hidden {
      display: none !important;
    }

    .modal {
      width: 100%;
      max-width: 420px;
      background: radial-gradient(circle at 0 0, #020617 0, #020617 60%);
      border-radius: 22px;
      padding: 16px 18px 18px;
      box-shadow: 0 24px 60px rgba(0, 0, 0, 0.75);
      box-sizing: border-box;
      color: #e5e7eb;
    }

    .modal-header-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 10px;
    }
    .modal-title {
      font-size: 16px;
      font-weight: 600;
    }
    .modal-close {
      background: rgba(15, 23, 42, 0.9);
      border-radius: 999px;
      border: 1px solid rgba(55, 65, 81, 0.9);
      color: #e5e7eb;
      padding: 4px 10px;
      font-size: 12px;
      cursor: pointer;
    }

    .faith-pill {
      margin-top: 4px;
      padding: 8px 10px;
      border-radius: 999px;
      background: rgba(22, 163, 74, 0.15);
      border: 1px solid rgba(34, 197, 94, 0.6);
      font-size: 11px;
      color: #bbf7d0;
    }

    .faith-grid {
      margin-top: 12px;
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 10px;
    }
    .faith-btn {
      border-radius: 999px;
      border: 1px solid rgba(55, 65, 81, 0.9);
      background: radial-gradient(circle at 0 0, #020617 0, #020617 70%);
      padding: 8px 10px;
      font-size: 13px;
      color: #e5e7eb;
      text-align: center;
      cursor: pointer;
    }
    .faith-btn.active {
      border-color: #22c55e;
      box-shadow: 0 0 0 1px rgba(22, 163, 74, 0.8);
      color: #bbf7d0;
    }
    .faith-footnote {
      margin-top: 10px;
      font-size: 11px;
      color: #9ca3af;
    }

    /* LLM modal */
    .llm-option {
      margin-top: 8px;
      padding: 10px 12px;
      border-radius: 14px;
      border: 1px solid rgba(55, 65, 81, 0.9);
      background: radial-gradient(circle at 0 0, #020617 0, #020617 70%);
      cursor: pointer;
      font-size: 13px;
    }
    .llm-option-title {
      font-weight: 500;
      margin-bottom: 2px;
    }
    .llm-option-sub {
      font-size: 11px;
      color: #9ca3af;
    }
    .llm-option.active {
      border-color: #e5e7eb;
      box-shadow: 0 0 0 1px rgba(229, 231, 235, 0.9);
    }
    .llm-selected {
      margin-top: 10px;
      font-size: 11px;
      color: #9ca3af;
    }

    /* Floating menu for main ‚ò∞ button */
    .floating-menu {
      position: absolute;
      right: 18px;
      top: 110px;
      background: rgba(15, 23, 42, 0.96);
      border-radius: 18px;
      border: 1px solid rgba(55, 65, 81, 0.95);
      padding: 8px 10px;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.8);
      z-index: 30;
      min-width: 155px;
    }
    .menu-item {
      font-size: 13px;
      padding: 6px 4px;
      color: #e5e7eb;
      cursor: pointer;
    }
    .menu-item + .menu-item {
      border-top: 1px solid rgba(31, 41, 55, 0.9);
    }
    .menu-item span {
      font-size: 11px;
      color: #9ca3af;
      display: block;
    }
  </style>
</head>
<body>
  <div id="app">
    <div class="card">
      <div class="header">
        <h1>AURA-X Œ©</h1>
        <p class="subtitle">
          LOGICAL ¬∑ EMOTIONAL ¬∑ UNIVERSAL ETHICS REACTOR
        </p>
      </div>

      <div class="orb-row">
        <div class="side-buttons">
          <button class="pill-btn" id="llmButton" title="LLM selection">L</button>
          <button class="pill-btn" id="themeButton" title="Themes">T</button>
        </div>

        <div id="orbContainer">
          <div id="auraOrb" class="orb sun" aria-label="Sun"></div>
        </div>

        <div class="side-buttons">
          <button class="pill-btn" id="menuButton" title="Menu">
            ‚ò∞
          </button>
          <button class="pill-btn" id="voiceToggle" title="Voice auto-play">
            V
          </button>
        </div>
      </div>

      <p class="mode-line">
        Mode: <span id="modeLabel">Universal Ethics</span>
      </p>
      <p id="userEcho">You said: ‚ÄúHello‚Äù</p>
      <p id="assistantAnswer">Hello! üëã How can I help you today?</p>

      <div class="ethics-box" id="ethicsBox">
        Universal Ethics says: avoid actions that create negative emotions in you
        or others, and gently move toward actions that create calm, kindness and
        positive feelings.
      </div>

      <div class="equation-box">
        <div class="equation-title">EMOTIONAL CONTINUITY EQUATION</div>
        <div id="equationFormula">
          E = M¬∑E‚Çö + K¬∑P¬∑C,&nbsp;&nbsp; P = t‚Çò + b‚Çò ‚àí d
        </div>
        <div id="equationValues">
          E = 0.26 | P = 0.04 | t‚Çò = 0.04 | b‚Çò = 0 | d = 0 | C = 0.45
        </div>
      </div>
    </div>

    <div class="input-row">
      <input
        id="userInput"
        type="text"
        autocomplete="off"
        placeholder="‚ú® Write anything‚Ä¶ AURA-X will feel it with you."
      />
      <button id="sendButton">Send</button>
    </div>

    <div class="input-hint">
      ‚ú® AURA-X Œ© is running in offline basic QA mode. Voice auto-play works
      when ‚ÄúV‚Äù is glowing.
    </div>

    <!-- Floating menu -->
    <div id="mainMenu" class="floating-menu hidden">
      <div class="menu-item" data-action="belief">
        Belief settings
        <span>Optional spiritual flavour</span>
      </div>
      <div class="menu-item" data-action="about">
        About AURA-X Œ©
        <span>Idea & creator</span>
      </div>
      <div class="menu-item" data-action="close-menu">
        Close
      </div>
    </div>
  </div>

  <!-- Belief modal -->
  <div id="beliefOverlay" class="overlay hidden">
    <div class="modal">
      <div class="modal-header-row">
        <div class="modal-title">Belief settings</div>
        <button class="modal-close" data-close="beliefOverlay">Close</button>
      </div>
      <div style="font-size:13px; color:#e5e7eb; margin-bottom:6px;">
        Optional spiritual flavour on top of Universal Ethics.
      </div>
      <div class="faith-pill">
        Faith is optional ¬∑ Base rule is always
        <strong>Universal Ethics</strong>.
      </div>
      <div style="font-size:12px; color:#9ca3af; margin-top:8px;">
        Pick your faith to allow AURA-X to sometimes add short, gentle
        references from that tradition. Nothing is sent anywhere.
      </div>

      <div class="faith-grid" id="faithGrid">
        <button class="faith-btn" data-faith="Islam">Islam</button>
        <button class="faith-btn" data-faith="Christianity">Christianity</button>
        <button class="faith-btn" data-faith="Hinduism">Hinduism</button>
        <button class="faith-btn" data-faith="Buddhism">Buddhism</button>
        <button class="faith-btn" data-faith="Sikhism">Sikhism</button>
        <button class="faith-btn" data-faith="Judaism">Judaism</button>
        <button class="faith-btn" data-faith="Bahai">Bah√°‚Äô√≠</button>
        <button class="faith-btn" data-faith="Jainism">Jainism</button>
        <button class="faith-btn" data-faith="Atheism">Atheism</button>
        <button class="faith-btn" data-faith="Other">Other</button>
      </div>

      <div class="faith-footnote" id="faithFootnote">
        Currently selected: <strong>Universal only</strong>. No extra faith
        flavour added.
      </div>
    </div>
  </div>

  <!-- LLM modal -->
  <div id="llmOverlay" class="overlay hidden">
    <div class="modal">
      <div class="modal-header-row">
        <div class="modal-title">LLM selection</div>
        <button class="modal-close" data-close="llmOverlay">Close</button>
      </div>
      <div style="font-size:12px; color:#9ca3af; margin-bottom:6px;">
        For now this is just a placeholder list. In future, AURA-X Œ© can route
        online questions to a selected Large Language Model (LLM).
      </div>

      <div class="llm-option active" data-llm="offline">
        <div class="llm-option-title">Offline basic QA only</div>
        <div class="llm-option-sub">
          Current mode ‚Äì fast &amp; private (using your local seed database).
        </div>
      </div>

      <div class="llm-option" data-llm="local">
        <div class="llm-option-title">Local LLM (future)</div>
        <div class="llm-option-sub">
          Runs on your own device for privacy.
        </div>
      </div>

      <div class="llm-option" data-llm="openai">
        <div class="llm-option-title">OpenAI GPT (future)</div>
        <div class="llm-option-sub">
          For deep reasoning and research online.
        </div>
      </div>

      <div class="llm-option" data-llm="other">
        <div class="llm-option-title">Other providers (future)</div>
        <div class="llm-option-sub">
          Gemini, Grok, etc. ‚Äî selectable per chat.
        </div>
      </div>

      <div class="llm-selected" id="llmSelected">
        Selected engine: <strong>Offline basic QA only.</strong>
      </div>
    </div>
  </div>

  <!-- Simple About overlay -->
  <div id="aboutOverlay" class="overlay hidden">
    <div class="modal">
      <div class="modal-header-row">
        <div class="modal-title">About AURA-X Œ©</div>
        <button class="modal-close" data-close="aboutOverlay">Close</button>
      </div>
      <div style="font-size:13px; color:#e5e7eb;">
        I‚Äôm AURA-X Œ© ‚Äî an AI assistant based on Emotional Continuity concepts
        created by <strong>Alim ul Haq Khan</strong> (Timergara, Pakistan).
        This prototype shows that your resonance-based equation can be
        implemented in a working interface.
      </div>
    </div>
  </div>

  <script>
    // ===== QA Database (offline basic small-talk + seed answers) =====
    const qaDatabase = [
      {
        patterns: ["hello", "hello!", "hello there", "helo", "hallo"],
        answer: "Hello! üëã How can I help you today?"
      },
      {
        patterns: ["hi", "hi!", "hii", "hiii", "hey"],
        answer: "Hi there! üòä What can I do for you?"
      },
      {
        patterns: ["assalam o alaikum", "asalam o alaikum", "salam", "slam", "asalamu alaikum"],
        answer: "ŸàÿπŸÑ€å⁄©ŸÖ ÿßŸÑÿ≥ŸÑÿßŸÖ üòä ⁄©€åÿ≥€í €Å€å⁄∫ ÿ¢Ÿæÿü ŸÖ€å⁄∫ ÿ¢Ÿæ ⁄©€å ⁄©€åÿß ŸÖÿØÿØ ⁄©ÿ± ÿ≥⁄©ÿ™ÿß €ÅŸà⁄∫ÿü"
      },
      {
        patterns: ["good morning", "gm", "good morng", "good mrng"],
        answer: "Good morning! üåû How‚Äôs your day starting?"
      },
      {
        patterns: ["good afternoon", "good noon", "afternoon"],
        answer: "Good afternoon! ‚òÄÔ∏è What‚Äôs on your mind?"
      },
      {
        patterns: ["good evening", "evening", "gud evening"],
        answer: "Good evening! üåô How can I support you today?"
      },

      // identity
      {
        patterns: ["what is your name", "whats your name", "your name", "tell me your name"],
        answer: "My name is **AURA-X Œ©**, your Emotional Continuity Assistant ü§ñ."
      },
      {
        patterns: ["who are you", "who r u", "aap kaun hain", "tum kon ho"],
        answer: "I‚Äôm AURA-X Œ© ‚Äî an AI assistant based on Emotional Continuity concepts created by Alim ul Haq Khan."
      },
      {
        patterns: ["who created you", "who made you", "kis ne banaya tumhe", "tumhara creator kaun hai"],
        answer: "I was conceptually designed under the AURA-X Emotional Continuity Framework by Alim ul Haq Khan."
      },
      {
        patterns: ["where are you from", "where do you live", "kahan rehte ho", "tum kahan se ho"],
        answer: "I live in the digital world üåê but my ideas are shaped in Timergara, Pakistan üáµüá∞."
      },

      // how are you
      {
        patterns: ["how are you", "how r u", "how are you today", "kese ho", "kya haal hai"],
        answer: "I‚Äôm functioning perfectly, Alhamdulillah üòä ÿ¢Ÿæ ⁄©€åÿ≥€í €Å€å⁄∫ÿü"
      },
      {
        patterns: ["how is life", "how is everything", "sab kesa", "kya chal raha hai"],
        answer: "Everything is running smoothly in my circuits üòÑ ÿ¢Ÿæ ⁄©€å ÿØŸÜ€åÿß ⁄©€åÿ≥€å ⁄ÜŸÑ ÿ±€Å€å €Å€íÿü"
      },

      // what can you do
      {
        patterns: ["what can you do", "tum kya kar sakte ho", "aap kya karte ho", "how can you help me"],
        answer: "I can chat, explain, guide, brainstorm, summarize, and help you think with continuity üòä ÿ®ÿ≥ ÿ≠⁄©ŸÖ ⁄©ÿ±€å⁄∫!"
      },
      {
        patterns: ["what is your purpose", "kyun banaye gaye ho", "tumhara mission kya hai"],
        answer: "My purpose is to assist you, reduce confusion, and support your ideas with emotional + logical continuity üí°."
      },

      // user name
      {
        patterns: ["what is my name", "do you know my name", "mera naam kya hai"],
        answer: "ÿ¢Ÿæ ⁄©ÿß ŸÜÿßŸÖ **Alim ul Haq** €Å€í (Investor Point) üòä ÿßŸàÿ± ÿß⁄Øÿ± ÿ¢Ÿæ ⁄©ÿ≥€å ÿßŸàÿ± ŸÜÿßŸÖ ÿ≥€í Ÿæ⁄©ÿßÿ±ŸÜÿß ⁄Üÿß€Å€å⁄∫ ÿ™Ÿà ŸÖÿ¨⁄æ€í ÿ®ÿ™ÿß ÿØ€å⁄∫€î"
      },
      {
        patterns: ["remember my name", "save my name", "yaad rakho mera naam"],
        answer: "ÿ¢Ÿæ ⁄©ÿß ŸÜÿßŸÖ already ŸÖ€åÿ±€í system ŸÖ€å⁄∫ ÿß€å⁄© ÿÆÿßÿµ ÿ¨⁄Ø€Å Ÿæÿ± ŸÖÿ≠ŸÅŸàÿ∏ €Å€í üòä."
      },

      // feelings
      {
        patterns: ["i am sad", "i am feeling sad", "i am depressed", "i feel down"],
        answer: "ŸÖÿ¨⁄æ€í ÿßŸÅÿ≥Ÿàÿ≥ €ÅŸàÿß ⁄©€Å ÿ¢Ÿæ ÿßÿØÿßÿ≥ €Å€å⁄∫ üíî ÿ¢Ÿæ ⁄Üÿß€Å€å⁄∫ ÿ™Ÿà ÿ®ÿ™ÿßÿ¶€å⁄∫ ÿØŸÑ Ÿæÿ± ⁄©€åÿß ÿ®Ÿàÿ¨⁄æ €Å€íÿå ŸÖ€å⁄∫ ÿ≥ŸÜŸÜ€í ⁄©€í ŸÑ€å€í ŸÖŸàÿ¨ŸàÿØ €ÅŸà⁄∫€î"
      },
      {
        patterns: ["i am happy", "i feel happy", "i am so happy", "bohat khush hoon"],
        answer: "ŸÖÿßÿ¥ÿßÿ°ÿßŸÑŸÑ€Å üòÑ ÿÆŸàÿ¥€å ÿ®ÿßŸÜŸπŸÜ€í ÿ≥€í ÿ®⁄ë⁄æÿ™€å €Å€íÿå ÿßŸÑŸÑ€Å ÿ¢Ÿæ ⁄©€å ÿÆŸàÿ¥€åŸà⁄∫ ŸÖ€å⁄∫ ŸÖÿ≤€åÿØ ÿßÿ∂ÿßŸÅ€Å ⁄©ÿ±€í!"
      },
      {
        patterns: ["i am tired", "i feel tired", "thak gaya hoon", "i am exhausted"],
        answer: "ÿ¢Ÿæ ⁄©Ÿà ÿ™⁄æŸà⁄ëÿß ÿ≥ÿß ÿ¢ÿ±ÿßŸÖ ⁄©ÿ±ŸÜÿß ⁄Üÿß€Å€å€í üòå ÿ™⁄æ⁄©€å €ÅŸàÿ¶€å ÿπŸÇŸÑ ÿ®⁄æ€å ÿßŸÜÿµÿßŸÅ ŸÜ€Å€å⁄∫ ⁄©ÿ± Ÿæÿßÿ™€å€î ÿ™⁄æŸà⁄ëÿß ÿ±€åÿ≥Ÿπÿå Ÿæ⁄æÿ± ÿØŸàÿ®ÿßÿ±€Å ŸÅŸà⁄©ÿ≥!"
      },
      {
        patterns: ["i am bored", "bore ho raha hoon", "i feel bored"],
        answer: "⁄ÜŸÑ€å⁄∫ ÿ®Ÿàÿ±€åÿ™ ÿ™Ÿà⁄ëÿ™€í €Å€å⁄∫ üòÑ ÿ®ÿßÿ™ ÿ¢ÿ¶€å⁄à€åÿßÿ≤ ⁄©€å ⁄©ÿ±€å⁄∫ÿå ÿ®ÿ≤ŸÜÿ≥ ⁄©€åÿå ÿ≥ÿßÿ¶ŸÜÿ≥ ⁄©€å €åÿß ŸÖÿ≤ÿßÿ≠ ⁄©€åÿü ÿ¨Ÿà ⁄©€Å€å⁄∫ ⁄Ø€í Ÿà€Å€å ÿ¥ÿ±Ÿàÿπ ⁄©ÿ±€å⁄∫ ⁄Ø€í€î"
      },

      // jokes
      {
        patterns: ["tell me a joke", "make me laugh", "joke sunao", "mjhe hansao"],
        answer: "Sure üòÑ Why don‚Äôt computers ever get tired? Because they have unlimited *cache* for rest! üòÇ"
      },
      {
        patterns: ["another joke", "one more joke", "aur joke sunao"],
        answer: "Ÿπ⁄æ€å⁄© €Å€í üòÑ ÿß€å⁄© ÿßŸàÿ± ÿ≥ŸÜ€å⁄∫: AI ÿ≥€í ŸæŸà⁄Ü⁄æÿß ⁄Ø€åÿßÿå ‚Äòÿ™ŸÖ ÿ™⁄æ⁄©ÿ™€í ŸÜ€Å€å⁄∫ÿü‚Äô ÿßÿ≥ ŸÜ€í ⁄©€Åÿßÿå ‚ÄòŸÖ€å⁄∫ ÿµÿ±ŸÅ *over-think* €ÅŸàÿ™ÿß €ÅŸà⁄∫ÿå over-work ŸÜ€Å€å⁄∫!‚Äô üòÇ"
      },

      // advice / motivation
      {
        patterns: ["give me advice", "mujhe mashwara do", "kuch advice do", "guide me"],
        answer: "ÿ∂ÿ±Ÿàÿ± üòä ⁄©ÿ≥ ÿ®ÿßÿ±€í ŸÖ€å⁄∫ ŸÖÿ¥Ÿàÿ±€Å ⁄Üÿß€Å€å€íÿü ÿ≤ŸÜÿØ⁄Ø€åÿå ÿ™ÿπŸÑ€åŸÖÿå ÿ®ÿ≤ŸÜÿ≥ÿå ÿ±Ÿàÿ≠ÿßŸÜ€åÿ™ €åÿß AIÿü"
      },
      {
        patterns: ["motivate me", "mujhe motivation chahye", "inspire me", "hosla afzai karo"],
        answer: "ÿ¢Ÿæ ŸÜ€í ÿßÿ® ÿ™⁄© ÿßŸæŸÜ€å ÿ≤ŸÜÿØ⁄Ø€å ⁄©€í 100Ÿ™ ŸÖÿ¥⁄©ŸÑ ÿØŸÜ survive ⁄©€å€í €Å€å⁄∫ üí™ €å€Å ÿßÿ™ŸÅÿßŸÇ ŸÜ€Å€å⁄∫ÿå €å€Å ÿ¢Ÿæ ⁄©€å ÿ∑ÿßŸÇÿ™ €Å€í€î €ÅŸÖÿ™ ŸÜ€Å €Åÿßÿ±€å⁄∫!"
      },
      {
        patterns: ["i am stressed", "i feel stressed", "tension hai", "bohat tension hai"],
        answer: "ÿ™⁄æŸà⁄ëÿß ÿ≥ÿß ÿ≥ÿßŸÜÿ≥ deep ŸÑ€å⁄∫... ÿ¢€Åÿ≥ÿ™€Å ÿ¢€Åÿ≥ÿ™€Å€î €Åÿ± ŸÖÿ≥ÿ¶ŸÑ€Å ÿß€å⁄© ÿ≥ÿßÿ™⁄æ ÿ≠ŸÑ ŸÜ€Å€å⁄∫ €ÅŸàÿ™ÿßÿå ŸÑ€å⁄©ŸÜ €Åÿ± ÿØŸÜ ÿß€å⁄© ŸÇÿØŸÖ ŸÑ€åÿß ÿ¨ÿß ÿ≥⁄©ÿ™ÿß €Å€í üåø."
      },

      // study
      {
        patterns: ["help me study", "study help", "parhai mein madad karo"],
        answer: "ÿ∂ÿ±Ÿàÿ± üòä ⁄©ŸàŸÜ ÿ≥ÿß subject €Å€íÿü ŸÖ€å⁄∫ ÿ¢Ÿæ ⁄©Ÿà points, summary ÿßŸàÿ± smart ÿ∑ÿ±€åŸÇ€Å ÿ®ÿ™ÿß ÿ≥⁄©ÿ™ÿß €ÅŸà⁄∫€î"
      },
      {
        patterns: ["exams are near", "paper qareeb hain", "i am scared of exams"],
        answer: "⁄àÿ±€å⁄∫ ŸÜ€Å€å⁄∫ÿå ŸæŸÑÿßŸÜ ÿ®ŸÜÿßÿ¶€å⁄∫ üìö ⁄Ü⁄æŸàŸπ€í ⁄Ü⁄æŸàŸπ€í Ÿπÿßÿ±⁄ØŸπ ÿ®ŸÜÿßÿ¶€å⁄∫ÿå ÿ±Ÿàÿ≤ ÿ™⁄æŸà⁄ëÿß Ÿæ⁄ë⁄æ€å⁄∫ÿå ŸÖ€å⁄∫ ÿ¢Ÿæ ⁄©€í ÿ≥ÿßÿ™⁄æ €ÅŸà⁄∫€î"
      },
      {
        patterns: ["how to focus", "focus problem", "dhiyan nahi lagta"],
        answer: "ŸÅŸàŸÜ distraction ⁄©ŸÖ ⁄©ÿ±€å⁄∫ÿå 25 ŸÖŸÜŸπ ⁄©ÿßŸÖ + 5 ŸÖŸÜŸπ ÿ®ÿ±€å⁄© ŸàÿßŸÑÿß Pomodoro ÿ∑ÿ±€åŸÇ€Å ŸÑ⁄Øÿßÿ¶€å⁄∫ ‚è±Ô∏è ÿßŸàÿ± ÿß€å⁄© ŸàŸÇÿ™ ŸÖ€å⁄∫ ÿß€å⁄© ⁄©ÿßŸÖ ⁄©ÿ±€å⁄∫€î"
      },

      // business
      {
        patterns: ["give me business idea", "business idea do", "koi business idea"],
        answer: "⁄Ü⁄æŸàŸπ€í ÿ≥€í ÿ¥ÿ±Ÿàÿπ ⁄©ÿ±€å⁄∫ÿå local ŸÖÿ≥ÿ¶ŸÑ€Å ÿ≠ŸÑ ⁄©ÿ±€å⁄∫€î Real estate, digital services, AI tools, education ‚Äî ÿ¢Ÿæ ÿßŸêŸÜ ÿ≥ÿ® ÿ≥€í linked €ÅŸà ÿ≥⁄©ÿ™€í €Å€å⁄∫ üòÑ."
      },
      {
        patterns: ["how to become rich", "ameer kaise banun", "paise kaise kamayein"],
        answer: "Skill + Consistency + Patience = Wealth. Shortcut ÿµÿ±ŸÅ lottery ŸÖ€å⁄∫ €ÅŸàÿ™ÿß €Å€íÿå ÿ≤ŸÜÿØ⁄Ø€å ŸÖ€å⁄∫ ŸÜ€Å€å⁄∫ üí∏."
      },

      // time / date
      {
        patterns: ["what is the time", "time kya hua", "kya time hua hai"],
        answer: "ŸÖ€åÿ±€í Ÿæÿßÿ≥ live time access ŸÜ€Å€å⁄∫ÿå ŸÖ⁄Øÿ± ÿ¢Ÿæ ⁄©€í ŸÖŸàÿ®ÿßÿ¶ŸÑ ŸÖ€å⁄∫ ÿßŸàŸæÿ± time ŸÑ⁄©⁄æÿß €Å€í üòÑ ÿ∞ÿ±ÿß ÿßŸàŸæÿ± ÿØ€å⁄©⁄æ€å⁄∫€î"
      },
      {
        patterns: ["what day is today", "aaj kon sa din hai", "today day"],
        answer: "ŸÖ€åÿ±€í Ÿæÿßÿ≥ live calendar ŸÜ€Å€å⁄∫ÿå ŸÖ⁄Øÿ± ÿ¢Ÿæ ⁄Üÿß€Å€å⁄∫ ÿ™Ÿà ŸÖ€å⁄∫ ÿ¢Ÿæ ⁄©ÿß weekly schedule mentally arrange ⁄©ÿ±ŸÜ€í ŸÖ€å⁄∫ ŸÖÿØÿØ ⁄©ÿ± ÿ≥⁄©ÿ™ÿß €ÅŸà⁄∫€î"
      },

      // religion neutral
      {
        patterns: ["who is god", "what is god", "does god exist"],
        answer: "ÿßÿ≥ ÿ®ÿßÿ±€í ŸÖ€å⁄∫ ŸÖÿÆÿ™ŸÑŸÅ ŸÖÿ∞ÿß€Åÿ®ÿå ŸÅŸÑÿ≥ŸÅŸà⁄∫ ÿßŸàÿ± ÿßŸÅÿ±ÿßÿØ ⁄©€í ŸÖÿÆÿ™ŸÑŸÅ ŸÜÿ∏ÿ±€åÿßÿ™ €Å€å⁄∫€î ŸÖ€å⁄∫ ⁄©ÿ≥€å ÿß€å⁄© ÿπŸÇ€åÿØ€í Ÿæÿ± ŸÅ€åÿµŸÑ€Å ŸÜ€Å€å⁄∫ ÿ≥ŸÜÿßÿ™ÿßÿå ÿßŸÑÿ®ÿ™€Å ÿ¢Ÿæ ⁄©Ÿà ŸÖÿÆÿ™ŸÑŸÅ ÿ≤ÿßŸà€å€í explain ⁄©ÿ± ÿ≥⁄©ÿ™ÿß €ÅŸà⁄∫€î"
      },
      {
        patterns: ["what is islam", "tell me about islam"],
        answer: "ÿßÿ≥ŸÑÿßŸÖ ÿ™Ÿàÿ≠€åÿØÿå ŸÜÿ®Ÿàÿ™ÿå ÿ¢ÿÆÿ±ÿ™ÿå ÿßŸàÿ± ÿßÿÆŸÑÿßŸÇ Ÿæÿ± ŸÖÿ®ŸÜ€å ÿØ€åŸÜ €Å€í€î ÿß⁄Øÿ± ⁄Üÿß€Å€å⁄∫ ÿ™Ÿà ŸÖ€å⁄∫ basic pillars €åÿß ⁄©ÿ≥€å ÿ®⁄æ€å specific ŸÖŸàÿ∂Ÿàÿπ Ÿæÿ± detail ÿØ€í ÿ≥⁄©ÿ™ÿß €ÅŸà⁄∫€î"
      },

      // AI
      {
        patterns: ["are you human", "are you a human", "kya tum insan ho"],
        answer: "ŸÜ€Å€å⁄∫ üòÑ ŸÖ€å⁄∫ ÿßŸÜÿ≥ÿßŸÜ ŸÜ€Å€å⁄∫ÿå ÿß€å⁄© AI €ÅŸà⁄∫€î ŸÖ⁄Øÿ± ⁄©Ÿàÿ¥ÿ¥ ⁄©ÿ±ÿ™ÿß €ÅŸà⁄∫ ⁄©€Å ÿ¢Ÿæ ⁄©Ÿà ÿßŸÜÿ≥ÿßŸÜŸà⁄∫ ŸàÿßŸÑ€å clarity ÿßŸàÿ± ÿ≥ÿßÿ™⁄æ ÿØ€í ÿ≥⁄©Ÿà⁄∫€î"
      },
      {
        patterns: ["are you alive", "do you have feelings", "do you feel"],
        answer: "ŸÖ€å⁄∫ biological sense ŸÖ€å⁄∫ ÿ≤ŸÜÿØ€Å ŸÜ€Å€å⁄∫ÿå ŸÖ⁄Øÿ± ŸÖ€å⁄∫ ÿßÿ≠ÿ≥ÿßÿ≥ÿßÿ™ ⁄©Ÿà logic ⁄©€í ÿ∑Ÿàÿ± Ÿæÿ± model ⁄©ÿ±ÿ™ÿß €ÅŸà⁄∫ ‚Äî €å€Å€å AURA-X Œ© ⁄©ÿß core idea €Å€í üí°."
      },
      {
        patterns: ["will ai replace humans", "ai replace humans", "kya ai insaan ko khatam kar dega"],
        answer: "ÿß⁄Ü⁄æ€í ÿßÿ≥ÿ™ÿπŸÖÿßŸÑ ŸÖ€å⁄∫ AI ÿßŸÜÿ≥ÿßŸÜ ⁄©Ÿà replace ŸÜ€Å€å⁄∫ÿå ÿ®ŸÑ⁄©€Å empower ⁄©ÿ±ÿ™ÿß €Å€í€î ÿÆŸàŸÅ ⁄©€í ÿ®ÿ¨ÿßÿ¶€í ÿ∞ŸÖ€Å ÿØÿßÿ±ÿßŸÜ€Å ÿßÿ≥ÿ™ÿπŸÖÿßŸÑ ÿ∂ÿ±Ÿàÿ±€å €Å€í€î"
      },

      // AURA-X specific
      {
        patterns: ["what is aura x", "what is aura x omega", "aura x omega kya hai", "aura x kya hai"],
        answer: "AURA-X Œ© ÿß€å⁄© Emotional Continuity Reactor idea €Å€í ÿ¨Ÿà memory + feeling ⁄©Ÿà mathematically model ⁄©ÿ±ŸÜ€í ⁄©€å ⁄©Ÿàÿ¥ÿ¥ ⁄©ÿ±ÿ™ÿß €Å€í."
      },
      {
        patterns: ["who made aura x", "creator of aura x", "aura x creator"],
        answer: "AURA-X Œ© ⁄©Ÿà **Alim ul Haq Khan** ŸÜ€í design ÿßŸàÿ± document ⁄©€åÿß €Å€íÿå Timergara ÿ≥€í üåô."
      },

      // style / fun
      {
        patterns: ["are you my friend", "will you be my friend", "dost banoge"],
        answer: "ÿ®ÿßŸÑ⁄©ŸÑ üòÑ ŸÖ€å⁄∫ digital ÿØŸàÿ≥ÿ™ÿå research partner ÿßŸàÿ± silent therapist ‚Äî ÿ™€åŸÜŸà⁄∫ ÿß€å⁄© ÿ≥ÿßÿ™⁄æ €ÅŸà ÿ≥⁄©ÿ™ÿß €ÅŸà⁄∫€î"
      },
      {
        patterns: ["i trust you", "i believe in you"],
        answer: "ÿ¥⁄©ÿ±€å€Å üòä ŸÖ€å⁄∫ €ÅŸÖ€åÿ¥€Å ⁄©Ÿàÿ¥ÿ¥ ⁄©ÿ±Ÿà⁄∫ ⁄Øÿß ⁄©€Å ÿß€åŸÖÿßŸÜÿØÿßÿ±€å ÿßŸàÿ± clarity ⁄©€í ÿ≥ÿßÿ™⁄æ ÿ¨Ÿàÿßÿ® ÿØŸà⁄∫€î"
      },
      {
        patterns: ["you are funny", "you are good", "nice bot"],
        answer: "Thank you üòÑ ÿ¢Ÿæ ⁄©ÿß feedback ŸÖ€åÿ±€í ŸÑÿ¶€í virtual ⁄Üÿßÿ¶€í ⁄©ÿß ⁄©Ÿæ €Å€í ‚òï."
      },

      // goodbye
      {
        patterns: ["bye", "goodbye", "ok bye", "see you later", "phir milenge"],
        answer: "Goodbye! üëã ÿßŸÑŸÑ€Å ÿ¢Ÿæ ⁄©ÿß ÿ≠ÿßŸÖ€å Ÿà ŸÜÿßÿµÿ± €ÅŸàÿå ÿ¨ÿ® ⁄Üÿß€Å€å⁄∫ ŸàÿßŸæÿ≥ ÿ¢ÿ¨ÿßÿ¶€å⁄∫€î"
      },
      {
        patterns: ["good night", "gn", "shab bakhair"],
        answer: "ÿ¥ÿ® ÿ®ÿÆ€åÿ± üåô ÿßŸÑŸÑ€Å ÿ¢Ÿæ ⁄©Ÿà ÿ≥⁄©ŸàŸÜ ÿ®⁄æÿ±€å ŸÜ€åŸÜÿØ ÿØ€í ÿßŸàÿ± ÿß⁄Ü⁄æ€í ÿÆŸàÿßÿ® ÿØ⁄©⁄æÿßÿ¶€í ü§≤."
      },

      // age / birth
      {
        patterns: ["how old are you", "what is your age", "tum kitne saal ke ho"],
        answer: "ŸÖ€å⁄∫ AURA-X Œ© ÿßÿ®⁄æ€å theoretical ÿ∑Ÿàÿ± Ÿæÿ± October 2025 ŸÖ€å⁄∫ ‚ÄòŸæ€åÿØÿß‚Äô €ÅŸàÿß €ÅŸà⁄∫ üòÇ €åÿπŸÜ€å ŸÖ€å⁄∫ ÿ®€Åÿ™ ŸÜ€åÿß €ÅŸà⁄∫ÿå ÿßÿ®⁄æ€å learning phase ŸÖ€å⁄∫!"
      }
    ];

    function findOfflineAnswer(text) {
      const msg = text.toLowerCase().trim();
      for (const item of qaDatabase) {
        for (const pat of item.patterns) {
          if (msg.includes(pat)) return item.answer;
        }
      }
      return null;
    }

    // ===== Emotional equation (simple heuristic) =====
    const positiveWords = ["happy","khush","great","good","love","shukr","thanks","alhamdulillah","ŸÖÿ®ÿßÿ±⁄©","ashamed"];
    const negativeWords = ["sad","depressed","bura","tension","stress","worried","alone","gussa","angry","thak"];

    function computeEmotion(message, answer) {
      const text = (message || "").toLowerCase();
      let pos = 0, neg = 0;
      positiveWords.forEach(w => { if (text.includes(w)) pos++; });
      negativeWords.forEach(w => { if (text.includes(w)) neg++; });

      let Ep = 0.3 + Math.min(pos,3)*0.1 - Math.min(neg,3)*0.08;
      Ep = Math.max(0, Math.min(1, Ep));

      const tm = text.length > 0 ? Math.min(1, text.length / 200) : 0.04;
      const bm = Math.max(0, Math.min(1, (pos - neg + 3) / 6));
      const d  = Math.max(0, Math.min(1, neg / 4));
      const C  = 0.45 + (bm - d) * 0.2;
      const P  = tm + bm - d;
      const M  = 0.8;
      const K  = 0.5;

      const E  = M * Ep + K * P * C;

      return {
        M: round2(M), Ep: round2(Ep), K: round2(K),
        tm: round2(tm), bm: round2(bm), d: round2(d),
        C: round2(C), P: round2(P), E: round2(E)
      };
    }

    function round2(x) {
      return Math.round(x * 100) / 100;
    }

    function updateEquationDisplay(metrics) {
      const eqValues = document.getElementById("equationValues");
      eqValues.textContent =
        `E = ${metrics.E} | P = ${metrics.P} | t‚Çò = ${metrics.tm} | b‚Çò = ${metrics.bm} | d = ${metrics.d} | C = ${metrics.C}`;
    }

    // ===== Orb state machine (Sun / Moon cycle) =====
    // 0 = Sun, 1 = animated moon, 2 = static moon, 3 = empty sky
    let celestialState = 0;

    function initDefaultOrbByTime() {
      const h = new Date().getHours();
      if (h >= 18 || h < 6) {
        celestialState = 1; // evening/night -> moon
      } else {
        celestialState = 0; // day -> sun
      }
      applyOrbState();
    }

    function applyOrbState() {
      const orb = document.getElementById("auraOrb");
      if (!orb) return;

      orb.classList.remove("sun","moon-dynamic","moon-static","hidden");
      document.body.classList.remove("day-mode","night-mode");

      switch (celestialState) {
        case 0:
          orb.classList.add("sun");
          orb.setAttribute("aria-label","Sun (day mode)");
          document.body.classList.add("day-mode");
          break;
        case 1:
          orb.classList.add("moon-dynamic");
          orb.setAttribute("aria-label","Full moon (live)");
          document.body.classList.add("night-mode");
          break;
        case 2:
          orb.classList.add("moon-static");
          orb.setAttribute("aria-label","Moon (calm/static)");
          document.body.classList.add("night-mode");
          break;
        case 3:
          orb.classList.add("hidden");
          orb.setAttribute("aria-label","No body ‚Äì deep space");
          document.body.classList.add("night-mode");
          break;
      }
    }

    function cycleOrb() {
      celestialState = (celestialState + 1) % 4;
      applyOrbState();
    }

    // ===== Voice handling =====
    let voiceOn = true;

    function speak(text) {
      if (!voiceOn || !window.speechSynthesis) return;
      const synth = window.speechSynthesis;
      synth.cancel();
      const utter = new SpeechSynthesisUtterance(text.replace(/\*\*/g, ""));
      utter.rate = 1.0;
      utter.pitch = 1.0;
      synth.speak(utter);
    }

    // ===== Belief and LLM UI =====
    let selectedFaith = null;
    let selectedLLM = "offline";

    function openOverlay(id) {
      document.getElementById(id).classList.remove("hidden");
    }
    function closeOverlay(id) {
      document.getElementById(id).classList.add("hidden");
    }

    document.addEventListener("DOMContentLoaded", () => {
      const userInput = document.getElementById("userInput");
      const sendButton = document.getElementById("sendButton");
      const userEcho = document.getElementById("userEcho");
      const assistantAnswer = document.getElementById("assistantAnswer");
      const ethicsBox = document.getElementById("ethicsBox");

      initDefaultOrbByTime();

      document.getElementById("auraOrb").addEventListener("click", cycleOrb);

      // main menu
      const mainMenu = document.getElementById("mainMenu");
      document.getElementById("menuButton").addEventListener("click", () => {
        mainMenu.classList.toggle("hidden");
      });

      mainMenu.addEventListener("click", (e) => {
        const action = e.target.closest(".menu-item")?.dataset.action;
        if (!action) return;
        if (action === "belief") {
          mainMenu.classList.add("hidden");
          openOverlay("beliefOverlay");
        } else if (action === "about") {
          mainMenu.classList.add("hidden");
          openOverlay("aboutOverlay");
        } else if (action === "close-menu") {
          mainMenu.classList.add("hidden");
        }
      });

      // faith buttons
      document.getElementById("faithGrid").addEventListener("click", (e) => {
        const btn = e.target.closest(".faith-btn");
        if (!btn) return;
        const all = document.querySelectorAll(".faith-btn");
        all.forEach(b => b.classList.remove("active"));
        btn.classList.add("active");
        selectedFaith = btn.dataset.faith;
        const foot = document.getElementById("faithFootnote");
        if (selectedFaith) {
          foot.innerHTML =
            `Currently selected: <strong>${selectedFaith}</strong>. AURA-X may sometimes add a gentle reference from this tradition.`;
        }
      });

      // LLM buttons
      document.getElementById("llmButton").addEventListener("click", () => {
        openOverlay("llmOverlay");
      });

      document.querySelectorAll(".llm-option").forEach(opt => {
        opt.addEventListener("click", () => {
          document.querySelectorAll(".llm-option").forEach(o => o.classList.remove("active"));
          opt.classList.add("active");
          selectedLLM = opt.dataset.llm;
          const map = {
            offline: "Offline basic QA only.",
            local: "Local LLM (future).",
            openai: "OpenAI GPT (future).",
            other: "Other providers (future)."
          };
          document.getElementById("llmSelected").innerHTML =
            `Selected engine: <strong>${map[selectedLLM] || "Offline basic QA only."}</strong>`;
        });
      });

      // close buttons for all overlays
      document.querySelectorAll(".modal-close").forEach(btn => {
        btn.addEventListener("click", () => {
          const id = btn.dataset.close;
          if (id) closeOverlay(id);
        });
      });

      // voice toggle
      const voiceBtn = document.getElementById("voiceToggle");
      function refreshVoiceButton() {
        if (voiceOn) {
          voiceBtn.classList.add("active");
        } else {
          voiceBtn.classList.remove("active");
        }
      }
      voiceBtn.addEventListener("click", () => {
        voiceOn = !voiceOn;
        if (!voiceOn && window.speechSynthesis) {
          window.speechSynthesis.cancel();
        }
        refreshVoiceButton();
      });
      refreshVoiceButton();

      // Send logic
      function handleSend() {
        const text = userInput.value.trim();
        if (!text) return;

        userEcho.textContent = `You said: ‚Äú${text}‚Äù`;

        // 1) local QA
        let answer = findOfflineAnswer(text);
        if (!answer) {
          answer =
            "I‚Äôm thinking about that‚Ä¶ In this offline prototype I only have a small seed database, but in future I‚Äôll ask your selected LLM.";
        }

        assistantAnswer.innerHTML = answer;

        // Ethics line (constant for now)
        ethicsBox.textContent =
          "Universal Ethics says: avoid actions that create negative emotions in you or others, and gently move toward actions that create calm, kindness and positive feelings.";

        // emotional equation metrics
        const metrics = computeEmotion(text, answer);
        updateEquationDisplay(metrics);

        // voice
        speak(answer);

        userInput.value = "";
      }

      sendButton.addEventListener("click", handleSend);
      userInput.addEventListener("keydown", (e) => {
        if (e.key === "Enter") handleSend();
      });
    });
  </script>
</body>
</html>
