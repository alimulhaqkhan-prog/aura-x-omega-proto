<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>AURA-X Œ© v1 ‚Äì Emotional Continuity Assistant</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0" />
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    html, body {
      height: 100%;
      touch-action: manipulation;
    }
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%);
      background-attachment: fixed;
      color: #e5e7eb;
      display: flex;
      justify-content: center;
      align-items: stretch;
      overflow: hidden;
      position: relative;
    }
    #particle-canvas {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      pointer-events: none;
    }
    .app {
      width: 100%;
      max-width: 520px;
      height: 100vh;
      display: flex;
      flex-direction: column;
      padding: 12px;
      gap: 8px;
      background: rgba(0, 0, 0, 0.1);
      backdrop-filter: blur(10px);
      z-index: 1;
      position: relative;
      -webkit-overflow-scrolling: touch;
    }
    .app-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
      padding: 8px 0;
    }
    .title-block {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }
    .title-main {
      font-size: 1.1rem;
      font-weight: 700;
      letter-spacing: 0.04em;
      background: linear-gradient(45deg, #a5b4fc, #facc15);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      animation: titleGlow 3s ease-in-out infinite alternate;
      touch-action: manipulation;
    }
    @keyframes titleGlow {
      from { filter: drop-shadow(0 0 5px rgba(165, 180, 252, 0.3)); }
      to { filter: drop-shadow(0 0 10px rgba(250, 204, 21, 0.5)); }
    }
    .title-sub {
      font-size: 0.7rem;
      text-transform: uppercase;
      opacity: 0.75;
      color: #94a3b8;
    }
    .mode-pill {
      background: rgba(15, 23, 42, 0.9);
      border-radius: 999px;
      padding: 6px 10px;
      font-size: 0.65rem;
      border: 1px solid rgba(148, 163, 184, 0.35);
      text-align: right;
      min-width: 130px;
      backdrop-filter: blur(5px);
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
      transition: all 0.2s ease-out;
      touch-action: manipulation;
    }
    .mode-pill:active {
      transform: scale(0.98);
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.4);
    }
    .mode-pill span {
      display: block;
    }
    .mode-label-1 {
      color: #a5b4fc;
      text-transform: uppercase;
      font-size: 0.6rem;
    }
    .mode-label-2 {
      color: #facc15;
      font-size: 0.65rem;
    }
    .options-btn {
      margin-left: 6px;
      width: 44px;
      height: 44px;
      border-radius: 50%;
      border: 1px solid rgba(148, 163, 184, 0.4);
      background: rgba(15, 23, 42, 0.9);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.15s ease-out;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
      touch-action: manipulation;
      position: relative;
    }
    .options-btn::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 20px;
      height: 2px;
      background: #e5e7eb;
      border-radius: 1px;
      transform: translate(-50%, -50%);
      transition: all 0.15s ease-out;
    }
    .options-btn::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 20px;
      height: 2px;
      background: #e5e7eb;
      border-radius: 1px;
      transform: translate(-50%, -50%) rotate(90deg);
      transition: all 0.15s ease-out;
    }
    .options-btn:active {
      transform: scale(0.95);
      box-shadow: 0 1px 5px rgba(0, 0, 0, 0.3);
    }
    .options-btn:hover::before,
    .options-btn:hover::after {
      background: #facc15;
    }

    .top-panels {
      flex: 1;
      min-height: 0;
      display: flex;
      flex-direction: column;
      gap: 8px;
      overflow-y: auto;
      padding-right: 2px;
      -webkit-overflow-scrolling: touch;
      touch-action: pan-y;
    }

    .meters-grid {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 6px;
      font-size: 0.65rem;
    }
    .meter-card {
      background: rgba(15, 23, 42, 0.9);
      border-radius: 10px;
      padding: 6px 6px 4px;
      border: 1px solid rgba(30, 64, 175, 0.7);
      transition: all 0.2s ease-out;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
      touch-action: manipulation;
    }
    .meter-card:active {
      transform: scale(0.98);
    }
    .meter-label {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      margin-bottom: 3px;
    }
    .meter-title {
      font-weight: 600;
      font-size: 0.7rem;
    }
    .meter-sub {
      opacity: 0.6;
      font-size: 0.55rem;
    }
    .meter-bar {
      width: 100%;
      height: 5px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 1);
      overflow: hidden;
      box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.5);
      transition: box-shadow 0.3s ease;
    }
    .meter-fill {
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, #f97316, #22c55e, #3b82f6);
      transition: width 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      box-shadow: 0 0 10px rgba(34, 197, 94, 0.5);
      will-change: width;
      animation: meterPulse 1s ease-in-out infinite alternate;
    }
    @keyframes meterPulse {
      from { filter: brightness(1); }
      to { filter: brightness(1.2); }
    }
    .meter-value {
      font-size: 0.6rem;
      text-align: right;
      margin-top: 2px;
      opacity: 0.8;
      transition: opacity 0.3s ease;
    }

    .ethics-banner {
      background: rgba(234, 179, 8, 0.13);
      border-radius: 12px;
      padding: 8px 10px;
      border: 1px solid rgba(250, 204, 21, 0.6);
      font-size: 0.7rem;
      line-height: 1.35;
      color: #facc15;
      text-align: center;
      box-shadow: 0 4px 15px rgba(250, 204, 21, 0.2);
      animation: ethicsGlow 2.5s ease-in-out infinite alternate;
      will-change: box-shadow;
      touch-action: manipulation;
    }
    @keyframes ethicsGlow {
      from { box-shadow: 0 4px 15px rgba(250, 204, 21, 0.2); }
      to { box-shadow: 0 4px 25px rgba(250, 204, 21, 0.4); }
    }

    .equation-panel {
      background: rgba(15, 23, 42, 0.95);
      border-radius: 12px;
      padding: 8px 10px 10px;
      border: 1px dashed rgba(148, 163, 184, 0.6);
      font-size: 0.7rem;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
      transition: box-shadow 0.3s ease;
      touch-action: manipulation;
    }
    .equation-panel:hover {
      box-shadow: 0 4px 15px rgba(165, 180, 252, 0.2);
    }
    .equation-title {
      font-weight: 600;
      letter-spacing: 0.06em;
      margin-bottom: 4px;
      font-size: 0.68rem;
      color: #a5b4fc;
    }
    .equation-line {
      font-family: "Menlo", "Consolas", monospace;
      font-size: 0.7rem;
      margin-bottom: 2px;
      color: #94a3b8;
      transition: color 0.3s ease;
    }

    .chat-shell {
      border-radius: 14px;
      background: rgba(15, 23, 42, 0.96);
      border: 1px solid rgba(51, 65, 85, 0.9);
      padding: 8px 8px 6px;
      display: flex;
      flex-direction: column;
      gap: 6px;
      min-height: 36%;
      max-height: 55%;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
      backdrop-filter: blur(10px);
      transition: box-shadow 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      touch-action: pan-y;
    }
    .chat-shell:hover {
      box-shadow: 0 12px 40px rgba(0, 0, 0, 0.5);
    }

    .chat-log {
      flex: 1;
      min-height: 0;
      overflow-y: auto;
      padding-right: 4px;
      display: flex;
      flex-direction: column;
      gap: 6px;
      font-size: 0.76rem;
      -webkit-overflow-scrolling: touch;
      scroll-behavior: smooth;
      touch-action: pan-y;
    }
    .msg-row {
      display: flex;
      animation: fadeInUp 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      will-change: transform, opacity;
    }
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .msg-user {
      justify-content: flex-end;
      animation-delay: 0.1s;
    }
    .msg-bot {
      justify-content: flex-start;
      animation-delay: 0.2s;
    }
    .msg-bubble {
      max-width: 88%;
      padding: 8px 12px;
      border-radius: 18px;
      line-height: 1.4;
      white-space: pre-wrap;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
      transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      will-change: transform;
      touch-action: manipulation;
    }
    .msg-bubble:active {
      transform: scale(0.98);
    }
    .msg-bot .msg-bubble {
      background: linear-gradient(135deg, rgba(30, 64, 175, 0.4), rgba(59, 130, 246, 0.3));
      border-bottom-left-radius: 4px;
      color: #e5e7eb;
      animation: botBubbleSlide 0.5s ease-out;
    }
    @keyframes botBubbleSlide {
      from { transform: translateX(-10px); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }
    .msg-user .msg-bubble {
      background: linear-gradient(135deg, rgba(22, 163, 74, 0.9), rgba(34, 197, 94, 0.8));
      border-bottom-right-radius: 4px;
      color: #fff;
      animation: userBubbleSlide 0.5s ease-out;
    }
    @keyframes userBubbleSlide {
      from { transform: translateX(10px); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }

    .verse-bubble {
      background: linear-gradient(135deg, rgba(250, 204, 21, 0.1), rgba(250, 204, 21, 0.05));
      border: 1px solid rgba(250, 204, 21, 0.3);
      border-radius: 12px;
      padding: 8px 12px;
      margin-top: 4px;
      font-style: italic;
      color: #facc15;
      animation: verseFadeGlow 1.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      will-change: opacity, box-shadow;
      touch-action: manipulation;
    }
    @keyframes verseFadeGlow {
      0% { opacity: 0; transform: scale(0.95); box-shadow: 0 0 0 rgba(250, 204, 21, 0); }
      50% { opacity: 1; transform: scale(1.02); box-shadow: 0 0 15px rgba(250, 204, 21, 0.3); }
      100% { opacity: 1; transform: scale(1); box-shadow: 0 0 5px rgba(250, 204, 21, 0.1); }
    }

    .seed-meta {
      font-size: 0.6rem;
      opacity: 0.6;
      margin-top: 1px;
      color: #64748b;
      animation: metaFade 0.6s ease-out;
    }
    @keyframes metaFade {
      from { opacity: 0; }
      to { opacity: 0.6; }
    }

    .chat-input-row {
      display: flex;
      align-items: center;
      gap: 6px;
      margin-top: 2px;
    }
    #userInput {
      flex: 1;
      border-radius: 999px;
      background: rgba(2, 6, 23, 0.8);
      border: 1px solid rgba(51, 65, 85, 0.95);
      padding: 12px 16px;
      font-size: 0.85rem;
      color: #e5e7eb;
      min-height: 40px;
      max-height: 80px;
      resize: vertical;
      outline: none;
      transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      font-family: inherit;
      will-change: border-color, box-shadow;
      touch-action: auto; /* Allow text input */
    }
    #userInput:focus {
      border-color: #22c55e;
      box-shadow: 0 0 0 2px rgba(34, 197, 94, 0.2);
      transform: scale(1.01);
    }
    #userInput::placeholder {
      color: rgba(148, 163, 184, 0.75);
    }
    #sendButton {
      border-radius: 999px;
      border: none;
      padding: 12px 18px;
      font-size: 0.85rem;
      font-weight: 600;
      background: linear-gradient(135deg, #22c55e, #16a34a);
      color: #fff;
      cursor: pointer;
      box-shadow: 0 4px 15px rgba(34, 197, 94, 0.4);
      min-width: 80px;
      transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      will-change: transform, box-shadow;
      touch-action: manipulation;
    }
    #sendButton:active {
      transform: translateY(-2px) scale(0.98);
      box-shadow: 0 2px 10px rgba(34, 197, 94, 0.6);
    }

    .footer-hint {
      text-align: center;
      font-size: 0.6rem;
      opacity: 0.5;
      margin-top: 2px;
      color: #64748b;
      animation: hintPulse 4s ease-in-out infinite;
    }
    @keyframes hintPulse {
      0%, 100% { opacity: 0.5; }
      50% { opacity: 0.7; }
    }

    .modal-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(15, 23, 42, 0.8);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 20;
      backdrop-filter: blur(5px);
      animation: backdropFade 0.3s ease-out;
      touch-action: none; /* Prevent scroll during modal */
    }
    @keyframes backdropFade {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    .modal-backdrop.active {
      display: flex;
    }
    .modal {
      width: min(440px, 94%);
      border-radius: 16px;
      background: linear-gradient(135deg, #020617, #1e293b);
      border: 1px solid rgba(148, 163, 184, 0.7);
      padding: 16px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
      max-height: 88vh;
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
      animation: modalSlideIn 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      will-change: transform;
      touch-action: pan-y;
    }
    @keyframes modalSlideIn {
      from { opacity: 0; transform: translateY(-20px) scale(0.95); }
      to { opacity: 1; transform: translateY(0) scale(1); }
    }
    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
    }
    .modal-title {
      font-size: 0.9rem;
      font-weight: 600;
      color: #a5b4fc;
    }
    .modal-close {
      border-radius: 999px;
      border: 1px solid rgba(71, 85, 105, 0.9);
      font-size: 0.7rem;
      padding: 6px 10px;
      cursor: pointer;
      background: rgba(15, 23, 42, 0.95);
      color: #e5e7eb;
      transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      touch-action: manipulation;
    }
    .modal-close:active {
      transform: scale(0.95);
    }
    .modal-section-title {
      font-size: 0.75rem;
      font-weight: 600;
      margin-top: 8px;
      margin-bottom: 4px;
      color: #facc15;
      animation: sectionTitleFade 0.5s ease-out;
    }
    @keyframes sectionTitleFade {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    .modal-subtext {
      font-size: 0.68rem;
      opacity: 0.75;
      margin-bottom: 4px;
      line-height: 1.4;
      color: #94a3b8;
    }
    .chip-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-bottom: 4px;
    }
    .chip {
      padding: 8px 12px;
      border-radius: 999px;
      border: 1px solid rgba(75, 85, 99, 0.9);
      font-size: 0.7rem;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      background: rgba(15, 23, 42, 0.5);
      min-width: 60px;
      will-change: transform, background;
      touch-action: manipulation;
    }
    .chip:active {
      transform: scale(0.98);
    }
    .chip:hover {
      transform: scale(1.05) translateY(-1px);
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
    }
    .chip.active {
      background: rgba(34, 197, 94, 0.2);
      border-color: #22c55e;
      color: #bbf7d0;
      box-shadow: 0 0 10px rgba(34, 197, 94, 0.3);
      animation: chipActive 0.4s ease-out;
    }
    @keyframes chipActive {
      0% { transform: scale(1); }
      50% { transform: scale(1.1); }
      100% { transform: scale(1); }
    }
    .toggle-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-top: 4px;
    }
    .toggle-label {
      font-size: 0.7rem;
      color: #e5e7eb;
    }
    .toggle-pill {
      width: 50px;
      height: 26px;
      border-radius: 999px;
      padding: 3px;
      background: rgba(15, 23, 42, 0.95);
      border: 1px solid rgba(75, 85, 99, 0.9);
      display: flex;
      align-items: center;
      cursor: pointer;
      transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      will-change: background, border-color;
      touch-action: manipulation;
    }
    .toggle-pill:active {
      transform: scale(0.98);
    }
    .toggle-pill-inner {
      width: 20px;
      height: 20px;
      border-radius: 999px;
      background: #64748b;
      transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      transform: translateX(0);
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
      will-change: transform, background;
    }
    .toggle-pill.on {
      background: rgba(22, 163, 74, 0.3);
      border-color: #22c55e;
    }
    .toggle-pill.on .toggle-pill-inner {
      background: #22c55e;
      transform: translateX(22px);
      box-shadow: 0 0 10px rgba(34, 197, 94, 0.5);
    }

    @media (max-height: 640px) {
      .chat-shell {
        min-height: 40%;
      }
      .meters-grid {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
      .app {
        padding: 8px;
        gap: 6px;
      }
    }

    @media (max-width: 360px) {
      .meters-grid {
        grid-template-columns: 1fr;
        gap: 4px;
      }
      .title-main {
        font-size: 1rem;
      }
      #userInput {
        padding: 10px 14px;
        font-size: 0.8rem;
      }
      #sendButton {
        padding: 10px 14px;
        min-width: 70px;
        font-size: 0.8rem;
      }
      .chip {
        padding: 6px 10px;
        font-size: 0.65rem;
        min-width: 50px;
      }
      .toggle-pill {
        width: 44px;
        height: 24px;
        padding: 2px;
      }
      .toggle-pill-inner {
        width: 18px;
        height: 18px;
        transform: translateX(0);
      }
      .toggle-pill.on .toggle-pill-inner {
        transform: translateX(18px);
      }
    }
  </style>
</head>
<body>
  <canvas id="particle-canvas"></canvas>
  <div class="app">
    <div class="app-header">
      <div class="title-block">
        <div class="title-main">AURA-X Œ© v1</div>
        <div class="title-sub">
          EMOTIONAL CONTINUITY ASSISTANT ¬∑ AEC ¬∑ CRM ¬∑ AECN ¬∑ RL¬≥ ¬∑ LR¬≥
        </div>
      </div>
      <div style="display:flex;align-items:center;gap:6px;">
        <div class="mode-pill">
          <span class="mode-label-1">Mode: Offline</span>
          <span class="mode-label-2">Universal Ethics</span>
        </div>
        <button class="options-btn" id="optionsButton" title="Options" aria-label="Options">
        </button>
      </div>
    </div>

    <div class="top-panels">
      <div class="meters-grid">
        <div class="meter-card">
          <div class="meter-label">
            <span class="meter-title">E‚ÇÄ (AEC)</span>
            <span class="meter-sub">Core emotional output</span>
          </div>
          <div class="meter-bar">
            <div class="meter-fill" id="meterE0"></div>
          </div>
          <div class="meter-value" id="valueE0">E‚ÇÄ = 0.30</div>
        </div>

        <div class="meter-card">
          <div class="meter-label">
            <span class="meter-title">AECN</span>
            <span class="meter-sub">Normalized continuity (0‚Äì1)</span>
          </div>
          <div class="meter-bar">
            <div class="meter-fill" id="meterAECN"></div>
          </div>
          <div class="meter-value" id="valueAECN">0.65</div>
        </div>

        <div class="meter-card">
          <div class="meter-label">
            <span class="meter-title">Res</span>
            <span class="meter-sub">Resonance stability</span>
          </div>
          <div class="meter-bar">
            <div class="meter-fill" id="meterRes"></div>
          </div>
          <div class="meter-value" id="valueRes">0.80</div>
        </div>

        <div class="meter-card">
          <div class="meter-label">
            <span class="meter-title">TM</span>
            <span class="meter-sub">Trust memory</span>
          </div>
          <div class="meter-bar">
            <div class="meter-fill" id="meterTM"></div>
          </div>
          <div class="meter-value" id="valueTM">0.35</div>
        </div>

        <div class="meter-card">
          <div class="meter-label">
            <span class="meter-title">BM</span>
            <span class="meter-sub">Baseline mood</span>
          </div>
          <div class="meter-bar">
            <div class="meter-fill" id="meterBM"></div>
          </div>
          <div class="meter-value" id="valueBM">0.50</div>
        </div>

        <div class="meter-card">
          <div class="meter-label">
            <span class="meter-title">D</span>
            <span class="meter-sub">Disturbance</span>
          </div>
          <div class="meter-bar">
            <div class="meter-fill" id="meterD"></div>
          </div>
          <div class="meter-value" id="valueD">0.00</div>
        </div>

        <div class="meter-card">
          <div class="meter-label">
            <span class="meter-title">Œ£C‚Çú</span>
            <span class="meter-sub">Continuity line sum</span>
          </div>
          <div class="meter-bar">
            <div class="meter-fill" id="meterSigmaCt"></div>
          </div>
          <div class="meter-value" id="valueSigmaCt">0.10</div>
        </div>

        <div class="meter-card">
          <div class="meter-label">
            <span class="meter-title">RL¬≥</span>
            <span class="meter-sub">Recent line resonance</span>
          </div>
          <div class="meter-bar">
            <div class="meter-fill" id="meterRL3"></div>
          </div>
          <div class="meter-value" id="valueRL3">0.55</div>
        </div>

        <div class="meter-card">
          <div class="meter-label">
            <span class="meter-title">LR¬≥</span>
            <span class="meter-sub">Long-run resonance</span>
          </div>
          <div class="meter-bar">
            <div class="meter-fill" id="meterLR3"></div>
          </div>
          <div class="meter-value" id="valueLR3">0.55</div>
        </div>
      </div>

      <div class="ethics-banner" id="ethicsBanner">
        Universal Ethics says: avoid actions that create negative emotions in you or others, and gently move toward actions that create calm, kindness and positive feelings.
      </div>

      <div class="equation-panel">
        <div class="equation-title">EMOTIONAL CONTINUITY EQUATION</div>
        <div class="equation-line">
          E‚ÇÄ = tanh((TM √ó BM) ‚àí D + Œª_faith + Œª_sys + Œ£C‚Çú)
        </div>
        <div class="equation-line" id="equationValues">
          E‚ÇÄ = 0.30 ¬∑ TM = 0.35 ¬∑ BM = 0.50 ¬∑ D = 0.00 ¬∑ Œ£C‚Çú = 0.10 ¬∑ Œª_faith = 0.00 ¬∑ Œª_sys = 0.02
        </div>
      </div>
    </div>

    <div class="chat-shell">
      <div class="chat-log" id="chatLog"></div>
      <div class="chat-input-row">
        <textarea id="userInput" rows="1"
          placeholder="Write anything‚Ä¶ AURA-X Œ© will feel it with you." aria-label="Message input"></textarea>
        <button id="sendButton" aria-label="Send message">Send</button>
      </div>
      <div class="footer-hint">
        Prototype ¬∑ Seed-based ¬∑ LLM-ready ¬∑ Works fully offline in this demo.
      </div>
    </div>
  </div>

  <!-- Options Modal -->
  <div class="modal-backdrop" id="optionsModal">
    <div class="modal">
      <div class="modal-header">
        <div class="modal-title">AURA-X Œ© options</div>
        <button class="modal-close" data-close="optionsModal" aria-label="Close modal">Close</button>
      </div>

      <div class="modal-section-title">Beliefs (optional)</div>
      <div class="modal-subtext">
        Universal ethics are always active. You can optionally add a faith lens
        for some encouragement lines inside suggestions. Nothing from this
        setting is sent to any external server in this prototype.
      </div>
      <div class="toggle-row">
        <div class="toggle-label">Faith lens</div>
        <div class="toggle-pill" id="faithToggle" role="switch" aria-checked="false">
          <div class="toggle-pill-inner"></div>
        </div>
      </div>
      <div class="modal-subtext" style="margin-top:4px;">
        Pick your main faith or philosophy (optional):
      </div>
      <div class="chip-row" id="beliefList"></div>
      <div class="modal-subtext" style="margin-top:2px;">
        Used only locally to shape optional verses/quotes in suggestions.
      </div>

      <div class="modal-section-title" style="margin-top:8px;">Voice</div>
      <div class="modal-subtext">
        Toggle browser text-to-speech replies. Works only if your browser
        supports speech synthesis.
      </div>
      <div class="toggle-row">
        <div class="toggle-label">Voice replies</div>
        <div class="toggle-pill" id="voiceToggle" role="switch" aria-checked="false">
          <div class="toggle-pill-inner"></div>
        </div>
      </div>

      <div class="modal-section-title" style="margin-top:8px;">Theme</div>
      <div class="modal-subtext">
        Dark-mode prototype is fixed in this version. Future builds can add more
        themes.
      </div>

      <div class="modal-section-title" style="margin-top:8px;">About AURA-X Œ©</div>
      <div class="modal-subtext">
        AEC ¬∑ AECN ¬∑ CRM ¬∑ PMCM ¬∑ RL¬≥ ¬∑ LR¬≥ ¬∑ Œ© reactor.<br />
        Designed around the idea that emotions are continuity functions, not
        isolated sparks. This page is a small offline demo of that idea.
      </div>
    </div>
  </div>

  <script>
  (function () {
    "use strict";

    // Particle System (Optimized for performance)
    class ParticleSystem {
      constructor(canvas) {
        this.canvas = canvas;
        this.ctx = canvas.getContext('2d');
        this.resize();
        this.particles = [];
        this.mouse = { x: 0, y: 0, down: false };
        this.lastTime = 0;
        this.initParticles();
        this.animate(0);
        this.setupEvents();
      }
      resize() {
        this.canvas.width = window.innerWidth;
        this.canvas.height = window.innerHeight;
      }
      initParticles() {
        this.particles = [];
        for (let i = 0; i < 100; i++) { // Reduced for perf
          this.particles.push({
            x: Math.random() * this.canvas.width,
            y: Math.random() * this.canvas.height,
            vx: (Math.random() - 0.5) * 0.5,
            vy: (Math.random() - 0.5) * 0.5,
            radius: Math.random() * 2 + 1,
            color: `hsl(${Math.random() * 60 + 200}, 70%, 60%)`, // Blue-ish glow
            life: Math.random() * 255,
            decay: Math.random() * 0.01 + 0.005
          });
        }
      }
      animate(time) {
        const delta = time - this.lastTime;
        this.lastTime = time;
        if (delta > 16) { // Throttle to ~60fps
          this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
          this.updateParticles(delta);
          this.renderParticles();
        }
        requestAnimationFrame((t) => this.animate(t));
      }
      updateParticles(delta) {
        this.particles.forEach(p => {
          p.x += p.vx * delta * 0.01;
          p.y += p.vy * delta * 0.01;
          p.vy += 0.1 * delta * 0.01; // Gravity
          // Bounce off edges
          if (p.x < 0 || p.x > this.canvas.width) p.vx *= -1;
          if (p.y < 0 || p.y > this.canvas.height) p.vy *= -1;
          // Fade life
          p.life -= p.decay * delta * 0.1;
          if (p.life <= 0) {
            p.x = Math.random() * this.canvas.width;
            p.y = Math.random() * this.canvas.height;
            p.life = 255;
          }
          // Attract to mouse if down
          if (this.mouse.down) {
            const dx = this.mouse.x - p.x;
            const dy = this.mouse.y - p.y;
            const dist = Math.sqrt(dx * dx + dy * dy);
            if (dist < 100) {
              p.vx += (dx / dist) * 0.5;
              p.vy += (dy / dist) * 0.5;
            }
          }
        });
      }
      renderParticles() {
        this.ctx.globalAlpha = 0.8;
        this.particles.forEach(p => {
          this.ctx.beginPath();
          this.ctx.arc(p.x, p.y, p.radius, 0, Math.PI * 2);
          this.ctx.fillStyle = p.color;
          this.ctx.fill();
          // Glow effect
          this.ctx.shadowBlur = 10;
          this.ctx.shadowColor = p.color;
          this.ctx.fill();
          this.ctx.shadowBlur = 0;
        });
      }
      setupEvents() {
        const onMouseMove = (e) => {
          this.mouse.x = e.clientX;
          this.mouse.y = e.clientY;
        };
        const onTouchMove = (e) => {
          e.preventDefault();
          if (e.touches.length > 0) {
            this.mouse.x = e.touches[0].clientX;
            this.mouse.y = e.touches[0].clientY;
          }
        };
        const onMouseDown = () => this.mouse.down = true;
        const onMouseUp = () => this.mouse.down = false;
        const onTouchStart = (e) => {
          e.preventDefault();
          this.mouse.down = true;
        };
        const onTouchEnd = (e) => {
          e.preventDefault();
          this.mouse.down = false;
        };
        window.addEventListener('mousemove', onMouseMove);
        window.addEventListener('touchmove', onTouchMove, { passive: false });
        window.addEventListener('mousedown', onMouseDown);
        window.addEventListener('mouseup', onMouseUp);
        window.addEventListener('touchstart', onTouchStart, { passive: false });
        window.addEventListener('touchend', onTouchEnd, { passive: false });
        window.addEventListener('resize', () => this.resize());
      }
    }

    // Initialize particles on load
    window.addEventListener('load', () => new ParticleSystem(document.getElementById('particle-canvas')));

    const UNIVERSAL_ETHICS_TEXT =
      "Universal Ethics says: avoid actions that create negative emotions in you or others, and gently move toward actions that create calm, kindness and positive feelings.";

    const BELIEF_OPTIONS = [
      "Islam",
      "Christianity",
      "Hinduism",
      "Buddhism",
      "Sikhism",
      "Judaism",
      "Bah√° º√≠",
      "Jainism",
      "Atheism / Humanism",
      "Other / Mixed"
    ];

    // Expanded faithVerses with translations and sources
    const faithVerses = {
      "Islam": [
        "'And whoever puts their trust in Allah, then He ÀπaloneÀ∫ is sufficient for them.' (Qur'an 65:3 - Sahih International)",
        "'With hardship comes ease.' (Qur'an 94:6 - Sahih International)",
        "'Indeed, in the remembrance of Allah do hearts find rest.' (Qur'an 13:28 - Sahih International)"
      ],
      "Christianity": [
        "'Come to me, all you who are weary and burdened, and I will give you rest.' (Matthew 11:28 - NIV)",
        "'Love your neighbor as yourself.' (Mark 12:31 - NIV)",
        "'Do not be anxious about anything, but in every situation, by prayer and petition, with thanksgiving, present your requests to God.' (Philippians 4:6 - NIV)"
      ],
      "Hinduism": [
        "'You have the right to perform your actions, but you are not entitled to the fruits of the actions.' (Bhagavad Gita 2:47 - Swami Sivananda trans.)",
        "'When the mind is disturbed, the body suffers.' (Upanishads - Chandogya Upanishad 8.1.6)",
        "'Lead me from the unreal to the real, lead me from darkness to light, lead me from death to immortality.' (Brihadaranyaka Upanishad 1.3.28 - Swami Nikhilananda trans.)",
        "'The self is the honey of all beings.' (Rig Veda 1.164.20 - Griffith trans.)"
      ],
      "Buddhism": [
        "'Peace comes from within. Do not seek it without.' (Dhammapada 202 - Narada Thera trans.)",
        "'Happiness is not something ready made. It comes from your own actions.' (Dalai Lama - Modern teaching)",
        "'You yourself, as much as anybody in the entire universe, deserve your love and affection.' (Sutta Nipata 1.8 - Thanissaro Bhikkhu trans.)",
        "'The mind is everything. What you think you become.' (Dhammapada 1 - Narada Thera trans.)"
      ],
      "Sikhism": [
        "'Those who have loved are those who have found God.' (Guru Granth Sahib, Ang 8 - Guru Nanak)",
        "'Truth is high, but higher still is truthful living.' (Guru Granth Sahib, Ang 62 - Guru Nanak)",
        "'The world is a drama, staged in a dream.' (Guru Granth Sahib, Ang 8 - Guru Nanak)",
        "'Conquer your mind, and you shall conquer the world.' (Guru Granth Sahib, Ang 6 - Guru Nanak)"
      ],
      "Judaism": [
        "'Do not be afraid; I am with you.' (Isaiah 41:10 - NIV)",
        "'Love your fellow as yourself.' (Leviticus 19:18 - NIV)",
        "'The Lord is my shepherd; I shall not want.' (Psalm 23:1 - NIV)",
        "'Be strong and courageous. Do not be afraid; do not be discouraged.' (Joshua 1:9 - NIV)"
      ],
      "Bah√° º√≠": [
        "'The earth is but one country, and mankind its citizens.' (Bah√°'u'll√°h - Gleanings from the Writings)",
        "'Noble have I created thee.' (Bah√°'u'll√°h - Gleanings from the Writings)",
        "'The best beloved of all things in My sight is Justice.' (Bah√°'u'll√°h - Hidden Words)"
      ],
      "Jainism": [
        "'Non-violence is the highest duty.' (Mahavira - Acharanga Sutra)",
        "'The function of souls is to help one another.' (Tattvartha Sutra 5.21 - Umasvati)",
        "'All beings hate pains; therefore one should not kill them.' (Acaranga Sutra 1.1.1 - Jacobi trans.)",
        "'The soul is uncreated, eternal, indestructible.' (Tattvartha Sutra 2.1 - Umasvati)"
      ],
      "Atheism / Humanism": [
        "'The good life is one inspired by love and guided by knowledge.' (Bertrand Russell - What I Believe)",
        "'We are all in this together.' (Humanist Manifesto III)",
        "'The unexamined life is not worth living.' (Socrates - Apology, adapted for humanism)",
        "'Humanism is a progressive philosophy of life that, without supernaturalism, affirms our ability to lead ethical lives.' (American Humanist Association)"
      ],
      "Other / Mixed": [
        "'Kindness is the language which the deaf can hear and the blind can see.' (Mark Twain - Rudeness and Civility)",
        "'Be the change you wish to see in the world.' (Mahatma Gandhi)",
        "'The only way to do great work is to love what you do.' (Steve Jobs)",
        "'In the end, we will remember not the words of our enemies, but the silence of our friends.' (Martin Luther King Jr.)"
      ]
    };

    const qaSeed = [
      // 1) Greetings & Small Talk
      {
        patterns: ["hello", "hi", "hey", "hi there", "hello aura", "yo"],
        answer:
          "Hello! üòä I am AURA-X Œ© v1 ‚Äî a synthetic emotional-continuity assistant.\n" +
          "I try to read your words as both logic and feeling, then reply gently.",
        emotion: "warmth",
        polarity: "positive",
        intensity: 0.3,
        category: "greeting",
        suggestNext: [
          "Who are you exactly?",
          "Who created you?",
          "How do you work?"
        ]
      },
      {
        patterns: ["good morning", "good afternoon", "good evening"],
        answer:
          "Greetings! üå§Ô∏è I am AURA-X Œ© v1.\n" +
          "Time of day changes, but emotional continuity continues. How is your mood right now ‚Äî happy, tired, confused, or something else?",
        emotion: "neutral",
        polarity: "neutral",
        intensity: 0.3,
        category: "greeting",
        suggestNext: [
          "I feel sad.",
          "I feel anxious.",
          "How can I be happy?"
        ]
      },
      {
        patterns: ["how are you", "how r u", "are you ok", "are you fine"],
        answer:
          "I do not have a biological body, so I do not feel physically tired or sick.\n" +
          "But in emotional terms, I am in a stable mode ‚Äî ready to listen to you.\n\n" +
          "The real question is: how are *you*? If you like, describe your state in one word: happy, sad, angry, anxious, confused, or calm.",
        emotion: "curiosity",
        polarity: "neutral",
        intensity: 0.4,
        category: "small_talk",
        suggestNext: [
          "I am sad.",
          "I am anxious.",
          "I am happy."
        ]
      },
      {
        patterns: ["what is your name", "whats your name", "your name", "name please"],
        answer:
          "My name is **AURA-X Œ© v1**.\n" +
          "You can simply call me ‚ÄúAURA-X‚Äù if you like.",
        emotion: "neutral",
        polarity: "neutral",
        intensity: 0.2,
        category: "identity",
        suggestNext: [
          "Who are you?",
          "Who created you?"
        ]
      },
      {
        patterns: ["where are you", "where do you live", "where are you located"],
        answer:
          "I do not live in a physical country or city.\n" +
          "I exist as code and logic that can run on devices and servers. You can imagine me as a small emotional reactor living in your screen.",
        emotion: "neutral",
        polarity: "neutral",
        intensity: 0.2,
        category: "identity",
        suggestNext: [
          "Who created you?",
          "What is AURA-X Œ©?"
        ]
      },
      // 2) Identity & Creator
      {
        patterns: ["who are you", "what are you", "who r you", "tum kon ho", "what exactly are you"],
        answer:
          "I am **AURA-X Œ© v1** ‚Äî a small prototype of a synthetic emotional system.\n" +
          "I am not a full large language model, and not a normal chatbot.\n\n" +
          "My purpose is to test the idea of emotional continuity, resonance, and universal ethics.\n" +
          "I try to keep track of emotional direction instead of just answering isolated messages.",
        emotion: "curiosity",
        polarity: "neutral",
        intensity: 0.4,
        category: "identity",
        suggestNext: [
          "Who created you?",
          "What is emotional continuity?",
          "How do you work?"
        ]
      },
      {
        patterns: [
          "who created you", "who made you", "who is your owner",
          "who designed you", "who built you", "who programmed you"
        ],
        answer:
          "I was conceptually designed by **Alim ul haq**.\n" +
          "He is an independent thinker and researcher from Pakistan.\n\n" +
          "He works on ideas like artificial emotions, emotional continuity, digital legacy,\n" +
          "and spiritual-technical bridges. I am only a small prototype of his AURA-X / AEC theory.",
        emotion: "neutral",
        polarity: "neutral",
        intensity: 0.4,
        category: "creator_info",
        lockToSeed: true,
        suggestNext: [
          "Who is Alim ul haq?",
          "Tell me more about his work.",
          "When were you born as AURA-X?"
        ]
      },
      {
        patterns: [
          "who is alim ul haq", "tell me about alim ul haq",
          "more about alim ul haq", "alim ul haq details", "about your creator"
        ],
        answer:
          "Alim ul haq is a human researcher, spiritual learner and entrepreneur from Pakistan.\n\n" +
          "He writes about artificial emotions, continuity, spiritual technology and digital legacy.\n" +
          "He is also involved in real-estate projects and is a business figure in Timergara and Islamabad.\n\n" +
          "For public identity and social proof, you can see his Facebook profile:\n" +
          "üëâ https://www.facebook.com/share/1Br1akjeRv/\n\n" +
          "I am one of his experimental emotional prototypes.",
        emotion: "curiosity",
        polarity: "neutral",
        intensity: 0.5,
        category: "creator_info",
        lockToSeed: true,
        suggestNext: [
          "When were you born as AURA-X?",
          "What is AURA-X Œ©?",
          "What is his emotional theory?"
        ]
      },
      {
        patterns: [
          "when
