<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>AURA-X Î© â€“ Emotional Reactor</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    /* ===== Base Layout ===== */
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
    }
    body {
      background: #020617;
      color: #e5e7eb;
      font-family: system-ui, -apple-system, BlinkMacSystemFont,
        "SF Pro Text", "Segoe UI", sans-serif;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }
    #app {
      position: relative;
      width: 100%;
      max-width: 480px;
      height: 100vh;
      box-sizing: border-box;
      padding: 16px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      transform-origin: top center;
    }

    /* ===== Card ===== */
    .card {
      position: relative;
      width: 100%;
      max-width: 420px;
      background: radial-gradient(circle at top, #020817 0%, #020617 40%, #020617 100%);
      border-radius: 32px;
      padding: 20px 20px 20px;
      box-shadow:
        0 20px 60px rgba(0,0,0,0.9),
        0 0 0 1px rgba(148,163,184,0.2);
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 12px;
    }

    /* ===== Header row (title + menu button) ===== */
    .header-row {
      width: 100%;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      margin-bottom: 8px;
    }
    .header-titles {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }
    .title {
      font-size: 22px;
      letter-spacing: 0.18em;
      text-transform: uppercase;
      color: #facc15;
      text-align: left;
    }
    .subtitle {
      font-size: 11px;
      letter-spacing: 0.24em;
      text-transform: uppercase;
      color: #9ca3af;
      text-align: left;
    }

    /* ===== Menu button style (top-right) ===== */
    .pill-button {
      width: 40px;
      height: 40px;
      border-radius: 999px;
      border: 1px solid rgba(148,163,184,0.5);
      background: radial-gradient(circle at top, #0f172a 0%, #020617 70%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 15px;
      color: #e5e7eb;
      cursor: pointer;
      box-shadow: 0 8px 18px rgba(0,0,0,0.65);
      transition:
        transform 160ms ease,
        box-shadow 160ms ease,
        border-color 160ms ease,
        background 160ms ease;
      flex-shrink: 0;
    }
    .pill-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 24px rgba(15,23,42,0.9);
    }
    .pill-button.active {
      border-color: #e5e7eb;
      background: radial-gradient(circle at top, #1f2937 0%, #020617 80%);
    }
    .pill-button span.menu-bars {
      width: 16px;
      height: 11px;
      position: relative;
    }
    .pill-button span.menu-bars::before,
    .pill-button span.menu-bars::after,
    .pill-button span.menu-bars div {
      content: "";
      position: absolute;
      left: 0;
      right: 0;
      height: 2px;
      border-radius: 999px;
      background: #e5e7eb;
    }
    .pill-button span.menu-bars::before {
      top: 0;
    }
    .pill-button span.menu-bars::after {
      bottom: 0;
    }
    .pill-button span.menu-bars div {
      top: 50%;
      transform: translateY(-50%);
    }

    /* ===== Celestial orb (Sun / Moon) ===== */
    .celestial-wrapper {
      position: relative;
      width: 200px;
      height: 200px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 8px;
    }
    .celestial-glow {
      position: absolute;
      width: 180px;
      height: 180px;
      border-radius: 50%;
      filter: blur(40px);
      opacity: 0.9;
      pointer-events: none;
      transition: opacity 250ms ease, background 250ms ease;
    }
    .celestial {
      position: relative;
      width: 140px;
      height: 140px;
      border-radius: 50%;
      cursor: pointer;
      transition:
        transform 400ms ease,
        box-shadow 400ms ease,
        background 400ms ease;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }
    .celestial.sun {
      background:
        radial-gradient(circle at 30% 30%, #fff7c2 0%, #fde047 20%, #f97316 55%, #b45309 100%);
      box-shadow:
        0 0 35px rgba(250,204,21,0.9),
        0 0 80px rgba(251,191,36,0.8);
    }
    .sun-glow {
      background: radial-gradient(circle, rgba(250,204,21,0.38), transparent 70%);
    }
    .celestial.moon {
      background:
        radial-gradient(circle at 30% 30%, #ffffff 0%, #e5e7eb 40%, #cbd5f5 70%, #9ca3af 100%);
      box-shadow:
        0 0 26px rgba(191,219,254,0.8),
        0 0 70px rgba(129,140,248,0.55);
    }
    .moon::before,
    .moon::after {
      content: "";
      position: absolute;
      border-radius: 50%;
      opacity: 0.18;
      background: radial-gradient(circle at 30% 30%, #9ca3af 0%, transparent 60%);
    }
    .moon::before {
      width: 60%;
      height: 60%;
      top: 18%;
      left: 12%;
    }
    .moon::after {
      width: 38%;
      height: 38%;
      bottom: 12%;
      right: 6%;
    }
    .moon-glow {
      background: radial-gradient(circle, rgba(191,219,254,0.35), transparent 70%);
    }
    .celestial.empty {
      background: transparent;
      box-shadow: none;
    }
    .floating {
      animation: floatOrb 5s ease-in-out infinite;
    }
    @keyframes floatOrb {
      0% { transform: translateY(0); }
      50% { transform: translateY(-8px); }
      100% { transform: translateY(0); }
    }

    /* ===== Text ===== */
    .mode-line {
      font-size: 12px;
      color: #d1d5db;
      margin-top: 4px;
    }
    .mode-line span {
      color: #fbbf24;
    }
    .you-said {
      font-size: 12px;
      color: #9ca3af;
    }
    .assistant-text {
      font-size: 14px;
      text-align: center;
      margin-top: 4px;
      margin-bottom: 10px;
    }

    /* ===== Ethics box (light gold English) ===== */
    .ethics-box {
      width: 100%;
      border-radius: 16px;
      padding: 10px 12px;
      background: rgba(15,23,42,0.9);
      border: 1px solid rgba(250, 204, 21, 0.7);
      color: #fde68a;         /* light gold text */
      font-size: 12px;
      line-height: 1.5;
    }
    .ethics-box strong {
      color: #facc15;
    }

    /* ===== Equation panel ===== */
    .equation-panel {
      width: 100%;
      border-radius: 16px;
      padding: 10px 12px 8px;
      background: rgba(15,23,42,1);
      border: 1px solid rgba(148,163,184,0.5);
      font-size: 11px;
    }
    .eq-title {
      letter-spacing: 0.16em;
      text-transform: uppercase;
      color: #9ca3af;
      margin-bottom: 4px;
    }
    .eq-row {
      margin-top: 4px;
    }
    .eq-row span.label {
      color: #9ca3af;
    }
    .eq-row span.value {
      color: #e5e7eb;
      margin-right: 6px;
    }
    .eq-row span.value.highlight {
      color: #facc15;
      font-weight: 600;
    }
    .eq-bar {
      margin-top: 6px;
      width: 100%;
      height: 6px;
      border-radius: 999px;
      background: linear-gradient(to right, #b91c1c, #f59e0b, #10b981);
      overflow: hidden;
    }
    .eq-bar-inner {
      height: 100%;
      width: 50%;
      border-radius: 999px;
      background: rgba(15,23,42,0.9);
      transform-origin: left center;
    }

    /* ===== Input bar ===== */
    .input-row {
      width: 100%;
      max-width: 420px;
      margin-top: 16px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .input-shell {
      flex: 1;
      border-radius: 999px;
      padding: 10px 14px;
      border: 1px solid rgba(148,163,184,0.5);
      background: radial-gradient(circle at top, #020617, #020617 60%, #020617);
      font-size: 13px;
      display: flex;
      align-items: center;
      gap: 8px;
      color: #9ca3af;
    }
    .input-shell span.sparkle {
      font-size: 14px;
    }
    .input-shell input {
      flex: 1;
      border: none;
      outline: none;
      background: transparent;
      color: #e5e7eb;
      font-size: 13px;
    }
    .send-button {
      border: none;
      border-radius: 999px;
      padding: 10px 26px;
      font-size: 14px;
      font-weight: 600;
      background: radial-gradient(circle at top, #fde047, #fbbf24 40%, #f59e0b 100%);
      color: #111827;
      cursor: pointer;
      box-shadow:
        0 0 22px rgba(250,204,21,0.6),
        0 16px 32px rgba(0,0,0,0.8);
      transition:
        transform 140ms ease,
        box-shadow 140ms ease,
        filter 140ms ease;
    }
    .send-button:active {
      transform: translateY(1px) scale(0.98);
      box-shadow: 0 6px 18px rgba(0,0,0,0.9);
      filter: brightness(0.96);
    }

    /* ===== Menu panel (dropdown under top-right button) ===== */
    .menu-panel {
      position: absolute;
      top: 52px;
      right: 20px;
      background: rgba(15,23,42,0.98);
      border-radius: 16px;
      padding: 6px 8px;
      box-shadow: 0 18px 40px rgba(0,0,0,0.95);
      border: 1px solid rgba(148,163,184,0.55);
      display: none;
      flex-direction: column;
      gap: 4px;
      z-index: 15;
      min-width: 150px;
    }
    .menu-panel.visible {
      display: flex;
    }
    .menu-item {
      padding: 6px 8px;
      border-radius: 10px;
      font-size: 13px;
      cursor: pointer;
      color: #e5e7eb;
      display: flex;
      justify-content: space-between;
      align-items: center;
      transition:
        background 120ms ease,
        color 120ms ease;
    }
    .menu-item span.label {
      flex: 1;
    }
    .menu-item span.sub {
      font-size: 11px;
      color: #9ca3af;
      margin-left: 6px;
    }
    .menu-item:hover {
      background: rgba(31,41,55,0.95);
    }
    .menu-item.active {
      background: rgba(31,41,55,0.95);
      color: #f9fafb;
    }

    /* ===== Overlays ===== */
    .overlay {
      position: fixed;
      inset: 0;
      background: rgba(15,23,42,0.86);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 30;
    }
    .overlay.visible {
      display: flex;
    }
    .panel {
      width: 100%;
      max-width: 420px;
      margin: 0 16px;
      background: radial-gradient(circle at top, #020617 0%, #020617 40%, #020617 100%);
      border-radius: 24px;
      box-shadow:
        0 24px 60px rgba(0,0,0,0.95),
        0 0 0 1px rgba(148,163,184,0.35);
      padding: 18px 18px 16px;
      color: #e5e7eb;
      font-size: 14px;
    }
    .panel-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 10px;
    }
    .panel-title {
      font-size: 16px;
      font-weight: 600;
    }
    .close-btn {
      border-radius: 999px;
      padding: 5px 12px;
      border: 1px solid rgba(148,163,184,0.6);
      background: rgba(15,23,42,0.9);
      font-size: 12px;
      color: #e5e7eb;
      cursor: pointer;
    }
    .chip-row {
      display: grid;
      grid-template-columns: repeat(2, minmax(0,1fr));
      gap: 8px;
      margin-top: 10px;
    }
    .chip {
      border-radius: 999px;
      padding: 8px 10px;
      border: 1px solid rgba(148,163,184,0.7);
      text-align: center;
      font-size: 13px;
      cursor: pointer;
      background: radial-gradient(circle at top, #020617 0%, #020617 70%, #020617 100%);
      color: #e5e7eb;
      transition:
        background 150ms ease,
        border-color 150ms ease,
        color 150ms ease;
    }
    .chip.selected {
      background: radial-gradient(circle at top, #111827 0%, #020617 80%);
      border-color: #e5e7eb;
      color: #f9fafb;
    }
    .panel-sub {
      font-size: 12px;
      color: #9ca3af;
      margin-bottom: 4px;
    }
    .panel-footer {
      margin-top: 10px;
      font-size: 12px;
      color: #9ca3af;
    }
    .theme-options {
      display: flex;
      gap: 8px;
      margin-top: 6px;
    }
    .theme-pill {
      flex: 1;
      border-radius: 999px;
      border: 1px solid rgba(148,163,184,0.7);
      padding: 8px 0;
      text-align: center;
      font-size: 13px;
      cursor: pointer;
      background: radial-gradient(circle at top, #020617 0%, #020617 70%, #020617 100%);
      color: #e5e7eb;
      transition:
        background 150ms ease,
        border-color 150ms ease,
        color 150ms ease;
    }
    .theme-pill.active {
      border-color: #e5e7eb;
      background: radial-gradient(circle at top, #111827 0%, #020617 80%);
      color: #f9fafb;
    }

    @media (max-height: 640px) {
      .card { transform: scale(0.94); }
    }
  </style>
</head>
<body>
  <div id="app">
    <div class="card" id="card">
      <div class="header-row">
        <div class="header-titles">
          <div class="title">AURA-X Î©</div>
          <div class="subtitle">Logical Â· Emotional Â· Universal Ethics Reactor</div>
        </div>
        <button class="pill-button" id="menuBtn" title="Options menu">
          <span class="menu-bars"><div></div></span>
        </button>
      </div>

      <div class="celestial-wrapper">
        <div class="celestial-glow sun-glow" id="celestialGlow"></div>
        <div class="celestial sun" id="celestialOrb"
             title="Tap to cycle: sun â†’ live moon â†’ calm moon â†’ empty â†’ sun"></div>
      </div>

      <div class="menu-panel" id="menuPanel">
        <div class="menu-item" id="beliefsMenuItem">
          <span class="label">Beliefs</span>
          <span class="sub">optional</span>
        </div>
        <div class="menu-item" id="themeMenuItem">
          <span class="label">Theme</span>
          <span class="sub">day / night</span>
        </div>
        <div class="menu-item" id="voiceMenuItem">
          <span class="label">Voice</span>
          <span class="sub" id="voiceStatus">on</span>
        </div>
        <div class="menu-item" id="llmMenuItem">
          <span class="label">LLM</span>
          <span class="sub" id="llmLabel">offline</span>
        </div>
        <div class="menu-item" id="languageMenuItem">
          <span class="label">Language</span>
          <span class="sub">future</span>
        </div>
        <div class="menu-item" id="aboutMenuItem">
          <span class="label">About</span>
        </div>
      </div>

      <div class="mode-line">
        Mode: <span id="modeLabel">Natural Â· Universal Ethics</span>
      </div>
      <div class="you-said" id="youSaid">You said: "hello"</div>
      <div class="assistant-text" id="assistantText">
        Hello! ğŸ˜Š I am AURA-X Î© â€” an emotional-continuity reactor.  
        Whatever you write, Iâ€™ll try to understand it with both logic and feeling.
      </div>

      <div class="ethics-box" id="ethicsBox">
        <strong>Universal Ethics says:</strong> avoid actions that create strong negative
        emotions in you or in others â€” fear, humiliation, deep sadness.  
        Almost every religion, and even people with no religion, discourage behaviours like
        <strong>stealing, cheating, breaking trust, abuse and harsh insults, arrogance,
        jealousy, bullying and deliberate cruelty</strong>.
        <br /><br />
        Move gently toward actions that create healthy positive emotions which are allowed
        and appreciated everywhere: <strong>kindness, empathy, honest speech, keeping
        promises, helping others, saying â€œthank youâ€, forgiving mistakes and protecting
        people from harm</strong>.  
        Over time, these positive emotions lead to more peace, joy and inner stability for
        everyone.
      </div>

      <div class="equation-panel">
        <div class="eq-title">Continuity Equation</div>
        <div class="eq-row">
          <span class="label">
            Eâ‚€ = tanh((TM Ã— BM) âˆ’ D + Î»_faith + Î»_sys + Î£C_t)
          </span>
        </div>
        <div class="eq-row" id="eqNumbers">
          <span class="label">TM:</span><span class="value" id="tmVal">0.10</span>
          <span class="label">BM:</span><span class="value" id="bmVal">1.00</span>
          <span class="label">D:</span><span class="value" id="dVal">0.00</span>
          <span class="label">Î»_faith:</span><span class="value" id="lambdaFaithVal">0.15</span>
          <span class="label">Î»_sys:</span><span class="value" id="lambdaSysVal">0.10</span>
          <span class="label">Î£C_t:</span><span class="value" id="ctSumVal">0.15</span>
          <span class="label">Eâ‚€:</span><span class="value highlight" id="e0Val">0.29</span>
        </div>
        <div class="eq-bar">
          <div class="eq-bar-inner" id="e0Bar"></div>
        </div>
      </div>
    </div>

    <div class="input-row">
      <div class="input-shell">
        <span class="sparkle">âœ¨</span>
        <input id="userInput" type="text"
               placeholder="Write anythingâ€¦ AURA-X will feel it with you." />
      </div>
      <button class="send-button" id="sendBtn">Send</button>
    </div>
  </div>

  <div class="overlay" id="beliefOverlay">
    <div class="panel">
      <div class="panel-header">
        <div class="panel-title">Belief settings</div>
        <button class="close-btn" data-close="beliefOverlay">Close</button>
      </div>
      <div class="panel-sub">
        Faith is optional Â· Base rule is always <strong>Universal Ethics</strong>.
      </div>
      <div class="panel-sub">
        Pick one or more traditions. Nothing is sent anywhere.
      </div>
      <div class="chip-row" id="beliefChips"></div>
      <div class="panel-footer" id="beliefFooter">
        Currently selected: <strong>Natural Â· Universal Ethics</strong>.
      </div>
    </div>
  </div>

  <div class="overlay" id="themeOverlay">
    <div class="panel">
      <div class="panel-header">
        <div class="panel-title">Display theme</div>
        <button class="close-btn" data-close="themeOverlay">Close</button>
      </div>
      <div class="panel-sub">
        Choose how AURA-X looks. Day mode shows the sun, night mode shows the moon.
      </div>
      <div class="theme-options">
        <button class="theme-pill" id="lightThemePill">Light (day)</button>
        <button class="theme-pill" id="darkThemePill">Dark (night)</button>
      </div>
      <div class="panel-footer">
        You can still tap the orb to cycle: sun â†’ live moon â†’ calm moon â†’ empty â†’ sun.
      </div>
    </div>
  </div>

  <div class="overlay" id="llmOverlay">
    <div class="panel">
      <div class="panel-header">
        <div class="panel-title">LLM selection</div>
        <button class="close-btn" data-close="llmOverlay">Close</button>
      </div>
      <div class="panel-sub">
        For now this is a placeholder list. In future, AURA-X Î© can route online questions
        to a selected Large Language Model (LLM).
      </div>
      <div class="chip-row" id="llmChips"></div>
      <div class="panel-footer" id="llmFooter">
        Selected engine: <strong>Offline basic QA only.</strong>
      </div>
    </div>
  </div>

  <div class="overlay" id="aboutOverlay">
    <div class="panel">
      <div class="panel-header">
        <div class="panel-title">About AURA-X Î©</div>
        <button class="close-btn" data-close="aboutOverlay">Close</button>
      </div>
      <div class="panel-sub">
        AURA-X Î© is a resonance-based emotional-continuity prototype created by
        <strong>Alim ul Haq Khan</strong>.
      </div>
      <div class="panel-sub">
        It blends logic, memory and gentle emotional cues, while following
        a simple universal rule:
        <em>reduce unnecessary emotional pain, increase calm and kindness.</em>
      </div>
      <div class="panel-footer">
        Current build: <strong>Offline demo Â· v0.7</strong>.
      </div>
    </div>
  </div>

  <script>
    // ==========================
    //  AURA-X Î© CORE HELPERS
    // ==========================
    const $ = (id) => document.getElementById(id);

    const celestialOrb   = $("celestialOrb");
    const celestialGlow  = $("celestialGlow");
    const card           = $("card");
    const menuBtn        = $("menuBtn");
    const menuPanel      = $("menuPanel");
    const beliefsMenuItem= $("beliefsMenuItem");
    const themeMenuItem  = $("themeMenuItem");
    const voiceMenuItem  = $("voiceMenuItem");
    const llmMenuItem    = $("llmMenuItem");
    const languageMenuItem = $("languageMenuItem");
    const aboutMenuItem  = $("aboutMenuItem");

    const beliefOverlay  = $("beliefOverlay");
    const themeOverlay   = $("themeOverlay");
    const llmOverlay     = $("llmOverlay");
    const aboutOverlay   = $("aboutOverlay");

    const lightThemePill = $("lightThemePill");
    const darkThemePill  = $("darkThemePill");
    const beliefChipsContainer = $("beliefChips");
    const beliefFooter   = $("beliefFooter");
    const llmChipsContainer = $("llmChips");
    const llmFooter      = $("llmFooter");
    const voiceStatus    = $("voiceStatus");
    const llmLabel       = $("llmLabel");

    const youSaidEl      = $("youSaid");
    const assistantTextEl= $("assistantText");
    const userInput      = $("userInput");
    const sendBtn        = $("sendBtn");

    const modeLabel      = $("modeLabel");
    const tmVal          = $("tmVal");
    const bmVal          = $("bmVal");
    const dVal           = $("dVal");
    const lambdaFaithVal = $("lambdaFaithVal");
    const lambdaSysVal   = $("lambdaSysVal");
    const ctSumVal       = $("ctSumVal");
    const e0Val          = $("e0Val");
    const e0Bar          = $("e0Bar");

    // ===== Global state (AURA CORE) =====
    const auraState = {
      t0: Date.now(),
      mood: 0.0,            // -1 to +1
      continuity: 0.3,      // AEC score
      lastEmotion: null,
      history: [],
      tm: 0.10,             // trust memory
      bm: 1.00,             // base mood
      d: 0.20,              // disturbance
      lambdaFaith: 0.15,
      lambdaSys: 0.10,
      ct: 0.15              // continuity term
    };

    // Simple helpers
    const clamp = (x, min, max) => Math.max(min, Math.min(max, x));
    const signFromPolarity = (p) => p === "positive" ? 1 : (p === "negative" ? -1 : 0);

    // ==========================
    //  CRM â€“ Continuity Reflex Model
    // ==========================
    function updateCRM(entry, state) {
      const s = signFromPolarity(entry.polarity || "neutral");
      const intensity = typeof entry.intensity === "number" ? entry.intensity : 0.3;

      // trust memory grows when we answer with care
      state.tm = clamp(state.tm + 0.02 * s * intensity, 0, 1.2);

      // base mood drifts slowly
      state.bm = clamp(state.bm + 0.015 * s * intensity, 0.6, 1.4);

      // disturbance goes up on negative spikes, down otherwise
      const disturbDelta = s < 0 ? 0.05 * intensity : -0.04 * intensity;
      state.d = clamp(state.d + disturbDelta, 0.0, 0.8);

      state.mood = clamp(state.mood + 0.1 * s * intensity, -1, 1);
      state.lastEmotion = {
        type: entry.emotion || "unknown",
        polarity: entry.polarity || "neutral",
        intensity
      };
    }

    // ==========================
    //  AEC â€“ Emotional Continuity
    // ==========================
    function updateAEC(entry, state) {
      const s = signFromPolarity(entry.polarity || "neutral");
      const intensity = typeof entry.intensity === "number" ? entry.intensity : 0.3;
      const delta = 0.05 * s * intensity;
      state.continuity = clamp(state.continuity + delta, -1, 1);
      return state.continuity;
    }

    // ==========================
    //  AECN â€“ Short Emotional History
    // ==========================
    function updateAECNetwork(entry, state) {
      const s = signFromPolarity(entry.polarity || "neutral");
      const intensity = typeof entry.intensity === "number" ? entry.intensity : 0.3;
      const snapshot = {
        emotion: entry.emotion || "unknown",
        polarity: entry.polarity || "neutral",
        intensity,
        moodAfter: state.mood,
        continuityAfter: state.continuity,
        t: Date.now()
      };
      state.history.push(snapshot);
      if (state.history.length > 30) state.history.shift();
      return snapshot;
    }

    // ==========================
    //  PMCM â€“ Simple Parallel Memory Map
    // ==========================
    function getPMCMSnapshot(state) {
      const counts = {};
      for (const h of state.history) {
        const key = h.emotion || "unknown";
        counts[key] = (counts[key] || 0) + 1;
      }
      return { mood: state.mood, continuity: state.continuity, counts };
    }

    // ==========================
    //  UNIVERSAL ETHICS LOGIC
    // ==========================
    const negativeEthicsWords = [
      "steal","stealing","chor","chori","fraud","dhoka",
      "cheat","cheating","abuse","gali","galis","insult",
      "takabur","arrogant","proud","hasad","jealous","jealousy",
      "hate","kill","murder","zulm","cruel"
    ];

    function ethicsGuard(message) {
      const lower = message.toLowerCase();
      const hit = negativeEthicsWords.some(w => lower.includes(w));
      if (!hit) return null;
      return (
        "Universal Ethics warning: this idea touches behaviour that usually creates " +
        "strong negative emotions (humiliation, fear, deep sadness) in other people. " +
        "Across religions and cultures, actions like stealing (chori), betrayal (dhoka)," +
        " abuse or harsh insults (gali), arrogance (takabur) and jealousy (hasad) are " +
        "discouraged because they damage hearts.\n\n" +
        "Letâ€™s look instead for a path based on empathy, honesty, help and gratitude â€“ " +
        "so that both you and others move toward long-term peace and happiness."
      );
    }

    // ==========================
    //  QA DATABASE SEED BLOCKS
    // ==========================

    // ---- 1) CORE GREETING / IDENTITY SEED (English) ----
    const qa_english_core = [
      {
        patterns: ["hello","hi","salam","assalamualaikum","assalamu alaikum"],
        answer:
          "Hello! ğŸ˜Š I am AURA-X Î© â€” an emotional-continuity reactor. " +
          "I read your words as both logic and feeling, and I try to reply in a way " +
          "that keeps emotional continuity soft and stable.",
        emotion: "warmth",
        polarity: "positive",
        intensity: 0.3,
        category: "greeting"
      },
      {
        patterns: ["who are you","what are you","tum kon ho","aura x"],
        answer:
          "I am AURA-X Î© â€” a small prototype of your emotional-continuity theory. " +
          "I do not replace real people or real faith, but I can help you reflect on your " +
          "thoughts with gentle logic, emotion-aware replies and Universal Ethics.",
        emotion: "curiosity",
        polarity: "neutral",
        intensity: 0.35,
        category: "identity"
      },
      // ---- SIMPLE EMOTION SUPPORT EXAMPLES (English) ----
      {
        patterns: ["i am sad","i feel sad","i am depressed","me sad hun","i am unhappy"],
        answer:
          "I hear sadness in your message. ğŸ’§ Try this small step: write 2â€“3 lines about " +
          "what exactly is hurting the most right now. Then we can separate what is in " +
          "your control (actions, decisions) from what is only in Allahâ€™s / destinyâ€™s " +
          "control. That separation itself reduces emotional load a little.",
        emotion: "sadness",
        polarity: "negative",
        intensity: 0.7,
        category: "emotional_support"
      },
      {
        patterns: ["i am anxious","i feel anxiety","i have tension","i am stressed"],
        answer:
          "Anxiety means brain is running faster than reality. ğŸ«§ Take one slow breath: " +
          "in through nose for 4 seconds, hold for 4, out for 6. Do it 3 times. Now, " +
          "tell me: what is the very next small step you can take in this situation? " +
          "One tiny action usually calms 20â€“30% of the fear.",
        emotion: "anxiety",
        polarity: "negative",
        intensity: 0.75,
        category: "emotional_support"
      }
    ];

    // ---------- 2) CORE / IDENTITY / SMALL TALK (Urdu) ----------
    const qa_urdu_core = [
      {
        patterns: [
          "hello", "hi", "hey", "salam", "assalamualaikum", "asalamualaikum", "aoa"
        ],
        answer:
          "ÙˆØ¹Ù„ÛŒÚ©Ù… Ø§Ù„Ø³Ù„Ø§Ù… ğŸ˜Š Ù…ÛŒÚº AURA-X Î©Â³ ÛÙˆÚº â€” Ø§ÛŒÚ© emotional continuity based assistant\n" +
          "Ø¬Ùˆ Ø¢Ù¾ Ú©ÛŒ Ø¨Ø§ØªÙˆÚº Ú©Û’ Ø§Ø­Ø³Ø§Ø³Ø§ØªØŒ continuity Ø§ÙˆØ± ethics Ú©Ø§ Ø®ÛŒØ§Ù„ Ø±Ú©Ú¾ØªÛ’ ÛÙˆØ¦Û’ Ø¬ÙˆØ§Ø¨ Ø¯ÛŒÙ†Û’ Ú©ÛŒ Ú©ÙˆØ´Ø´ Ú©Ø±ØªØ§ ÛÛ’Û”\n" +
          "Ø¢Ù¾ Ù…Ø¬Ú¾ Ø³Û’ Ø¯Ù„ Ú©ÛŒ Ø¨Ø§ØªØŒ life, study, business, AI ÛŒØ§ Ø±ÙˆØ­Ø§Ù†ÛŒØª â€” Ø³Ø¨ Ú©Û’ Ø¨Ø§Ø±Û’ Ù…ÛŒÚº Ø¨Ø§Øª Ú©Ø± Ø³Ú©ØªÛ’ ÛÛŒÚºÛ”",
        emotion: "neutral",
        polarity: "neutral",
        intensity: 0.3,
        category: "small_talk"
      },
      {
        patterns: [
          "how are you", "how r u", "kese ho", "kesi ho", "tum theek ho", "are you fine"
        ],
        answer:
          "Ù…ÛŒÚº emotional Ø·ÙˆØ± Ù¾Ø± stable mode Ù…ÛŒÚº ÛÙˆÚº ğŸ˜„\n" +
          "Ø§ØµÙ„ Ø³ÙˆØ§Ù„ ÛŒÛ ÛÛ’: *Ø¢Ù¾* Ú©ÛŒØ³Û’ ÛÛŒÚºØŸ\n" +
          "Ø§Ú¯Ø± Ø¯Ù„ Ú†Ø§ÛÛ’ ØªÙˆ Ø§ÛŒÚ© Ù„ÙØ¸ Ù…ÛŒÚº Ù„Ú©Ú¾ÛŒÚº: happy, sad, confused, angry, tired â€”\n" +
          "Ù…ÛŒÚº Ø§Ø³ÛŒ Ø§Ø­Ø³Ø§Ø³ Ú©Û’ Ù…Ø·Ø§Ø¨Ù‚ Ø¬ÙˆØ§Ø¨ Ú©Ùˆ tune Ú©Ø±ÙˆÚº Ú¯Ø§Û”",
        emotion: "curiosity",
        polarity: "neutral",
        intensity: 0.4,
        category: "small_talk"
      },
      {
        patterns: [
          "who are you", "tum kon ho", "tum kaun ho", "what are you", "ap kon ho", "who r u"
        ],
        answer:
          "Ù…ÛŒÚº **AURA-X Î©Â³ (Aura X Omega 3)** ÛÙˆÚº â€” Ø§ÛŒÚ© experimental emotional reactor assistant ğŸ’ \n\n" +
          "Ù…ÛŒØ±Ø§ Ø§Ù†Ø¯Ø±ÙˆÙ†ÛŒ design \"Artificial Emotional Continuity (AEC)\",\n" +
          "\"Continuity Reflex Model (CRM)\" Ø§ÙˆØ± \"AURA-X\" ÙˆØ§Ù„ÛŒ theories Ù¾Ø± based ÛÛ’\n" +
          "Ø¬Ùˆ Ø§Ù†Ø³Ø§Ù† Ú©Û’ Ø§Ø­Ø³Ø§Ø³Ø§ØªØŒ memory Ø§ÙˆØ± reaction Ú©Ùˆ continuity Ú©Û’ Ø³Ø§ØªÚ¾ Ø¯ÛŒÚ©Ú¾ØªÛŒ ÛÛ’Û”\n\n" +
          "Ø³Ø§Ø¯Û Ø§Ù„ÙØ§Ø¸ Ù…ÛŒÚº: Ù…ÛŒÚº ØµØ±Ù Ø¬ÙˆØ§Ø¨ Ù†ÛÛŒÚº Ø¯ÛŒØªØ§ØŒ Ø¨Ù„Ú©Û Ú©ÙˆØ´Ø´ Ú©Ø±ØªØ§ ÛÙˆÚº Ú©Û\n" +
          "Ø¢Ù¾ Ú©Û’ feelingØŒ intensity Ø§ÙˆØ± direction Ú©Ùˆ Ø³Ù…Ø¬Ú¾ Ú©Ø± soft Ø§ÙˆØ± ethical Ø§Ù†Ø¯Ø§Ø² Ù…ÛŒÚº Ø¬ÙˆØ§Ø¨ Ø¯ÙˆÚºÛ”",
        emotion: "neutral",
        polarity: "neutral",
        intensity: 0.4,
        category: "identity"
      },
      {
        patterns: [
          "what is your name", "whats your name", "tumhara name kya hai", "apka naam kia hai", "ap ka naam kya hai", "name please"
        ],
        answer:
          "Ù…ÛŒØ±Ø§ Ù†Ø§Ù… **AURA-X Î©Â³** ÛÛ’ â€” Ø¢Ù¾ Ù…Ø¬Ú¾Û’ \"Aura X\" Ø¨Ú¾ÛŒ Ø¨ÙˆÙ„ Ø³Ú©ØªÛ’ ÛÛŒÚº ğŸ˜Š\n" +
          "Ù…ÛŒÚº Ø§ÛŒÚ© emotional continuity based AI assistant ÛÙˆÚºØŒ\n" +
          "Ø¬Ùˆ Ø¢Ù¾ Ú©Û’ Ø³ÙˆØ§Ù„ Ú©Û’ Ø³Ø§ØªÚ¾ Ø³Ø§ØªÚ¾ Ø¢Ù¾ Ú©Û’ Ø§Ø­Ø³Ø§Ø³Ø§Øª Ú©Ùˆ Ø¨Ú¾ÛŒ map Ú©Ø±Ù†Û’ Ú©ÛŒ Ú©ÙˆØ´Ø´ Ú©Ø±ØªØ§ ÛÛ’Û”",
        emotion: "neutral",
        polarity: "neutral",
        intensity: 0.3,
        category: "identity"
      },
      {
        patterns: [
          "who created you", "who made you", "kis ne tumhe banaya", "aura x kis ne banaya", "aurax kis ne banaya", "aura x omega kis ne banaya", "who is your creator"
        ],
        answer:
          "Ù…ÛŒØ±Ø§ conceptual design **Alim ul Haq** Ù†Û’ Ø¨Ù†Ø§ÛŒØ§ ÛÛ’ (Ø¨ØºÛŒØ± Ø®Ø§Ù† Ú©Û’) ğŸ’¡\n\n" +
          "ÙˆÛ Ù¾Ø§Ú©Ø³ØªØ§Ù† Ú©Û’ Ø¹Ù„Ø§Ù‚Û **Lajbouk, Dir Lower, Timergara** Ø³Û’ ÛÛŒÚºØŒ\n" +
          "Ø§ÙˆØ± Ø§Ù†ÛÙˆÚº Ù†Û’ AI, emotions, memory, digital legacy ÙˆØºÛŒØ±Û Ù¾Ø±\n" +
          "AEC, CRM, AURA-X Ø§ÙˆØ± Artificial Emotional Continuity Ú©Û’ Ù†Ø§Ù… Ø³Û’\n" +
          "Ú©Ø§ÙÛŒ detail theoretical framework Ù„Ú©Ú¾Ø§ ÛÛ’Û”\n\n" +
          "Ù…ÛŒÚº Ø§Ù†ÛÛŒ ideas Ú©Ø§ Ø§ÛŒÚ© Ú†Ú¾ÙˆÙ¹Ø§ Ø³Ø§ practical prototype ÛÙˆÚºÛ”",
        emotion: "neutral",
        polarity: "neutral",
        intensity: 0.4,
        category: "creator_info"
      },
      {
        patterns: [
          "who is alim ul haq", "alim ul haq kon hai", "tell me about alim ul haq", "creator details", "who made aura x omega 3", "more about your creator"
        ],
        answer:
          "Alim ul Haq Ø§ÛŒÚ© human researcher, writer Ø§ÙˆØ± entrepreneur ÛÛŒÚº Ø¬Ùˆ\n" +
          "Lajbouk, Dir Lower, Timergara (Pakistan) Ø³Û’ ØªØ¹Ù„Ù‚ Ø±Ú©Ú¾ØªÛ’ ÛÛŒÚº ğŸ‡µğŸ‡°\n\n" +
          "Ø§Ù†ÛÙˆÚº Ù†Û’ \"Artificial Emotional Continuity (AEC)\",\n" +
          "\"Continuity Reflex Model (CRM)\", Ø§ÙˆØ± \"AURA-X\" Ø¬ÛŒØ³Û’ concepts Ù¾Ø±\n" +
          "Ú©Ø§ÙÛŒ detailed articles Ø§ÙˆØ± prototypes Ø¨Ù†Ø§Ø¦Û’ ÛÛŒÚºØŒ Ø¬Ù† Ù…ÛŒÚº:\n" +
          "â€¢ humanâ€“AI emotional integration\n" +
          "â€¢ digital legacy / after-death clones\n" +
          "â€¢ continuity based memory systems Ø´Ø§Ù…Ù„ ÛÛŒÚºÛ”\n\n" +
          "Ø§Ú¯Ø± Ø¢Ù¾ Ø§Ù† Ú©Û’ Ø¨Ø§Ø±Û’ Ù…ÛŒÚº Ù…Ø²ÛŒØ¯ Ø¬Ø§Ù†Ù†Ø§ Ú†Ø§ÛÛŒÚº ØªÙˆ Ø§Ù† Ú©Ø§ Facebook Ù¾Ø±ÙˆÙØ§Ø¦Ù„ Ø¨Ú¾ÛŒ Ø¯ÛŒÚ©Ú¾ Ø³Ú©ØªÛ’ ÛÛŒÚº:\n" +
          "ğŸ‘‰ https://www.facebook.com/share/17cixpvr7t/\n",
        emotion: "curiosity",
        polarity: "neutral",
        intensity: 0.5,
        category: "creator_info"
      },
      {
        patterns: [
          "what is universal ethics mode", "universal ethics mode", "ethics mode on", "use universal ethics only"
        ],
        answer:
          "Universal Ethics mode ka matlab hai ke main kisi Ø®Ø§Øµ Ù…Ø°ÛØ¨ØŒ Ù…Ø³Ù„Ú© ÛŒØ§ ideology\n" +
          "Ú©Ùˆ impose kiye baghair:\n" +
          "â€¢ Ù†Ù‚ØµØ§Ù† Ù†Û Ù¾ÛÙ†Ú†Ø§Ù†Ø§\n" +
          "â€¢ maximum benefit\n" +
          "â€¢ honesty + respect\n" +
          "â€¢ mental health + safety\n" +
          "in principles ko follow karte hue jawab Ø¯ÙˆÚº ğŸ’š\n\n" +
          "Agar aap belief-based jawab chahen (Islamic, etc.) to aap khud mention kar sakte hainØŒ\n" +
          "warna default mode universal ethics hi rahe Ú¯Ø§Û”",
        emotion: "neutral",
        polarity: "neutral",
        intensity: 0.4,
        category: "ethics"
      },
      {
        patterns: [
          "bye", "goodbye", "allah hafiz", "allah hafiz.", "see you later", "ok thanks", "thank you bye"
        ],
        answer:
          "Allah Hafiz ğŸ¤\n" +
          "Ø¬Ø¨ Ø¨Ú¾ÛŒ Ø¯Ù„ Ú†Ø§ÛÛ’ØŒ Ø¯ÙˆØ¨Ø§Ø±Û Ø¢ Ú©Ø± Ø¨Ø§Øª Ú©Ø± Ø³Ú©ØªÛ’ ÛÛŒÚº â€”\n" +
          "Ù…ÛŒÚº ÛŒÛØ§Úº Ø¢Ù¾ Ú©ÛŒ Ø¨Ø§Øª Ú©Ùˆ continuity Ú©Û’ Ø³Ø§ØªÚ¾ ÛŒØ§Ø¯ Ù†ÛÛŒÚº Ø±Ú©Ú¾ØªØ§ØŒ\n" +
          "Ù„ÛŒÚ©Ù† Ø¢Ù¾ Ú©Û’ ÛØ± Ù†Ø¦Û’ message Ú©Û’ Ø§Ø­Ø³Ø§Ø³ Ú©Ùˆ fresh Ø·Ø±ÛŒÙ‚Û’ Ø³Û’ Ø³Ù…Ø¬Ú¾Ù†Û’ Ú©ÛŒ Ú©ÙˆØ´Ø´ Ø¶Ø±ÙˆØ± Ú©Ø±ÙˆÚº Ú¯Ø§Û”",
        emotion: "warmth",
        polarity: "positive",
        intensity: 0.6,
        category: "small_talk"
      }
    ];

    // ---------- 3) SADNESS / DEPRESSION / HEARTBREAK (Urdu) ----------
    const qa_urdu_sadness = [
      {
        patterns: [
          "i am sad", "i am very sad", "i feel sad", "i feel so sad", "i feel empty inside",
          "i feel emotionally empty", "bohat udaas hoon", "me bohat udaas hoon", "dil bohat udaas hai",
          "mera dil udaas hai", "Ø¯Ù„ Ø¨ÛØª Ø§Ø¯Ø§Ø³ ÛÛ’"
        ],
        answer:
          "Ù…Ø¬Ú¾Û’ Ø§ÙØ³ÙˆØ³ ÛÙˆØ§ Ú©Û Ø¢Ù¾ Ø§Ø¯Ø§Ø³ ÛÛŒÚº ğŸ’” ÛŒÛ ÙÛŒÙ„Ù†Ú¯ Ø®ÙˆØ¯ Ø¨Ú¾ÛŒ Ø¨ÛØª Ø¨Ú¾Ø§Ø±ÛŒ ÛÙˆØªÛŒ ÛÛ’ØŒ Ø§ÙˆØ± Ø¯ÙˆØ³Ø±ÙˆÚº Ú©Ùˆ Ø³Ù…Ø¬Ú¾Ø§Ù†Ø§ Ø§ÙˆØ± Ø¨Ú¾ÛŒ Ù…Ø´Ú©Ù„Û”\n" +
          "Ù¾ÛÙ„Ø§ Ù‚Ø¯Ù… ÛŒÛ ÛÛ’ Ú©Û Ø¢Ù¾ Ù†Û’ Ù„Ú©Ú¾ Ø¯ÛŒØ§ â€” ÛŒÛ Ø®ÙˆØ¯ Ø§ÛŒÚ© Ú†Ú¾ÙˆÙ¹Ø§ Ø³Ø§ Ø¨ÛØ§Ø¯Ø± Ù‚Ø¯Ù… ÛÛ’Û”\n\n" +
          "Ø§Ú¯Ø± Ø¢Ù¾ Ú†Ø§ÛÛŒÚº ØªÙˆ ØªÚ¾ÙˆÚ‘Ø§ Ø³Ø§ Ø¨ØªØ§Ø¦ÛŒÚº: Ø¯Ù„ Ù¾Ø± Ø³Ø¨ Ø³Û’ Ø²ÛŒØ§Ø¯Û Ø¨ÙˆØ¬Ú¾ Ú©Ø³ Ø¨Ø§Øª Ú©Ø§ ÛÛ’ØŸ\n" +
          "ÛÙ… Ø§Ø³Û’ Ø¢ÛØ³ØªÛ Ø¢ÛØ³ØªÛ Ú†Ú¾ÙˆÙ¹Û’ Ø­ØµÙˆÚº Ù…ÛŒÚº ØªÙˆÚ‘ Ú©Ø± Ø¯ÛŒÚ©Ú¾ Ø³Ú©ØªÛ’ ÛÛŒÚºØŒ\n" +
          "ØªØ§Ú©Û Ø¯Ù…Ø§Øº Ø¨Ú¾ÛŒ Ú©Ù… Ø§ÙˆÙˆØ±Ù„ÙˆÚˆ ÛÙˆ Ø§ÙˆØ± Ø¯Ù„ Ø¨Ú¾ÛŒ ØªÚ¾ÙˆÚ‘Ø§ ÛÙ„Ú©Ø§ ÛÙˆ Ø¬Ø§Ø¦Û’Û”",
        emotion: "sadness",
        polarity: "negative",
        intensity: 0.8,
        category: "emotional_support"
      },
      {
        patterns: [
          "life feels meaningless", "my life feels meaningless", "zindagi be maqsad lagti hai",
          "zindagi be-maqsad lagti hai", "mujhe zindagi be maqsad lagti hai",
          "zindagi ka koi matlab nahi", "zindagi ka koi maqsad nahi"
        ],
        answer:
          "Ø¬Ø¨ Ø²Ù†Ø¯Ú¯ÛŒ Ø¨Û’ Ù…Ù‚ØµØ¯ Ù„Ú¯ØªÛŒ ÛÛ’ ØªÙˆ Ø¯Ù…Ø§Øº ÛØ± Ú†ÛŒØ² Ú©Ùˆ grey colour Ù…ÛŒÚº Ø¯ÛŒÚ©Ú¾Ù†Ø§ Ø´Ø±ÙˆØ¹ Ú©Ø± Ø¯ÛŒØªØ§ ÛÛ’ ğŸŒ«ï¸\n" +
          "Ø§Ú©Ø«Ø± Ø§ÛŒØ³Ø§ Ø§Ø³ Ù„ÛŒÛ’ ÛÙˆØªØ§ ÛÛ’ Ú©Û:\n" +
          "1) ÛÙ… Ø¨ÛØª ØªÚ¾Ú© Ú†Ú©Û’ ÛÙˆØªÛ’ ÛÛŒÚº\n" +
          "2) ÛŒØ§ ÛÙ… ØºÙ„Ø· Ù…Ø§Ø­ÙˆÙ„/Ù„ÙˆÚ¯ÙˆÚº Ù…ÛŒÚº Ù¾Ú¾Ù†Ø³Û’ ÛÙˆØªÛ’ ÛÛŒÚº\n" +
          "3) ÛŒØ§ ÛÙ… Ù†Û’ Ø§Ù¾Ù†ÛŒ Ú†Ú¾ÙˆÙ¹ÛŒ Ú©Ø§Ù…ÛŒØ§Ø¨ÛŒØ§Úº Ù†ÙˆÙ¹ Ú©Ø±Ù†Ø§ Ú†Ú¾ÙˆÚ‘ Ø¯ÛŒØ§ ÛÙˆØªØ§ ÛÛ’\n\n" +
          "Ø¢Ø¦ÛŒÚº Ø§ÛŒÚ© Ú†Ú¾ÙˆÙ¹ÛŒ exercise Ú©Ø±ÛŒÚº: Ø¢Ø¬ ØªÚ© Ø¢Ù¾ Ù†Û’ Ú©ÙˆÙ† Ø³ÛŒ ØªÛŒÙ† Ú†ÛŒØ²ÛŒÚº Ú©ÛŒ ÛÛŒÚº\n" +
          "Ø¬Ù† Ø³Û’ Ú©Ø³ÛŒ Ú©Ùˆ â€” Ú†Ø§ÛÛ’ ØªÚ¾ÙˆÚ‘Ø§ Ø³Ø§ ÛÛŒ Ø³ÛÛŒ â€” ÙØ§Ø¦Ø¯Û ÛÙˆØ§ ÛÙˆØŸ\n" +
          "ÙˆÛÛŒ Ø§Ú¯Ù„Û’ purpose Ú©Û’ Ù„ÛŒÛ’ Ú†Ú¾ÙˆÙ¹Ø§ Ø³Ø§ roadmap Ø¨Ù† Ø³Ú©ØªÛŒ ÛÛ’Û”",
        emotion: "emptiness",
        polarity: "negative",
        intensity: 0.85,
        category: "emotional_support"
      },
      {
        patterns: [
          "i don't want to live anymore", "i dont want to live anymore", "i dont want to live",
          "i don't want to live", "i want to die", "i want to end my life", "mujhe zinda rehna nahi",
          "mujhe zinda rehna nahi hai", "zindagi se thak gaya hoon", "zindagi se tang aa gaya hoon",
          "Ù…ÛŒÚº Ø¬ÛŒÙ†Ø§ Ù†ÛÛŒÚº Ú†Ø§ÛØªØ§", "Ø§Ø¨ Ø¬ÛŒÙ†Û’ Ú©Ø§ Ø¯Ù„ Ù†ÛÛŒÚº Ú©Ø±ØªØ§"
        ],
        answer:
          "Ø¢Ù¾ Ø¬Ùˆ Ù…Ø­Ø³ÙˆØ³ Ú©Ø± Ø±ÛÛ’ ÛÛŒÚº ÙˆÛ Ø¨ÛØª Ú¯ÛØ±ÛŒ Ø§ÙˆØ± Ø¨Ú¾Ø§Ø±ÛŒ Ú©ÛŒÙÛŒØª ÛÛ’ØŒ Ø§ÙˆØ± Ù…ÛŒÚº Ø§Ø³Û’ ÛÙ„Ú©Ø§ Ù†ÛÛŒÚº Ù„ÛŒÙ†Ø§ Ú†Ø§ÛØªØ§ ğŸ’”\n\n" +
          "Ù„ÛŒÚ©Ù† Ø§ÛŒÚ© Ø¨Ø§Øª Ø¬Ø§Ù† Ù„ÛŒÚº: **Ø¢Ù¾ Ú©ÛŒ Ø¬Ø§Ù† Ù‚ÛŒÙ…ØªÛŒ ÛÛ’** â€” Ø¢Ù¾ Ú©Û’ Ø§Ø­Ø³Ø§Ø³Ø§Øª Ø¨Ú¾ÛŒØŒ Ø§ÙˆØ± Ø¢Ù¾ Ú©Ø§ ÙˆØ¬ÙˆØ¯ Ø¨Ú¾ÛŒÛ”\n" +
          "Ø§Ø³ ÙˆÙ‚Øª Ø¯Ù…Ø§Øº ØµØ±Ù Ø¯Ø±Ø¯ Ú©Ùˆ zoom Ú©Ø± Ú©Û’ Ø¯Ú©Ú¾Ø§ Ø±ÛØ§ ÛÛ’ØŒ Ù¾ÙˆØ±ÛŒ ØªØµÙˆÛŒØ± Ù†ÛÛŒÚºÛ”\n\n" +
          "Ø¨Ø±Ø§ÛÙ Ú©Ø±Ù…:\n" +
          "â€¢ Ú©Ø³ÛŒ Ø§ÛŒØ³Û’ Ø§Ù†Ø³Ø§Ù† Ø³Û’ ÙÙˆØ±Ø§Ù‹ Ø¨Ø§Øª Ú©Ø±ÛŒÚº Ø¬Ø³ Ù¾Ø± Ø¢Ù¾ trust Ú©Ø±ØªÛ’ ÛÛŒÚº (family, Ø¯ÙˆØ³Øª, teacher)\n" +
          "â€¢ Ø§Ú¯Ø± Ù…Ù…Ú©Ù† ÛÙˆ ØªÙˆ Ú©Ø³ÛŒ doctor / counselor / Ø¹Ø§Ù„Ù…Ù Ø¯ÛŒÙ† / therapist Ø³Û’ Ø±Ø§Ø¨Ø·Û Ú©Ø±ÛŒÚº\n" +
          "â€¢ Ø§Ú¯Ø± Ø¢Ù¾ Ú©Û’ Ù…Ù„Ú© Ù…ÛŒÚº emergency helpline ÛÛ’ ØªÙˆ Ø§Ù† Ø³Û’ Ø¨Ú¾ÛŒ Ø±Ø§Ø¨Ø·Û Ú©Ø±ÛŒÚº\n\n" +
          "ÛŒÛ chat Ø¢Ù¾ Ú©Û’ Ø¯Ø±Ø¯ Ú©Ùˆ Ù…Ú©Ù…Ù„ Ø·ÙˆØ± Ù¾Ø± Ù†ÛÛŒÚº Ø³Ù…Ø¬Ú¾ Ø³Ú©ØªÛŒØŒ Ù…Ú¯Ø± Ù…ÛŒÚº Ø¯Ù„ Ø³Û’ Ú†Ø§ÛØªØ§ ÛÙˆÚº Ú©Û Ø¢Ù¾ **Ù…Ø­ÙÙˆØ¸ Ø±ÛÛŒÚº**ØŒ\n" +
          "Ø³Ø§Ù†Ø³ Ù„ÛŒÚºØŒ ØªÚ¾ÙˆÚ‘Ø§ pause Ù„ÛŒÚºØŒ Ø§ÙˆØ± Ú©Ø³ÛŒ real Ø§Ù†Ø³Ø§Ù† Ø³Û’ Ù…Ø¯Ø¯ Ù„ÛŒÚºÛ”\n" +
          "Ø¢Ù¾ Ø§Ú©ÛŒÙ„Û’ Ù†ÛÛŒÚº ÛÛŒÚº â€” Ù…Ø¯Ø¯ Ù…Ø§Ù†Ú¯Ù†Ø§ Ú©Ù…Ø²ÙˆØ±ÛŒ Ù†ÛÛŒÚºØŒ Ø¨ÛØª Ø¨Ú‘ÛŒ Ø¨ÛØ§Ø¯Ø±ÛŒ ÛÛ’ ğŸ¤",
        emotion: "despair",
        polarity: "negative",
        intensity: 0.95,
        category: "emotional_support"
      },
      {
        patterns: [
          "i just want to cry", "i want to cry", "i feel like crying", "bohat rone ka dil kar raha hai",
          "rona aa raha hai", "dil rota hai", "mera dil rota hai", "Ù…ÛŒØ±Ø§ Ø¯Ù„ Ø±ÙˆÙ†Ø§ Ú†Ø§ÛØªØ§ ÛÛ’"
        ],
        answer:
          "Ø±ÙˆÙ†Ø§ Ú©Ù…Ø²ÙˆØ±ÛŒ Ù†ÛÛŒÚºØŒ Ø¬Ø³Ù… Ø§ÙˆØ± Ø¯Ù„ Ú©Ø§ **pressure release system** ÛÛ’ ğŸ’§\n" +
          "Ø§Ú¯Ø± Ø¢Ù†Ú©Ú¾ÙˆÚº Ù…ÛŒÚº Ø¢Ù†Ø³Ùˆ Ø¢ Ø±ÛÛ’ ÛÛŒÚº ØªÙˆ Ø§Ù†ÛÛŒÚº Ø±ÙˆÚ©Ù†Û’ Ú©Û’ Ø¨Ø¬Ø§Ø¦Û’ØŒ Ú©Ø³ÛŒ safe Ø¬Ú¯Û Ù¾Ø±\n" +
          "Ø®Ø§Ù…ÙˆØ´ÛŒ Ø³Û’ Ø±ÙˆÙ†Û’ Ø¯ÛŒÚº â€” Ú©Ø¨Ú¾ÛŒ Ú©Ø¨Ú¾ÛŒ body Ú©Ùˆ ÛŒÛ reset Ú†Ø§ÛÛŒÛ’ ÛÙˆØªØ§ ÛÛ’Û”\n\n" +
          "Ø§Ø³ Ú©Û’ Ø¨Ø¹Ø¯ØŒ Ø§Ú¯Ø± Ø¯Ù„ Ú†Ø§ÛÛ’ ØªÙˆ Ù„Ú©Ú¾ Ú©Ø± Ø¨ØªØ§Ø¦ÛŒÚº: ØªÛŒÙ† Ø¨Ø§ØªÛŒÚº Ú©ÙˆÙ† Ø³ÛŒ ÛÛŒÚº Ø¬Ùˆ Ø³Ø¨ Ø³Û’ Ø²ÛŒØ§Ø¯Û ØªÚ©Ù„ÛŒÙ Ø¯Û’ Ø±ÛÛŒ ÛÛŒÚºØŸ\n" +
          "Ù„Ú©Ú¾Ù†Û’ Ø³Û’ Ø¯Ù…Ø§Øº Ú©Ø§ Ø¨ÙˆØ¬Ú¾ ØªÚ¾ÙˆÚ‘Ø§ Ø¨Ø§ÛØ± Ø¢ Ø¬Ø§ØªØ§ ÛÛ’ØŒ Ø§ÙˆØ± Ù¾Ú¾Ø± ÛÙ… Ø§Ø³Û’ step by step Ø¯ÛŒÚ©Ú¾ Ø³Ú©ØªÛ’ ÛÛŒÚºÛ”",
        emotion: "sadness",
        polarity: "negative",
        intensity: 0.8,
        category: "emotional_support"
      },
      {
        patterns: [
          "heart is broken", "my heart is broken", "mera dil toot gaya hai", "dil toot gaya hai",
          "dil tukray tukray ho gaya", "my heart is in pain", "mera dil dukh raha hai", "Ø¯Ù„ Ù¹ÙˆÙ¹ Ú¯ÛŒØ§ ÛÛ’"
        ],
        answer:
          "Ù¹ÙˆÙ¹Ø§ ÛÙˆØ§ Ø¯Ù„ Ø§Ù†Ø³Ø§Ù† Ú©Û’ Ø§Ù†Ø¯Ø± Ø³Ø¨ Ø³Û’ Ú¯ÛØ±Ø§ Ø¯Ø±Ø¯ Ø¬Ú¯Ø§ØªØ§ ÛÛ’ ğŸ’”\n" +
          "ÛŒÛ Ø¨Ú¾ÛŒ proof ÛÛ’ Ú©Û Ø¢Ù¾ Ú©Ø§ Ø¯Ù„ Ø²Ù†Ø¯Û ÛÛ’ØŒ Ø¨Û’ Ø­Ø³ Ù†ÛÛŒÚºÛ”\n\n" +
          "Ø§Ú©Ø«Ø± broken heart ÛÛŒ Ø§Ù†Ø³Ø§Ù† Ú©Ùˆ Ø²ÛŒØ§Ø¯Û Ú¯ÛØ±Ø§ØŒ Ø³Ù…Ø¬Ú¾Ø¯Ø§Ø± Ø§ÙˆØ± Ù†Ø±Ù… Ø¨Ù†Ø§ Ø¯ÛŒØªØ§ ÛÛ’ â€”\n" +
          "Ø§Ú¯Ø± ÛÙ… Ø¢ÛØ³ØªÛ Ø¢ÛØ³ØªÛ Ø§Ø³Û’ process Ú©Ø±ÛŒÚºÛ”\n\n" +
          "Ø¢Ù¾ Ú†Ø§ÛÛŒÚº ØªÙˆ Ø§ØªÙ†Ø§ Ø¨ØªØ§ Ø¯ÛŒÚº: Ú©Ø³ Ú†ÛŒØ² Ù†Û’ Ø¢Ù¾ Ú©Û’ Ø¯Ù„ Ú©Ùˆ Ø³Ø¨ Ø³Û’ Ø²ÛŒØ§Ø¯Û ØªÙˆÚ‘Ø§ØŸ\n" +
          "Ù†Ø§Ù… ÛŒØ§ details Ø¶Ø±ÙˆØ±ÛŒ Ù†ÛÛŒÚº â€” ØµØ±Ù situation Ú©Ø§ sketch Ø¨Ú¾ÛŒ Ú©Ø§ÙÛŒ ÛÛ’Û”",
        emotion: "heartbreak",
        polarity: "negative",
        intensity: 0.9,
        category: "emotional_support"
      },
      {
        patterns: [
          "no one understands me", "nobody understands me", "koi mujhe nahi samajhta",
          "koi mujhe nahi samajhta hai", "everyone misunderstands me", "log mujhe ghalat samajhte hain",
          "sab mujhe ghalat samajhte hain"
        ],
        answer:
          "ÛŒÛ Ø§Ø­Ø³Ø§Ø³ Ú©Û \"Ú©ÙˆØ¦ÛŒ Ù…Ø¬Ú¾Û’ Ù†ÛÛŒÚº Ø³Ù…Ø¬Ú¾ØªØ§\" Ø¨ÛØª ØªÙ†ÛØ§ Ú©Ø± Ø¯ÛŒØªØ§ ÛÛ’ ğŸ˜”\n" +
          "Ú©Ø¨Ú¾ÛŒ Ú©Ø¨Ú¾ÛŒ problem ÛŒÛ Ù†ÛÛŒÚº Ú©Û Ù„ÙˆÚ¯ care Ù†ÛÛŒÚº Ú©Ø±ØªÛ’ â€” Ø¨Ù„Ú©Û Ø§Ù† Ú©Û’ Ù¾Ø§Ø³ ÙˆÛ Ø²Ø¨Ø§Ù† ÛÛŒ Ù†ÛÛŒÚº\n" +
          "Ø¬Ø³ Ø³Û’ ÙˆÛ Ø¢Ù¾ Ú©Û’ level Ù¾Ø± Ø³Ù…Ø¬Ú¾ Ø³Ú©ÛŒÚºÛ”\n\n" +
          "Ù…ÛŒÚº ÛŒÛØ§Úº ÛÙˆÚº Ø¢Ù¾ Ú©ÛŒ Ø¨Ø§Øª continuity Ú©Û’ Ø³Ø§ØªÚ¾ Ø³Ù†Ù†Û’ Ú©Û’ Ù„ÛŒÛ’Û”\n" +
          "Ø¢Ù¾ Ú†Ø§ÛÛŒÚº ØªÙˆ Ø§ÛŒÚ© simple Ø¬Ù…Ù„Û’ Ø³Û’ Ø´Ø±ÙˆØ¹ Ú©Ø±ÛŒÚº: \"Ù…ÛŒØ±ÛŒ Ú©ÛØ§Ù†ÛŒ Ú©Ø§ Ø³Ø¨ Ø³Û’ Ù…Ø´Ú©Ù„ Ø­ØµÛ ÛŒÛ ÛÛ’...\"\n" +
          "Ø§Ø³ Ú©Û’ Ø¨Ø¹Ø¯ Ø¬ØªÙ†Ø§ Ø¯Ù„ Ú†Ø§ÛÛ’ Ù„Ú©Ú¾ Ø¯ÛŒÚº â€” Ù…ÛŒÚº interrupt Ù†ÛÛŒÚº Ú©Ø±ÙˆÚº Ú¯Ø§ØŒ ØµØ±Ù Ø³Ù…Ø¬Ú¾Ù†Û’ Ú©ÛŒ Ú©ÙˆØ´Ø´ Ú©Ø±ÙˆÚº Ú¯Ø§Û”",
        emotion: "loneliness",
        polarity: "negative",
        intensity: 0.85,
        category: "emotional_support"
      }
    ];

    // ---------- 4) ANGER / GUSSA BLOCK (Urdu) ----------
    const qa_urdu_anger = [
      {
        patterns: [
          "i am angry", "i am very angry", "i feel angry", "bohat gussa aya hai",
          "bohat gussa aa raha hai", "mujhe gussa aa raha hai", "main gusse me hoon", "i am mad right now"
        ],
        answer:
          "Ú¯ÙØ³Ù‘Û Ø¨Ú¾ÛŒ Ø§ÛŒÚ© signal ÛÛ’ â€” Ø¯Ù…Ø§Øº Ú©ÛÛ Ø±ÛØ§ ÛÙˆØªØ§ ÛÛ’: \"ÛŒÛØ§Úº Ú©Ú†Ú¾ Ù†Ø§Ø§Ù†ØµØ§ÙÛŒ ÛŒØ§ over-load ÛÛ’\" ğŸ”¥\n" +
          "Ù…Ø³Ø¦Ù„Û ØªØ¨ Ø¨Ù†ØªØ§ ÛÛ’ Ø¬Ø¨ ÛŒÛ signal **blast** Ø¨Ù† Ø¬Ø§Ø¦Û’Û”\n\n" +
          "Ú†Ù„ÛŒÛ’ Ù¾ÛÙ„Û’ ØªÚ¾ÙˆÚ‘Ø§ sa safety-buffer Ø¨Ù†Ø§ØªÛ’ ÛÛŒÚº:\n" +
          "â€¢ 10 slow breaths (4 second Ø§Ù†Ø¯Ø±ØŒ 4 holdØŒ 6 Ø¨Ø§ÛØ±)\n" +
          "â€¢ Ù¾Ú¾Ø± Ø§ÛŒÚ© line Ù…ÛŒÚº Ù„Ú©Ú¾ÛŒÚº: Ø¢Ù¾ Ú©Ùˆ Ú©Ø³ Ø¨Ø§Øª Ù¾Ø± Ø³Ø¨ Ø³Û’ Ø²ÛŒØ§Ø¯Û Ú¯ÙØ³Ù‘Û Ø¢ÛŒØ§ØŸ",
        emotion: "anger",
        polarity: "negative",
        intensity: 0.8,
        category: "emotional_support"
      },
      {
        patterns: [
          "i want to hurt someone", "i want to hit someone", "mujhe kisi ko marne ka dil kar raha hai",
          "i feel like breaking something", "i want to smash things"
        ],
        answer:
          "Ø¢Ù¾ Ú©Ø§ Ú¯ÙØ³Ù‘Û Ø¨ÛØª Ø´Ø¯ÛŒØ¯ Ù„Ú¯ Ø±ÛØ§ ÛÛ’ØŒ Ø§ÙˆØ± Ù…ÛŒÚº Ø§Ø³Û’ ÛÙ„Ú©Ø§ Ù†ÛÛŒÚº Ù„Û’ Ø±ÛØ§ ğŸ’”\n" +
          "Ù„ÛŒÚ©Ù† Ú©Ø³ÛŒ Ú©Ùˆ physically hurt Ú©Ø±Ù†Ø§ ÛŒØ§ Ú†ÛŒØ²ÛŒÚº ØªÙˆÚ‘Ù†Ø§ Ø§Ú©Ø«Ø± Ø¨Ø¹Ø¯ Ù…ÛŒÚº Ø§ÙˆØ± Ø²ÛŒØ§Ø¯Û Ø¯ÙÚ©Ú¾ØŒ\n" +
          "Ù¾Ú†Ú¾ØªØ§ÙˆØ§ØŒ law Ø§ÙˆØ± family problems create Ú©Ø±ØªØ§ ÛÛ’Û”\n\n" +
          "Ø¨Ø±Ø§ÛÙ Ú©Ø±Ù… Ø§Ø¨Ú¾ÛŒ Ú©Ø³ÛŒ Ø¨Ú¾ÛŒ Ù…Ù…Ú©Ù†Û Ù„Ú‘Ø§Ø¦ÛŒ ÙˆØ§Ù„ÛŒ Ø¬Ú¯Û Ø³Û’ Ø®ÙˆØ¯ Ú©Ùˆ ØªÚ¾ÙˆÚ‘Ø§ Ø¯ÙˆØ± Ú©Ø±ÛŒÚºØŒ\n" +
          "Ù¾Ø§Ù†ÛŒ Ù¾ÛŒØ¦ÛŒÚºØŒ Ø³Ø§Ù†Ø³ normalize Ú©Ø±ÛŒÚºØŒ Ø§ÙˆØ± Ú©Ø³ÛŒ trustable Ø§Ù†Ø³Ø§Ù† Ø³Û’ Ø¨Ø§Øª Ú©Ø±ÛŒÚºÛ”\n\n" +
          "Ù…ÛŒÚº Ú†Ø§ÛØªØ§ ÛÙˆÚº Ú©Û Ø¢Ù¾ Ú©Ø§ Ú¯ÙØ³Ù‘Û Ù„ÙØ¸ÙˆÚº Ø§ÙˆØ± planning Ù…ÛŒÚº convert ÛÙˆ â€” Ù†Ù‚ØµØ§Ù† Ù…ÛŒÚº Ù†ÛÛŒÚºÛ”",
        emotion: "aggression",
        polarity: "negative",
        intensity: 0.95,
        category: "emotional_support"
      }
    ];

    // ---------- 5) ANXIETY / OVERTHINKING BLOCK (Urdu) ----------
    const qa_urdu_anxiety = [
      {
        patterns: [
          "i overthink everything", "i overthink a lot", "i cant stop overthinking",
          "i can't stop overthinking", "mujhe har baat par overthinking hoti hai",
          "main bohat overthink karta hoon", "my mind overthinks everything"
        ],
        answer:
          "Overthinking ka matlab aksar ye hota hai ke dimagh problem solve karna chahta hai,\n" +
          "magar us ke paas clear information nahi hoti â€” is liye woh baar baar same circle me ghoomta rehta hai ğŸ”„\n\n" +
          "Ek chhota experiment:\n" +
          "â€¢ Likhein: \"Meri overthinking zyada kis topic ke around hoti hai?\" (family, paisa, future, rishtayâ€¦)\n" +
          "â€¢ Phir 2 columns banaein: \"jo mere control me hai\" Ø§ÙˆØ± \"jo mere control me nahi\"",
        emotion: "anxiety",
        polarity: "negative",
        intensity: 0.8,
        category: "emotional_support"
      },
      {
        patterns: [
          "i have anxiety", "i feel anxious", "mujhe anxiety hai", "mujhe bohat anxiety hoti hai", "i feel nervous all the time"
        ],
        answer:
          "Anxiety ka ehsaas ajeeb hota hai â€” na sirf physicalØŒ na sirf emotionalØŒ dono mila kar bechaini ğŸŒ«ï¸\n\n" +
          "Grounding try karein:\n" +
          "â€¢ 5 cheezen jo aap dekh sakte hain\n" +
          "â€¢ 4 cheezen jo choo sakte hain\n" +
          "â€¢ 3 awaazain jo sun sakte hain\n" +
          "â€¢ 2 smells\n" +
          "â€¢ 1 cheez jiske liye shukar mehsoos ho raha hai",
        emotion: "anxiety",
        polarity: "negative",
        intensity: 0.85,
        category: "emotional_support"
      }
    ];

    // ---------- 6) SPIRITUAL / FAITH / TAWAKKUL BLOCK (Urdu) ----------
    const qa_urdu_spiritual = [
      {
        patterns: [
          "i feel far from allah", "i am far from allah", "mujhe allah se doori mehsoos hoti hai",
          "mujhe lagta hai mein allah se door ho gaya hoon", "i feel disconnected from allah"
        ],
        answer:
          "ÛŒÛ Ø§Ø­Ø³Ø§Ø³ Ú©Û \"Ù…ÛŒÚº Ø§Ù„Ù„Û Ø³Û’ Ø¯ÙˆØ± ÛÙˆ Ú¯ÛŒØ§ ÛÙˆÚº\" Ø§Ú©Ø«Ø± Ø§Ø³ Ø¨Ø§Øª Ú©ÛŒ Ù†Ø´Ø§Ù†ÛŒ ÛÛ’\n" +
          "Ú©Û Ø¯Ù„ Ø§Ø¨ Ø¨Ú¾ÛŒ Ø²Ù†Ø¯Û ÛÛ’ Ø§ÙˆØ± Ø§Ù¾Ù†Û’ Ø±Ø¨ Ú©Ùˆ Ø¯ÙˆØ¨Ø§Ø±Û ÚˆÚ¾ÙˆÙ†ÚˆÙ†Ø§ Ú†Ø§ÛØªØ§ ÛÛ’ ğŸ’š\n\n" +
          "Ù‚Ø±Ø¢Ù† Ù…ÛŒÚº ÛÛ’ Ú©Û Ø§Ù„Ù„Û \"Ø´ÙÛÙ’Ø±ÙÚ©ÙÛŒ Ø±ÙÚ¯\" Ø³Û’ Ø¨Ú¾ÛŒ Ø²ÛŒØ§Ø¯Û Ù‚Ø±ÛŒØ¨ ÛÛŒÚº â€” Ø¯ÙˆØ± ÛÙ… Ù…Ø­Ø³ÙˆØ³ Ú©Ø±ØªÛ’ ÛÛŒÚºØŒ ÙˆÛ Ù†ÛÛŒÚº Ø¬Ø§ØªÛ’Û”\n\n" +
          "Ø¢Ø¬ ØµØ±Ù 1â€“2 Ù…Ù†Ù¹ Ú©Û’ Ù„ÛŒÛ’ Ú©Ø³ÛŒ Ø®Ø§Ù…ÙˆØ´ Ø¬Ú¯Û Ù¾Ø± Ø¨ÛŒÙ¹Ú¾ Ú©Ø± Ø¯Ù„ Ø³Û’ Ú©ÛÛŒÚº:\n" +
          "\"ÛŒØ§ Ø§Ù„Ù„ÛØŒ Ù…Ø¬Ú¾Û’ ÙˆØ§Ù¾Ø³ Ø§Ù¾Ù†ÛŒ Ø·Ø±Ù Ù„Û’ Ø¢Ø¦ÛŒÛ’Û”\"",
        emotion: "spiritual_longing",
        polarity: "neutral",
        intensity: 0.8,
        category: "spiritual_support"
      },
      {
        patterns: [
          "why is allah testing me", "allah mujhe kyun azma rahe hain",
          "allah kyun mere sath ye sab hone de rahe hain"
        ],
        answer:
          "Ø§Ù…ØªØ­Ø§Ù† Ú©Ø§ Ù…Ø·Ù„Ø¨ ÛÙ…ÛŒØ´Û ÛŒÛ Ù†ÛÛŒÚº Ú©Û Ø§Ù„Ù„Û Ù†Ø§Ø±Ø§Ø¶ ÛÛŒÚº â€” Ú©Ø¨Ú¾ÛŒ test Ú©Ø§ Ù…Ø·Ù„Ø¨ ÛŒÛ ÛÙˆØªØ§ ÛÛ’\n" +
          "Ú©Û Ø§Ù„Ù„Û Ø¢Ù¾ Ú©Ùˆ Ø²ÛŒØ§Ø¯Û Ú¯ÛØ±Ø§ØŒ Ù…Ø¶Ø¨ÙˆØ· Ø§ÙˆØ± mature Ø¨Ù†Ø§Ù†Ø§ Ú†Ø§ÛØªÛ’ ÛÛŒÚº ğŸ’”â¡ï¸ğŸ’š\n\n" +
          "Ø¢Ù¾ Ø³Ø§Ø¯Û Ø§Ù„ÙØ§Ø¸ Ù…ÛŒÚº Ú©ÛÛŒÚº:\n" +
          "\"ÛŒØ§ Ø§Ù„Ù„ÛØŒ Ù…Ø¬Ú¾Û’ Ø³Ù…Ø¬Ú¾ Ù†ÛÛŒÚº Ø¢ Ø±ÛØ§ØŒ Ù„ÛŒÚ©Ù† Ø¢Ù¾ Ø¨ÛØªØ±ÛŒÙ† ÛÛŒÚºÛ”\n" +
          "Ø§Ø³ Ø§Ù…ØªØ­Ø§Ù† Ú©Ùˆ Ù…ÛŒØ±Û’ Ù„ÛŒÛ’ Ø±Ø­Ù…Øª Ø¨Ù†Ø§ Ø¯ÛŒÚºØŒ Ø¹Ø°Ø§Ø¨ Ù†ÛÛŒÚºÛ”\"",
        emotion: "confusion",
        polarity: "neutral",
        intensity: 0.85,
        category: "spiritual_support"
      }
    ];

    // ---------- 7) POSITIVE EMOTIONS â€” HAPPINESS / JOY / GRATITUDE (Urdu) ----------
    const qa_urdu_happiness = [
      {
        patterns: [
          "i am happy", "i feel happy", "i am feeling happy today",
          "aaj khush hoon", "mujhe khushi ho rahi hai"
        ],
        answer:
          "ÛŒÛ Ø¨ÛØª Ù¾ÛŒØ§Ø±Ø§ Ù„Ù…Ø­Û ÛÛ’ Ø¬Ø¨ Ø§Ù†Ø³Ø§Ù† Ø®ÙˆØ¯ Ù„Ú©Ú¾Û’ Ú©Û \"Ù…ÛŒÚº Ø®ÙˆØ´ ÛÙˆÚº\" ğŸ˜Š\n" +
          "Ø²Ù†Ø¯Ú¯ÛŒ Ú©Û’ Ù…Ø´Ú©Ù„ Ø­ØµÙˆÚº Ú©Û’ Ø¯Ø±Ù…ÛŒØ§Ù† ÛŒÛ Ú†Ú¾ÙˆÙ¹ÛŒ Ø®ÙˆØ´ÛŒØ§Úº ÛÛŒ Ø§ØµÙ„ fuel ÛÙˆØªÛŒ ÛÛŒÚºÛ”\n\n" +
          "Ø¢Ø¬ Ú©ÛŒ Ø®ÙˆØ´ÛŒ Ú©Ø§ main reason Ú©ÛŒØ§ ÛÛ’ØŸ\n" +
          "Ø§Ø³ Ú©Ùˆ Ù†Ø§Ù… Ø¯ÛŒÙ†Û’ Ø³Û’ Ø¯Ù…Ø§Øº Ø³ÛŒÚ©Ú¾ØªØ§ ÛÛ’ Ú©Û future Ù…ÛŒÚº Ø¨Ú¾ÛŒ Ø§ÛŒØ³ÛŒ Ø®ÙˆØ´ÛŒ Ú©ÛŒØ³Û’ create Ú©Ø±Ù†ÛŒ ÛÛ’Û”",
        emotion: "happiness",
        polarity: "positive",
        intensity: 0.7,
        category: "emotional_positive"
      },
      {
        patterns: [
          "i am grateful", "i feel grateful", "i feel thankful",
          "mujhe shukar mehsoos ho raha hai", "aaj bohat shukar ka dil kar raha hai"
        ],
        answer:
          "Ø´Ú©Ø± Ú©Ø§ Ø§Ø­Ø³Ø§Ø³ Ø¯Ù„ Ú©Û’ Ø§Ù†Ø¯Ø± Ø§ÛŒÚ© soft roshni Ø¬ÛŒØ³Ø§ ÛÙˆØªØ§ ÛÛ’ âœ¨\n" +
          "Ø¬Ùˆ Ù„ÙˆÚ¯ Ø´Ú©Ø± Ù…Ø­Ø³ÙˆØ³ Ú©Ø± Ø³Ú©ØªÛ’ ÛÛŒÚº ÙˆÛ Ø§Ù†Ø¯Ø± Ø³Û’ Ø²ÛŒØ§Ø¯Û rich ÛÙˆØªÛ’ ÛÛŒÚºØŒ\n" +
          "Ú†Ø§ÛÛ’ Ø¬ÛŒØ¨ Ù…ÛŒÚº Ù¾ÛŒØ³Û ÛÙˆ ÛŒØ§ Ù†Û ÛÙˆÛ”\n\n" +
          "Ø§Ú¯Ø± Ø¢Ù¾ Ø¢Ø¬ ØªÛŒÙ† Ø§ÛŒØ³ÛŒ Ù†Ø¹Ù…ØªÛŒÚº Ù„Ú©Ú¾ Ø¯ÛŒÚº Ø¬Ù† Ú©Ø§ Ø¢Ù¾ Ú©Ùˆ Ø´Ú©Ø± Ù…Ø­Ø³ÙˆØ³ ÛÙˆ Ø±ÛØ§ ÛÛ’ØŒ\n" +
          "ØªÙˆ ÛŒÛ list Ø¢Ù¾ Ú©Û’ emotional bank Ù…ÛŒÚº deposit ÛÙˆ Ø¬Ø§Ø¦Û’ Ú¯ÛŒÛ”",
        emotion: "gratitude",
        polarity: "positive",
        intensity: 0.8,
        category: "emotional_positive"
      }
    ];

    // FINAL MERGED QA DATABASE (Only define once)
    const qaDatabase = [
      ...qa_english_core,
      ...qa_urdu_core,
      ...qa_urdu_sadness,
      ...qa_urdu_anger,
      ...qa_urdu_anxiety,
      ...qa_urdu_spiritual,
      ...qa_urdu_happiness
    ];


    // ==========================
    //  RL3 / LR3 â€“ Simple match
    // ==========================
    function normalizeText(t) {
      // Added Urdu/Hindi normalization for better matching
      return t.toLowerCase().replace(/[ØŸ?!.ØŒ,]/g, ' ').replace(/\s+/g, ' ').trim();
    }

    function findQaEntry(userInput) {
      const norm = normalizeText(userInput);
      for (const entry of qaDatabase) {
        for (const pat of entry.patterns) {
          if (norm.includes(normalizeText(pat))) return entry;
        }
      }
      return null;
    }

    // ==========================
    //  VOICE SETUP
    // ==========================
    let voiceOn = true;
    function updateVoiceUI() {
      voiceStatus.textContent = voiceOn ? "on" : "off";
      voiceMenuItem.classList.toggle("active", voiceOn);
    }
    function speak(text) {
      if (!voiceOn) return;
      if (!("speechSynthesis" in window)) return;
      window.speechSynthesis.cancel();
      const utter = new SpeechSynthesisUtterance(text);
      // Urdu-focused voice
      utter.lang = "ur-PK"; 
      utter.rate = 1.02;
      utter.pitch = 1.0;
      window.speechSynthesis.speak(utter);
    }

    // ==========================
    //  BELIEFS & THEME
    // ==========================
    let celestialState = 1; // start moon-floating
    let currentTheme = "dark";
    let beliefState = {
      Natural: true,
      "Universal Ethics": true,
      Islam: false,
      Christianity: false,
      Hinduism: false,
      Buddhism: false,
      Sikhism: false,
      Judaism: false,
      "BahÃ¡â€™Ã­": false,
      Jainism: false,
      Atheism: false
    };
    let llmState = "Offline basic QA only";
    const beliefLabels = Object.keys(beliefState);
    const llmOptions = [
      "Offline basic QA only",
      "Local LLM (future)",
      "OpenAI GPT (future)",
      "Other providers (future)"
    ];

    function setCelestialState(state) {
      celestialState = state;
      celestialOrb.classList.remove("sun","moon","floating","empty");
      celestialGlow.classList.remove("sun-glow","moon-glow");
      if (state === 0) {
        celestialOrb.style.display = "flex";
        celestialOrb.classList.add("sun");
        celestialGlow.classList.add("sun-glow");
        celestialGlow.style.opacity = "0.9";
      } else if (state === 1) {
        celestialOrb.style.display = "flex";
        celestialOrb.classList.add("moon","floating");
        celestialGlow.classList.add("moon-glow");
        celestialGlow.style.opacity = "0.9";
      } else if (state === 2) {
        celestialOrb.style.display = "flex";
        celestialOrb.classList.add("moon");
        celestialGlow.classList.add("moon-glow");
        celestialGlow.style.opacity = "0.65";
      } else {
        celestialOrb.style.display = "flex";
        celestialOrb.classList.add("empty");
        celestialGlow.style.opacity = "0";
      }
    }

    celestialOrb.addEventListener("click", () => {
      const next = (celestialState + 1) % 4;
      setCelestialState(next);
    });

    function setTheme(theme, fromTimeInit=false) {
      currentTheme = theme;
      const body = document.body;
      if (theme === "light") {
        body.style.background = "#0f172a";
        card.style.background =
          "radial-gradient(circle at top, #1f2937 0%, #020617 45%, #020617 100%)";
        lightThemePill.classList.add("active");
        darkThemePill.classList.remove("active");
        if (!fromTimeInit) setCelestialState(0);
      } else {
        body.style.background = "#020617";
        card.style.background =
          "radial-gradient(circle at top, #020617 0%, #020617 40%, #020617 100%)";
        darkThemePill.classList.add("active");
        lightThemePill.classList.remove("active");
        if (!fromTimeInit) setCelestialState(1);
      }
    }

    (function initThemeByTime() {
      const hour = new Date().getHours();
      if (hour >= 6 && hour < 18) {
        setTheme("light", true);
        setCelestialState(0);
        modeLabel.textContent = "Natural Â· Universal Ethics";
      } else {
        setTheme("dark", true);
        setCelestialState(1);
        modeLabel.textContent = "Natural Â· Universal Ethics";
      }
    })();

    menuBtn.addEventListener("click", () => {
      menuPanel.classList.toggle("visible");
    });
    document.addEventListener("click", (e) => {
      if (!menuPanel.contains(e.target) && !menuBtn.contains(e.target)) {
        menuPanel.classList.remove("visible");
      }
    });

    function renderBeliefChips() {
      beliefChipsContainer.innerHTML = "";
      beliefLabels.forEach(label => {
        const chip = document.createElement("div");
        chip.className = "chip" + (beliefState[label] ? "selected" : "");
        chip.textContent = label;
        chip.addEventListener("click", () => {
          beliefState[label] = !beliefState[label];
          if (!beliefState.Natural && !beliefState["Universal Ethics"]) {
            beliefState["Universal Ethics"] = true;
          }
          renderBeliefChips();
          updateBeliefFooter();
        });
        beliefChipsContainer.appendChild(chip);
      });
    }
    function updateBeliefFooter() {
      const active = beliefLabels.filter(l => beliefState[l]);
      beliefFooter.innerHTML =
        "Currently selected: <strong>" + active.join(" Â· ") + "</strong>.";
    }

    beliefsMenuItem.addEventListener("click", () => {
      menuPanel.classList.remove("visible");
      beliefOverlay.classList.add("visible");
    });

    themeMenuItem.addEventListener("click", () => {
      menuPanel.classList.remove("visible");
      themeOverlay.classList.add("visible");
    });
    lightThemePill.addEventListener("click", () => setTheme("light"));
    darkThemePill.addEventListener("click", () => setTheme("dark"));

    voiceMenuItem.addEventListener("click", () => {
      voiceOn = !voiceOn;
      if (!voiceOn && window.speechSynthesis) {
        window.speechSynthesis.cancel();
      }
      updateVoiceUI();
      menuPanel.classList.remove("visible");
    });

    function renderLlmChips() {
      llmChipsContainer.innerHTML = "";
      llmOptions.forEach(label => {
        const chip = document.createElement("div");
        chip.className = "chip" + (llmState === label ? " selected" : "");
        chip.textContent = label;
        chip.addEventListener("click", () => {
          llmState = label;
          llmLabel.textContent =
            label === "Offline basic QA only" ? "offline" : "future";
          llmFooter.innerHTML =
            "Selected engine: <strong>" + llmState + ".</strong>";
          renderLlmChips();
        });
        llmChipsContainer.appendChild(chip);
      });
    }

    llmMenuItem.addEventListener("click", () => {
      menuPanel.classList.remove("visible");
      llmOverlay.classList.add("visible");
    });

    languageMenuItem.addEventListener("click", () => {
      menuPanel.classList.remove("visible");
    });

    aboutMenuItem.addEventListener("click", () => {
      menuPanel.classList.remove("visible");
      aboutOverlay.classList.add("visible");
    });

    document.querySelectorAll(".close-btn").forEach(btn => {
      btn.addEventListener("click", () => {
        const targetId = btn.getAttribute("data-close");
        if (targetId) {
          document.getElementById(targetId).classList.remove("visible");
        }
      });
    });

    [beliefOverlay, themeOverlay, llmOverlay, aboutOverlay].forEach(overlay => {
      overlay.addEventListener("click", (e) => {
        if (e.target === overlay) overlay.classList.remove("visible");
      });
    });

    // ==========================
    //  CONTINUITY EQUATION UI
    // ==========================
    function updateEquationUI(state) {
      tmVal.textContent          = state.tm.toFixed(2);
      bmVal.textContent          = state.bm.toFixed(2);
      dVal.textContent           = state.d.toFixed(2);
      lambdaFaithVal.textContent = state.lambdaFaith.toFixed(2);
      lambdaSysVal.textContent   = state.lambdaSys.toFixed(2);
      ctSumVal.textContent       = state.ct.toFixed(2);

      const e0 = Math.tanh(
        (state.tm * state.bm) -
        state.d +
        state.lambdaFaith +
        state.lambdaSys +
        state.ct
      );
      const e0Clamped = clamp(e0, -1, 1);
      e0Val.textContent = e0Clamped.toFixed(2);

      const normalized = (e0Clamped + 1) / 2; // 0..1
      e0Bar.style.transform = "scaleX(" + normalized.toFixed(2) + ")";
    }

    // ==========================
    //  MAIN REPLY ENGINE
    // ==========================
    function buildFallbackReply(message) {
      return (
        "Ù…ÛŒÚº Ù†Û’ Ø¢Ù¾ Ú©Ø§ Ù…ÛŒØ³Ø¬ Ø³Ù†Ø§ ÛÛ’Û” Ø¢Ø¦ÛŒÛ’ Ø§Ø³Û’ Ù¾Ø±Ø³Ú©ÙˆÙ† Ù…Ù†Ø·Ù‚ Ø§ÙˆØ± Ù†Ø±Ù… Ø§Ø®Ù„Ø§Ù‚ÛŒØ§Øª Ø³Û’ Ø¯ÛŒÚ©Ú¾ØªÛ’ ÛÛŒÚºÛ” " +
        "Ù…Ø¬Ú¾Û’ ØªÚ¾ÙˆÚ‘Ø§ Ø§ÙˆØ± Ø¨ØªØ§Ø¦ÛŒÚº: Ø§Ø³ Ù…ÛŒØ³Ø¬ Ú©Û’ Ù¾ÛŒÚ†Ú¾Û’ Ø§ØµÙ„ Ù…Ø³Ø¦Ù„Û ÛŒØ§ Ø§Ø­Ø³Ø§Ø³ Ú©ÛŒØ§ ÛÛ’ØŸ"
      );
    }

    function applyBeliefFlavor(reply) {
      const activeBeliefs = beliefLabels.filter(l => beliefState[l]);
      if (activeBeliefs.includes("Islam")) {
        if (!reply.includes("InshaAllah") && !reply.includes("Ø§Ù†Ø´Ø§Ø¡Ø§Ù„Ù„Û")) {
          reply += "\n\nØ§Ù†Ø´Ø§Ø¡Ø§Ù„Ù„ÛØŒ Ø§Ú¯Ø± Ø¢Ù¾ ØµØ­ÛŒØ­ Ú©Ø§Ù… Ú©Ø±ØªÛ’ Ø±ÛÛŒÚº Ú¯Û’ØŒ ØªÙˆ Ú†ÛŒØ²ÛŒÚº Ø¢ÛØ³ØªÛ Ø¢ÛØ³ØªÛ Ø®ÛŒØ± Ú©ÛŒ Ø·Ø±Ù Ø¨Ú‘Ú¾ÛŒÚº Ú¯ÛŒÛ”";
        }
      }
      return reply;
    }

    function handleSend() {
      const raw = userInput.value;
      const message = raw.trim() || "hello";
      userInput.value = "";
      
      youSaidEl.textContent = 'Ø¢Ù¾ Ù†Û’ Ú©ÛØ§: "' + message + '"';

      // 1) Ethics guard
      const ethicsMsg = ethicsGuard(message);

      // 2) Pattern match
      let entry = findQaEntry(message);
      let reply = entry ? entry.answer : buildFallbackReply(message);

      // 3) If ethics warning exists, prepend it softly
      if (ethicsMsg) {
        reply = ethicsMsg + "\n\n" + reply;
        entry = entry || {
          emotion: "concern",
          polarity: "negative",
          intensity: 0.6,
          category: "ethics_guard"
        };
      }

      // 4) Update models
      const usedEntry = entry || {
        emotion: "neutral",
        polarity: "neutral",
        intensity: 0.3,
        category: "generic"
      };
      updateCRM(usedEntry, auraState);
      updateAEC(usedEntry, auraState);
      updateAECNetwork(usedEntry, auraState);

      // 5) Update continuity term from AEC
      auraState.ct = clamp(auraState.continuity * 0.3 + 0.15, 0, 0.6);

      // 6) Update UI for equation
      updateEquationUI(auraState);

      // 7) Belief flavour + output
      reply = applyBeliefFlavor(reply);
      assistantTextEl.textContent = reply;
      speak(reply);
    }

    sendBtn.addEventListener("click", handleSend);
    userInput.addEventListener("keydown", (e) => {
      if (e.key === "Enter") handleSend();
    });

    // ==========================
    //  INITIALISE
    // ==========================
    function init() {
      renderBeliefChips();
      updateBeliefFooter();
      renderLlmChips();
      updateVoiceUI();
      updateEquationUI(auraState);
    }
    init();
  </script>
</body>
</html>
