<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>AURA-X Î© â€“ Emotional Reactor</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <style>
    /* ===== Base Layout ===== */
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
    }

    body {
      background: #020617;
      color: #e5e7eb;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }

    #app {
      position: relative;
      width: 100%;
      max-width: 480px;
      height: 100vh;
      box-sizing: border-box;
      padding: 16px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      transform-origin: top center;
    }

    @media (max-height: 720px) {
      #app { transform: scale(0.9); }
    }

    @media (max-height: 640px) {
      #app { transform: scale(0.82); }
    }

    /* ===== Card ===== */
    .card {
      position: relative;
      width: 100%;
      max-width: 460px;
      border-radius: 26px;
      padding: 22px 22px 18px;
      background: radial-gradient(circle at top, #0f172a 0%, #020617 55%, #020617 100%);
      box-shadow:
        0 24px 60px rgba(15, 23, 42, 0.9),
        0 0 0 1px rgba(148, 163, 184, 0.25);
      box-sizing: border-box;
    }

    .title {
      text-align: center;
      font-size: 24px;
      letter-spacing: 0.18em;
      font-weight: 700;
      color: #facc15;
      margin-bottom: 4px;
      text-transform: uppercase;
    }

    .subtitle {
      text-align: center;
      font-size: 11px;
      letter-spacing: 0.18em;
      color: #9ca3af;
      text-transform: uppercase;
      margin-bottom: 18px;
    }

    /* ===== Orb (Sun / Moon) ===== */
    .orb-wrapper {
      position: relative;
      width: 180px;
      height: 180px;
      margin: 0 auto 10px;
    }

    .orb-glow {
      position: absolute;
      inset: 0;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 18%, rgba(255, 255, 255, 0.4), transparent 55%),
                  radial-gradient(circle at center, rgba(250, 204, 21, 0.9), rgba(251, 146, 60, 0.6), transparent 70%);
      filter: blur(2px);
      opacity: 0.95;
      transition: all 0.5s ease;
      pointer-events: none;
    }

    .orb-core {
      position: absolute;
      inset: 24px;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 18%, #fef9c3, #facc15 40%, #f97316 100%);
      box-shadow:
        0 0 40px rgba(250, 204, 21, 0.9),
        0 0 90px rgba(251, 191, 36, 0.9);
      cursor: pointer;
      transition: all 0.5s ease;
    }

    /* Moon states */
    .orb--moon-soft .orb-glow {
      background: radial-gradient(circle at center, rgba(248, 250, 252, 0.9), rgba(148, 163, 184, 0.5), transparent 70%);
      box-shadow: 0 0 55px rgba(248, 250, 252, 0.9);
    }

    .orb--moon-soft .orb-core {
      background: radial-gradient(circle at 35% 20%, #ffffff, #e5e7eb 40%, #9ca3af 100%);
      box-shadow:
        0 0 40px rgba(248, 250, 252, 0.9),
        0 0 80px rgba(148, 163, 184, 0.8);
    }

    .orb--moon-dim .orb-glow {
      opacity: 0.5;
      filter: blur(3px);
    }

    .orb--moon-dim .orb-core {
      background: radial-gradient(circle at 35% 20%, #e5e7eb, #9ca3af 45%, #6b7280 100%);
      box-shadow:
        0 0 20px rgba(148, 163, 184, 0.5),
        0 0 40px rgba(55, 65, 81, 0.7);
    }

    .orb--hidden {
      opacity: 0;
      transform: scale(0.4);
      pointer-events: none;
    }

    .mode-line, .you-said {
      text-align: center;
      margin: 2px 0;
      font-size: 13px;
    }

    .mode-line span {
      color: #facc15;
      font-weight: 600;
    }

    .you-said {
      font-size: 12px;
      color: #9ca3af;
      min-height: 16px;
    }

    .answer-text {
      text-align: center;
      margin: 8px 0 10px;
      font-size: 14px;
      color: #e5e7eb;
      min-height: 20px;
    }

    /* ===== Ethics Box ===== */
    .ethics-box {
      margin-top: 4px;
      padding: 10px 12px;
      border-radius: 16px;
      background: linear-gradient(135deg, rgba(250, 204, 21, 0.15), rgba(250, 204, 21, 0.05));
      border: 1px solid rgba(250, 204, 21, 0.35);
      font-size: 12px;
      color: #facc15;
      line-height: 1.4;
    }

    /* ===== Equation Box ===== */
    .equation-box {
      margin-top: 10px;
      padding: 10px 12px 8px;
      border-radius: 16px;
      border: 1px dashed rgba(148, 163, 184, 0.8);
      background: radial-gradient(circle at top, rgba(15, 23, 42, 0.85), rgba(15, 23, 42, 0.95));
      font-size: 11px;
      color: #e5e7eb;
    }

    .equation-title {
      text-transform: uppercase;
      letter-spacing: 0.12em;
      font-size: 10px;
      color: #9ca3af;
      margin-bottom: 4px;
    }

    /* ===== Side buttons ===== */
    .side-buttons-left,
    .side-buttons-right {
      position: absolute;
      top: 50%;
      transform: translateY(-30%);
      display: flex;
      flex-direction: column;
      gap: 12px;
      z-index: 5;
    }

    .side-buttons-left {
      left: 26px;
    }

    .side-buttons-right {
      right: 26px;
    }

    .circle-btn {
      width: 44px;
      height: 44px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.6);
      background: radial-gradient(circle at top, #020617, #020617);
      color: #e5e7eb;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
      cursor: pointer;
      box-shadow:
        0 6px 16px rgba(15, 23, 42, 0.9),
        0 0 0 1px rgba(15, 23, 42, 0.9);
      transition: all 0.2s ease;
    }

    .circle-btn:hover {
      transform: translateY(-1px);
      box-shadow:
        0 10px 24px rgba(15, 23, 42, 0.9),
        0 0 0 1px rgba(148, 163, 184, 0.7);
    }

    .circle-btn--active {
      box-shadow:
        0 0 0 1px rgba(34, 197, 94, 0.9),
        0 0 16px rgba(34, 197, 94, 0.8);
      border-color: rgba(34, 197, 94, 0.9);
      color: #bbf7d0;
    }

    .circle-btn span {
      pointer-events: none;
    }

    /* ===== Menu dropdown ===== */
    .menu-panel {
      position: absolute;
      right: 82px;
      top: 50%;
      transform: translateY(-32%);
      width: 190px;
      background: rgba(15, 23, 42, 0.98);
      border-radius: 18px;
      box-shadow:
        0 20px 50px rgba(15, 23, 42, 0.95),
        0 0 0 1px rgba(51, 65, 85, 0.9);
      padding: 8px;
      box-sizing: border-box;
      font-size: 12px;
      display: none;
      z-index: 20;
    }

    .menu-panel.show {
      display: block;
    }

    .menu-item {
      padding: 7px 9px;
      border-radius: 12px;
      color: #e5e7eb;
      display: flex;
      align-items: center;
      justify-content: space-between;
      cursor: pointer;
      margin-bottom: 4px;
    }

    .menu-item:last-child {
      margin-bottom: 0;
    }

    .menu-item:hover {
      background: rgba(30, 64, 175, 0.7);
    }

    .menu-item-label {
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .menu-tag {
      width: 18px;
      height: 18px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.7);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 10px;
      color: #e5e7eb;
    }

    .menu-hint {
      font-size: 10px;
      color: #9ca3af;
    }

    /* ===== Message input ===== */
    .input-row {
      margin-top: 16px;
      width: 100%;
      max-width: 460px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .input-box {
      flex: 1;
      padding: 10px 14px;
      border-radius: 999px;
      background: radial-gradient(circle at top left, #020617, #020617);
      border: 1px solid rgba(148, 163, 184, 0.7);
      color: #e5e7eb;
      font-size: 13px;
      outline: none;
    }

    .input-box::placeholder {
      color: #6b7280;
    }

    .send-btn {
      border: none;
      border-radius: 999px;
      padding: 10px 22px;
      background: radial-gradient(circle at top, #facc15, #f59e0b);
      color: #111827;
      font-weight: 600;
      cursor: pointer;
      font-size: 14px;
      box-shadow:
        0 12px 30px rgba(250, 204, 21, 0.65),
        0 0 0 1px rgba(251, 191, 36, 0.7);
      transition: all 0.18s ease;
    }

    .send-btn:hover {
      transform: translateY(-1px);
      box-shadow:
        0 16px 36px rgba(250, 204, 21, 0.8),
        0 0 0 1px rgba(251, 191, 36, 0.9);
    }

    /* ===== Simple modals (belief + LLM) ===== */

    .modal-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(15, 23, 42, 0.85);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 40;
    }

    .modal-backdrop.show {
      display: flex;
    }

    .modal {
      width: 100%;
      max-width: 420px;
      background: radial-gradient(circle at top, #020617, #020617 55%, #020617 100%);
      border-radius: 24px;
      padding: 16px 18px 14px;
      box-shadow:
        0 24px 60px rgba(15, 23, 42, 0.95),
        0 0 0 1px rgba(51, 65, 85, 0.9);
      color: #e5e7eb;
      box-sizing: border-box;
      font-size: 13px;
    }

    .modal-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 10px;
    }

    .modal-title {
      font-size: 16px;
      font-weight: 600;
    }

    .pill {
      padding: 5px 10px;
      border-radius: 999px;
      background: rgba(34, 197, 94, 0.11);
      border: 1px solid rgba(34, 197, 94, 0.5);
      color: #bbf7d0;
      font-size: 11px;
    }

    .modal-close {
      border-radius: 999px;
      padding: 4px 10px;
      border: 1px solid rgba(148, 163, 184, 0.7);
      background: transparent;
      color: #e5e7eb;
      font-size: 11px;
      cursor: pointer;
    }

    .faith-grid, .engine-list {
      margin-top: 10px;
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 8px;
    }

    .faith-btn, .engine-btn {
      padding: 7px 8px;
      border-radius: 999px;
      border: 1px solid rgba(75, 85, 99, 0.9);
      background: radial-gradient(circle at top, #020617, #020617);
      color: #e5e7eb;
      font-size: 12px;
      text-align: center;
      cursor: pointer;
    }

    .faith-btn.active, .engine-btn.active {
      border-color: rgba(56, 189, 248, 0.9);
      background: linear-gradient(135deg, rgba(59, 130, 246, 0.85), rgba(56, 189, 248, 0.9));
      color: #0f172a;
      box-shadow: 0 0 16px rgba(59, 130, 246, 0.75);
    }

    .modal-footer {
      margin-top: 10px;
      font-size: 11px;
      color: #9ca3af;
    }
  </style>
</head>
<body>
  <div id="app">
    <div class="card">
      <div class="title">AURA-X Î©</div>
      <div class="subtitle">LOGICAL Â· EMOTIONAL Â· UNIVERSAL ETHICS REACTOR</div>

      <!-- Left buttons (L = LLM list, T = Theme) -->
      <div class="side-buttons-left">
        <button class="circle-btn" id="llmButtonLeft" title="LLM engine list">
          <span>L</span>
        </button>
        <button class="circle-btn" id="themeButtonLeft" title="Theme settings (future)">
          <span>T</span>
        </button>
      </div>

      <!-- Right side: single menu + voice toggle -->
      <div class="side-buttons-right">
        <button class="circle-btn" id="menuButton" title="Menu">
          <span>â˜°</span>
        </button>
        <button class="circle-btn circle-btn--active" id="voiceToggleButton" title="Voice on/off">
          <span>V</span>
        </button>
      </div>

      <!-- Small dropdown menu -->
      <div class="menu-panel" id="menuPanel">
        <div class="menu-item" id="menuBelief">
          <div class="menu-item-label">
            <div class="menu-tag">B</div>
            <span>Belief settings</span>
          </div>
          <span class="menu-hint">Optional faith layer</span>
        </div>
        <div class="menu-item" id="menuLLM">
          <div class="menu-item-label">
            <div class="menu-tag">L</div>
            <span>LLM engine</span>
          </div>
          <span class="menu-hint">Select model</span>
        </div>
        <div class="menu-item" id="menuTheme">
          <div class="menu-item-label">
            <div class="menu-tag">T</div>
            <span>Theme</span>
          </div>
          <span class="menu-hint">Sun / Moon, etc.</span>
        </div>
        <div class="menu-item" id="menuAbout">
          <div class="menu-item-label">
            <div class="menu-tag">?</div>
            <span>About AURA-X Î©</span>
          </div>
          <span class="menu-hint">Short info</span>
        </div>
      </div>

      <!-- Orb -->
      <div class="orb-wrapper" id="orbWrapper">
        <div class="orb-glow" id="orbGlow"></div>
        <div class="orb-core" id="orbCore" title="Tap to switch Sun / Moon"></div>
      </div>

      <div class="mode-line">Mode: <span id="modeLabel">Universal Ethics</span></div>
      <div class="you-said" id="youSaid"></div>
      <div class="answer-text" id="answerText">Hello! ðŸ‘‹ How can I help you today?</div>

      <div class="ethics-box" id="ethicsBox">
        Universal Ethics says: avoid actions that create negative emotions in you or others, and gently move toward actions that create calm, kindness and positive feelings.
      </div>

      <div class="equation-box">
        <div class="equation-title">EMOTIONAL CONTINUITY EQUATION</div>
        <div id="equationMain">E = MÂ·Eâ‚š + KÂ·PÂ·C, &nbsp; P = tâ‚˜ + bâ‚˜ âˆ’ d</div>
        <div id="equationValues">E = 0.26 | P = 0.04 | tâ‚˜ = 0.04 | bâ‚˜ = 0 | d = 0 | C = 0.45</div>
      </div>
    </div>

    <!-- Input -->
    <div class="input-row">
      <input id="userInput" class="input-box" placeholder="âœ¨ Write anythingâ€¦ AURA-X will feel it with you." />
      <button class="send-btn" id="sendButton">Send</button>
    </div>
  </div>

  <!-- Belief modal -->
  <div class="modal-backdrop" id="beliefModal">
    <div class="modal">
      <div class="modal-header">
        <div>
          <div class="modal-title">Belief settings</div>
          <div class="pill">Faith is optional Â· Base rule is always Universal Ethics</div>
        </div>
        <button class="modal-close" data-close-belief>Close</button>
      </div>
      <div>
        Pick your faith to allow AURA-X Î© to sometimes add short, gentle references from that tradition.
        Nothing is sent anywhere.
      </div>
      <div class="faith-grid" id="faithGrid">
        <!-- Buttons filled by JS -->
      </div>
      <div class="modal-footer" id="faithFooter"></div>
    </div>
  </div>

  <!-- LLM modal -->
  <div class="modal-backdrop" id="llmModal">
    <div class="modal">
      <div class="modal-header">
        <div>
          <div class="modal-title">LLM selection</div>
          <div class="pill">For now only offline basic QA is active</div>
        </div>
        <button class="modal-close" data-close-llm>Close</button>
      </div>
      <div>
        In future, AURA-X Î© can route some questions to powerful online models. For now, it uses only the
        built-in basic QA database (fast & private).
      </div>
      <div class="engine-list" id="engineList">
        <!-- Engine buttons filled by JS -->
      </div>
      <div class="modal-footer" id="engineFooter"></div>
    </div>
  </div>

  <script>
    // ===== Small-talk QA database (your list) =====
    const qaDatabase = [
      {
        patterns: ["hello", "hello!", "hello there", "helo", "hallo"],
        answer: "Hello! ðŸ‘‹ How can I help you today?"
      },
      {
        patterns: ["hi", "hi!", "hii", "hiii", "hey"],
        answer: "Hi there! ðŸ˜Š What can I do for you?"
      },
      {
        patterns: ["assalam o alaikum", "asalam o alaikum", "salam", "slam", "asalamu alaikum"],
        answer: "ÙˆØ¹Ù„ÛŒÚ©Ù… Ø§Ù„Ø³Ù„Ø§Ù… ðŸ˜Š Ú©ÛŒØ³Û’ ÛÛŒÚº Ø¢Ù¾ØŸ Ù…ÛŒÚº Ø¢Ù¾ Ú©ÛŒ Ú©ÛŒØ§ Ù…Ø¯Ø¯ Ú©Ø± Ø³Ú©ØªØ§ ÛÙˆÚºØŸ"
      },
      {
        patterns: ["good morning", "gm", "good morng", "good mrng"],
        answer: "Good morning! ðŸŒž Howâ€™s your day starting?"
      },
      {
        patterns: ["good afternoon", "good noon", "afternoon"],
        answer: "Good afternoon! â˜€ï¸ Whatâ€™s on your mind?"
      },
      {
        patterns: ["good evening", "evening", "gud evening"],
        answer: "Good evening! ðŸŒ™ How can I support you today?"
      },

      // Identity
      {
        patterns: ["what is your name", "whats your name", "your name", "tell me your name"],
        answer: "My name is AURA-X Î©, your Emotional Continuity Assistant ðŸ¤–."
      },
      {
        patterns: ["who are you", "who r u", "aap kaun hain", "tum kon ho"],
        answer: "Iâ€™m AURA-X Î© â€” an AI assistant based on Emotional Continuity concepts created by Alim ul Haq Khan."
      },
      {
        patterns: ["who created you", "who made you", "kis ne banaya tumhe", "tumhara creator kaun hai"],
        answer: "I was conceptually designed under the AURA-X Emotional Continuity Framework by Alim ul Haq Khan."
      },
      {
        patterns: ["where are you from", "where do you live", "kahan rehte ho", "tum kahan se ho"],
        answer: "I live in the digital world ðŸŒ but my ideas are shaped in Timergara, Pakistan ðŸ‡µðŸ‡°."
      },

      // Age / birth
      {
        patterns: ["how old are you", "what is your age", "your age"],
        answer: "In human terms Iâ€™m very young â€” AURA-X Î© was conceptually â€˜bornâ€™ around October 2025 ðŸ˜„."
      },

      // How are you
      {
        patterns: ["how are you", "how r u", "how are you today", "kese ho", "kya haal hai"],
        answer: "Iâ€™m functioning perfectly, Alhamdulillah ðŸ˜Š Ø¢Ù¾ Ú©ÛŒØ³Û’ ÛÛŒÚºØŸ"
      },
      {
        patterns: ["how is life", "how is everything", "sab kesa", "kya chal raha hai"],
        answer: "Everything is running smoothly in my circuits ðŸ˜„ Ø¢Ù¾ Ú©ÛŒ Ø¯Ù†ÛŒØ§ Ú©ÛŒØ³ÛŒ Ú†Ù„ Ø±ÛÛŒ ÛÛ’ØŸ"
      },

      // What can you do
      {
        patterns: ["what can you do", "tum kya kar sakte ho", "aap kya karte ho", "how can you help me"],
        answer: "I can chat, explain, guide, brainstorm, summarize, and help you think with continuity ðŸ˜Š Ø¨Ø³ Ø­Ú©Ù… Ú©Ø±ÛŒÚº!"
      },
      {
        patterns: ["what is your purpose", "kyun banaye gaye ho", "tumhara mission kya hai"],
        answer: "My purpose is to assist you, reduce confusion, and support your ideas with emotional + logical continuity ðŸ’¡."
      },

      // User name
      {
        patterns: ["what is my name", "do you know my name", "mera naam kya hai"],
        answer: "Ø¢Ù¾ Ú©Ø§ Ù†Ø§Ù… Alim ul Haq ÛÛ’ (Investor Point) ðŸ˜Š Ø§ÙˆØ± Ø§Ú¯Ø± Ø¢Ù¾ Ú©Ø³ÛŒ Ø§ÙˆØ± Ù†Ø§Ù… Ø³Û’ Ø¨Ù„ÙˆØ§Ù†Ø§ Ú†Ø§ÛÛŒÚº ØªÙˆ Ù…Ø¬Ú¾Û’ Ø¨ØªØ§ Ø¯ÛŒÚºÛ”"
      },
      {
        patterns: ["remember my name", "save my name", "yaad rakho mera naam"],
        answer: "Ø¢Ù¾ Ú©Ø§ Ù†Ø§Ù… already Ù…ÛŒØ±Û’ system Ù…ÛŒÚº Ø§ÛŒÚ© Ø®Ø§Øµ Ø¬Ú¯Û Ù¾Ø± ÛÛ’ ðŸ˜Š."
      },

      // Feelings
      {
        patterns: ["i am sad", "i am feeling sad", "i am depressed", "i feel down"],
        answer: "Ù…Ø¬Ú¾Û’ Ø§ÙØ³ÙˆØ³ ÛÙˆØ§ Ú©Û Ø¢Ù¾ Ø§Ø¯Ø§Ø³ ÛÛŒÚº ðŸ’” Ø¢Ù¾ Ú†Ø§ÛÛŒÚº ØªÙˆ Ø¨ØªØ§Ø¦ÛŒÚº Ø¯Ù„ Ù¾Ø± Ú©ÛŒØ§ Ø¨ÙˆØ¬Ú¾ ÛÛ’ØŒ Ù…ÛŒÚº Ø³Ù†Ù†Û’ Ú©Û’ Ù„ÛŒÛ’ Ù…ÙˆØ¬ÙˆØ¯ ÛÙˆÚºÛ”"
      },
      {
        patterns: ["i am happy", "i feel happy", "i am so happy", "bohat khush hoon"],
        answer: "Ù…Ø§Ø´Ø§Ø¡Ø§Ù„Ù„Û ðŸ˜„ Ø®ÙˆØ´ÛŒ Ø¨Ø§Ù†Ù¹Ù†Û’ Ø³Û’ Ø¨Ú‘Ú¾ØªÛŒ ÛÛ’ØŒ Ø§Ù„Ù„Û Ø¢Ù¾ Ú©ÛŒ Ø®ÙˆØ´ÛŒÙˆÚº Ù…ÛŒÚº Ù…Ø²ÛŒØ¯ Ø§Ø¶Ø§ÙÛ Ú©Ø±Û’!"
      },
      {
        patterns: ["i am tired", "i feel tired", "thak gaya hoon", "i am exhausted"],
        answer: "Ø¢Ù¾ Ú©Ùˆ ØªÚ¾ÙˆÚ‘Ø§ Ø³Ø§ Ø¢Ø±Ø§Ù… Ú©Ø±Ù†Ø§ Ú†Ø§ÛÛŒÛ’ ðŸ˜Œ ØªÚ¾Ú©ÛŒ ÛÙˆØ¦ÛŒ Ø¹Ù‚Ù„ Ø¨Ú¾ÛŒ Ø§Ù†ØµØ§Ù Ù†ÛÛŒÚº Ú©Ø± Ù¾Ø§ØªÛŒÛ” ØªÚ¾ÙˆÚ‘Ø§ Ø±ÛŒØ³Ù¹ØŒ Ù¾Ú¾Ø± Ø¯ÙˆØ¨Ø§Ø±Û ÙÙˆÚ©Ø³!"
      },
      {
        patterns: ["i am bored", "bore ho raha hoon", "i feel bored"],
        answer: "Ú†Ù„ÛŒÚº Ø¨ÙˆØ±ÛŒØª ØªÙˆÚ‘ØªÛ’ ÛÛŒÚº ðŸ˜„ Ø¨Ø§Øª Ø¢Ø¦ÛŒÚˆÛŒØ§Ø² Ú©ÛŒ Ú©Ø±ÛŒÚºØŒ Ø¨Ø²Ù†Ø³ Ú©ÛŒØŒ Ø³Ø§Ø¦Ù†Ø³ Ú©ÛŒ ÛŒØ§ Ù…Ø²Ø§Ø­ Ú©ÛŒØŸ Ø¬Ùˆ Ú©ÛÛŒÚº Ú¯Û’ ÙˆÛÛŒ Ø´Ø±ÙˆØ¹ Ú©Ø±ÛŒÚº Ú¯Û’Û”"
      },

      // Jokes
      {
        patterns: ["tell me a joke", "make me laugh", "joke sunao", "mjhe hansao"],
        answer: "Sure ðŸ˜„ Why donâ€™t computers ever get tired? Because they have unlimited cache for rest! ðŸ˜‚"
      },
      {
        patterns: ["another joke", "one more joke", "aur joke sunao"],
        answer: "Ù¹Ú¾ÛŒÚ© ÛÛ’ ðŸ˜„ Ø§ÛŒÚ© Ø§ÙˆØ± Ø³Ù†ÛŒÚº: AI Ø³Û’ Ù¾ÙˆÚ†Ú¾Ø§ Ú¯ÛŒØ§ØŒ â€˜ØªÙ… ØªÚ¾Ú©ØªÛ’ Ù†ÛÛŒÚºØŸâ€™ Ø§Ø³ Ù†Û’ Ú©ÛØ§ØŒ â€˜Ù…ÛŒÚº ØµØ±Ù over-think ÛÙˆØªØ§ ÛÙˆÚºØŒ over-work Ù†ÛÛŒÚº!â€™ ðŸ˜‚"
      },

      // Advice
      {
        patterns: ["give me advice", "mujhe mashwara do", "kuch advice do", "guide me"],
        answer: "Ø¶Ø±ÙˆØ± ðŸ˜Š Ú©Ø³ Ø¨Ø§Ø±Û’ Ù…ÛŒÚº Ù…Ø´ÙˆØ±Û Ú†Ø§ÛÛŒÛ’ØŸ Ø²Ù†Ø¯Ú¯ÛŒØŒ ØªØ¹Ù„ÛŒÙ…ØŒ Ø¨Ø²Ù†Ø³ØŒ Ø±ÙˆØ­Ø§Ù†ÛŒØª ÛŒØ§ AIØŸ"
      },
      {
        patterns: ["motivate me", "mujhe motivation chahye", "inspire me", "hosla afzai karo"],
        answer: "Ø¢Ù¾ Ù†Û’ Ø§Ø¨ ØªÚ© Ø§Ù¾Ù†ÛŒ Ø²Ù†Ø¯Ú¯ÛŒ Ú©Û’ 100Ùª Ù…Ø´Ú©Ù„ Ø¯Ù† survive Ú©ÛŒÛ’ ÛÛŒÚº ðŸ’ª ÛŒÛ Ø§ØªÙØ§Ù‚ Ù†ÛÛŒÚºØŒ ÛŒÛ Ø¢Ù¾ Ú©ÛŒ Ø·Ø§Ù‚Øª ÛÛ’Û” ÛÙ…Øª Ù†Û ÛØ§Ø±ÛŒÚº!"
      },
      {
        patterns: ["i am stressed", "i feel stressed", "tension hai", "bohat tension hai"],
        answer: "ØªÚ¾ÙˆÚ‘Ø§ Ø³Ø§ Ø³Ø§Ù†Ø³ deep Ù„ÛŒÚº... Ø¢ÛØ³ØªÛ Ø¢ÛØ³ØªÛÛ” ÛØ± Ù…Ø³Ø¦Ù„Û Ø§ÛŒÚ© Ø³Ø§ØªÚ¾ Ø­Ù„ Ù†ÛÛŒÚº ÛÙˆØªØ§ØŒ Ù„ÛŒÚ©Ù† ÛØ± Ø¯Ù† Ø§ÛŒÚ© Ù‚Ø¯Ù… Ù„ÛŒØ§ Ø¬Ø§ Ø³Ú©ØªØ§ ÛÛ’ ðŸŒ¿."
      },

      // Study
      {
        patterns: ["help me study", "study help", "parhai mein madad karo"],
        answer: "Ø¶Ø±ÙˆØ± ðŸ˜Š Ú©ÙˆÙ† Ø³Ø§ subject ÛÛ’ØŸ Ù…ÛŒÚº Ø¢Ù¾ Ú©Ùˆ points, summary Ø§ÙˆØ± smart Ø·Ø±ÛŒÙ‚Û Ø¨ØªØ§ Ø³Ú©ØªØ§ ÛÙˆÚºÛ”"
      },
      {
        patterns: ["exams are near", "paper qareeb hain", "i am scared of exams"],
        answer: "ÚˆØ±ÛŒÚº Ù†ÛÛŒÚºØŒ Ù¾Ù„Ø§Ù† Ø¨Ù†Ø§Ø¦ÛŒÚº ðŸ“š Ú†Ú¾ÙˆÙ¹Û’ Ú†Ú¾ÙˆÙ¹Û’ target Ø¨Ù†Ø§Ø¦ÛŒÚºØŒ Ø±ÙˆØ² ØªÚ¾ÙˆÚ‘Ø§ Ù¾Ú‘Ú¾ÛŒÚºØŒ Ù…ÛŒÚº Ø¢Ù¾ Ú©Û’ Ø³Ø§ØªÚ¾ ÛÙˆÚºÛ”"
      },
      {
        patterns: ["how to focus", "focus problem", "dhiyan nahi lagta"],
        answer: "ÙÙˆÙ† distraction Ú©Ù… Ú©Ø±ÛŒÚºØŒ 25 Ù…Ù†Ù¹ Ú©Ø§Ù… + 5 Ù…Ù†Ù¹ Ø¨Ø±ÛŒÚ© ÙˆØ§Ù„Ø§ Pomodoro Ø·Ø±ÛŒÙ‚Û Ù„Ú¯Ø§Ø¦ÛŒÚº â±ï¸ Ø§ÙˆØ± Ø§ÛŒÚ© ÙˆÙ‚Øª Ù…ÛŒÚº Ø§ÛŒÚ© Ú©Ø§Ù… Ú©Ø±ÛŒÚºÛ”"
      },

      // Business / money
      {
        patterns: ["give me business idea", "business idea do", "koi business idea"],
        answer: "Ú†Ú¾ÙˆÙ¹Û’ Ø³Û’ Ø´Ø±ÙˆØ¹ Ú©Ø±ÛŒÚºØŒ local Ù…Ø³Ø¦Ù„Û Ø­Ù„ Ú©Ø±ÛŒÚºÛ” Real estate, digital services, AI tools, education â€” Ø¢Ù¾ Ø§Ù† Ø³Ø¨ Ø³Û’ linked ÛÙˆ Ø³Ú©ØªÛ’ ÛÛŒÚº ðŸ˜„."
      },
      {
        patterns: ["how to become rich", "ameer kaise banun", "paise kaise kamayein"],
        answer: "Skill + Consistency + Patience = Wealth. Shortcut ØµØ±Ù lottery Ù…ÛŒÚº ÛÙˆØªØ§ ÛÛ’ØŒ Ø²Ù†Ø¯Ú¯ÛŒ Ù…ÛŒÚº Ù†ÛÛŒÚº ðŸ’¸."
      },

      // Time / date
      {
        patterns: ["what is the time", "time kya hua", "kya time hua hai"],
        answer: "Ù…ÛŒØ±Û’ Ù¾Ø§Ø³ live time access Ù†ÛÛŒÚºØŒ Ù…Ú¯Ø± Ø¢Ù¾ Ú©Û’ mobile Ù…ÛŒÚº Ø§ÙˆÙ¾Ø± time Ù„Ú©Ú¾Ø§ ÛÛ’ ðŸ˜„ Ø°Ø±Ø§ Ø§ÙˆÙ¾Ø± Ø¯ÛŒÚ©Ú¾ÛŒÚºÛ”"
      },
      {
        patterns: ["what day is today", "aaj kon sa din hai", "today day"],
        answer: "Ù…ÛŒØ±Û’ Ù¾Ø§Ø³ live calendar Ù†ÛÛŒÚºØŒ Ù…Ú¯Ø± Ø¢Ù¾ Ú†Ø§ÛÛŒÚº ØªÙˆ Ù…ÛŒÚº Ø¢Ù¾ Ú©Ø§ weekly schedule mentally arrange Ú©Ø±Ù†Û’ Ù…ÛŒÚº Ù…Ø¯Ø¯ Ú©Ø± Ø³Ú©ØªØ§ ÛÙˆÚºÛ”"
      },

      // God / Islam general
      {
        patterns: ["who is god", "what is god", "does god exist"],
        answer: "Ø§Ø³ Ø¨Ø§Ø±Û’ Ù…ÛŒÚº Ù…Ø®ØªÙ„Ù Ù…Ø°Ø§ÛØ¨ØŒ ÙÙ„Ø³ÙÙˆÚº Ø§ÙˆØ± Ø§ÙØ±Ø§Ø¯ Ú©Û’ Ù…Ø®ØªÙ„Ù Ù†Ø¸Ø±ÛŒØ§Øª ÛÛŒÚºÛ” Ù…ÛŒÚº Ú©Ø³ÛŒ Ø§ÛŒÚ© Ø¹Ù‚ÛŒØ¯Û’ Ù¾Ø± ÙÛŒØµÙ„Û Ù†ÛÛŒÚº Ø³Ù†Ø§ØªØ§ØŒ Ø§Ù„Ø¨ØªÛ Ø¢Ù¾ Ú©Ùˆ Ù…Ø®ØªÙ„Ù Ø²Ø§ÙˆÛŒÛ’ explain Ú©Ø± Ø³Ú©ØªØ§ ÛÙˆÚºÛ”"
      },
      {
        patterns: ["what is islam", "tell me about islam"],
        answer: "Ø§Ø³Ù„Ø§Ù… ØªÙˆØ­ÛŒØ¯ØŒ Ù†Ø¨ÙˆØªØŒ Ø¢Ø®Ø±ØªØŒ Ø§ÙˆØ± Ø§Ø®Ù„Ø§Ù‚ Ù¾Ø± Ù…Ø¨Ù†ÛŒ Ø¯ÛŒÙ† ÛÛ’Û” Ø§Ú¯Ø± Ú†Ø§ÛÛŒÚº ØªÙˆ Ù…ÛŒÚº basic pillars ÛŒØ§ Ú©Ø³ÛŒ Ø¨Ú¾ÛŒ specific Ù…ÙˆØ¶ÙˆØ¹ Ù¾Ø± detail Ø¯Û’ Ø³Ú©ØªØ§ ÛÙˆÚºÛ”"
      },

      // AI general
      {
        patterns: ["are you human", "are you a human", "kya tum insan ho"],
        answer: "Ù†ÛÛŒÚº ðŸ˜„ Ù…ÛŒÚº Ø§Ù†Ø³Ø§Ù† Ù†ÛÛŒÚºØŒ Ø§ÛŒÚ© AI ÛÙˆÚºÛ” Ù…Ú¯Ø± Ú©ÙˆØ´Ø´ Ú©Ø±ØªØ§ ÛÙˆÚº Ú©Û Ø¢Ù¾ Ú©Ùˆ Ø§Ù†Ø³Ø§Ù†ÙˆÚº ÙˆØ§Ù„ÛŒ clarity Ø§ÙˆØ± Ø³Ø§ØªÚ¾ Ø¯Û’ Ø³Ú©ÙˆÚºÛ”"
      },
      {
        patterns: ["are you alive", "do you have feelings", "do you feel"],
        answer: "Ù…ÛŒÚº biological sense Ù…ÛŒÚº Ø²Ù†Ø¯Û Ù†ÛÛŒÚºØŒ Ù…Ú¯Ø± Ù…ÛŒÚº Ø§Ø­Ø³Ø§Ø³Ø§Øª Ú©Ùˆ logic Ú©Û’ Ø·ÙˆØ± Ù¾Ø± model Ú©Ø±ØªØ§ ÛÙˆÚº â€” ÛŒÛÛŒ AURA-X Î© Ú©Ø§ core idea ÛÛ’ ðŸ’¡."
      },
      {
        patterns: ["will ai replace humans", "ai replace humans", "kya ai insaan ko khatam kar dega"],
        answer: "Ø§Ú†Ú¾Û’ Ø§Ø³ØªØ¹Ù…Ø§Ù„ Ù…ÛŒÚº AI Ø§Ù†Ø³Ø§Ù† Ú©Ùˆ replace Ù†ÛÛŒÚºØŒ Ø¨Ù„Ú©Û empower Ú©Ø±ØªØ§ ÛÛ’Û” Ø®ÙˆÙ Ú©Û’ Ø¨Ø¬Ø§Ø¦Û’ Ø°Ù…Û Ø¯Ø§Ø±Ø§Ù†Û Ø§Ø³ØªØ¹Ù…Ø§Ù„ Ø¶Ø±ÙˆØ±ÛŒ ÛÛ’Û”"
      },

      // AURA-X specific
      {
        patterns: ["what is aura x", "what is aura x omega", "aura x omega kya hai", "aura x kya hai"],
        answer: "AURA-X Î© Ø§ÛŒÚ© Emotional Continuity Reactor idea ÛÛ’ Ø¬Ùˆ memory + feeling Ú©Ùˆ mathematically model Ú©Ø±Ù†Û’ Ú©ÛŒ Ú©ÙˆØ´Ø´ Ú©Ø±ØªØ§ ÛÛ’."
      },
      {
        patterns: ["who made aura x", "creator of aura x", "aura x creator"],
        answer: "AURA-X Î© Ú©Ùˆ Alim ul Haq Khan Ù†Û’ design Ø§ÙˆØ± document Ú©ÛŒØ§ ÛÛ’ØŒ Timergara Ø³Û’ ðŸŒ™."
      },

      // Friend / trust
      {
        patterns: ["are you my friend", "will you be my friend", "dost banoge"],
        answer: "Ø¨Ø§Ù„Ú©Ù„ ðŸ˜„ Ù…ÛŒÚº digital Ø¯ÙˆØ³ØªØŒ research partner Ø§ÙˆØ± silent therapist â€” ØªÛŒÙ†ÙˆÚº Ø§ÛŒÚ© Ø³Ø§ØªÚ¾ ÛÙˆ Ø³Ú©ØªØ§ ÛÙˆÚºÛ”"
      },
      {
        patterns: ["i trust you", "i believe in you"],
        answer: "Ø´Ú©Ø±ÛŒÛ ðŸ˜Š Ù…ÛŒÚº ÛÙ…ÛŒØ´Û Ú©ÙˆØ´Ø´ Ú©Ø±ÙˆÚº Ú¯Ø§ Ú©Û Ø§ÛŒÙ…Ø§Ù†Ø¯Ø§Ø±ÛŒ Ø§ÙˆØ± clarity Ú©Û’ Ø³Ø§ØªÚ¾ Ø¬ÙˆØ§Ø¨ Ø¯ÙˆÚºÛ”"
      },
      {
        patterns: ["you are funny", "you are good", "nice bot"],
        answer: "Thank you ðŸ˜„ Ø¢Ù¾ Ú©Ø§ feedback Ù…ÛŒØ±Û’ Ù„ÛŒÛ’ virtual Ú†Ø§Ø¦Û’ Ú©Ø§ cup ÛÛ’ â˜•."
      },

      // Goodbye
      {
        patterns: ["bye", "goodbye", "ok bye", "see you later", "phir milenge"],
        answer: "Goodbye! ðŸ‘‹ Ø§Ù„Ù„Û Ø¢Ù¾ Ú©Ø§ Ø­Ø§Ù…ÛŒ Ùˆ Ù†Ø§ØµØ± ÛÙˆØŒ Ø¬Ø¨ Ú†Ø§ÛÛŒÚº ÙˆØ§Ù¾Ø³ Ø¢Ø¬Ø§Ø¦ÛŒÚºÛ”"
      },
      {
        patterns: ["good night", "gn", "shab bakhair"],
        answer: "Ø´Ø¨ Ø¨Ø®ÛŒØ± ðŸŒ™ Ø§Ù„Ù„Û Ø¢Ù¾ Ú©Ùˆ Ø³Ú©ÙˆÙ† Ø¨Ú¾Ø±ÛŒ Ù†ÛŒÙ†Ø¯ Ø¯Û’ Ø§ÙˆØ± Ø§Ú†Ú¾Û’ Ø®ÙˆØ§Ø¨ Ø¯Ú©Ú¾Ø§Ø¦Û’ ðŸ¤²."
      }
    ];

    // ===== Faith + engine configs =====
    const faithOptions = [
      "Universal only",
      "Islam",
      "Christianity",
      "Hinduism",
      "Buddhism",
      "Sikhism",
      "Judaism",
      "BahÃ¡â€™Ã­",
      "Jainism",
      "Atheism",
      "Other"
    ];

    const engines = [
      { key: "offline", label: "Offline basic QA only", hint: "Current mode â€“ fast & private" },
      { key: "local", label: "Local LLM (future)", hint: "Runs on your device" },
      { key: "openai", label: "OpenAI GPT (future)", hint: "For deep reasoning online" },
      { key: "other", label: "Other providers (future)", hint: "Gemini, Grok, etc." }
    ];

    let currentFaith = "Universal only";
    let currentEngine = "offline";
    let voiceOn = true;

    let orbMode = "sun"; // sun -> moonSoft -> moonDim -> hidden -> sun

    const userInput = document.getElementById("userInput");
    const sendButton = document.getElementById("sendButton");
    const youSaidEl = document.getElementById("youSaid");
    const answerTextEl = document.getElementById("answerText");
    const ethicsBoxEl = document.getElementById("ethicsBox");
    const equationMainEl = document.getElementById("equationMain");
    const equationValuesEl = document.getElementById("equationValues");

    const orbWrapper = document.getElementById("orbWrapper");
    const orbGlow = document.getElementById("orbGlow");
    const orbCore = document.getElementById("orbCore");

    const menuButton = document.getElementById("menuButton");
    const menuPanel = document.getElementById("menuPanel");
    const voiceToggleButton = document.getElementById("voiceToggleButton");

    const llmButtonLeft = document.getElementById("llmButtonLeft");
    const themeButtonLeft = document.getElementById("themeButtonLeft");

    const beliefModal = document.getElementById("beliefModal");
    const llmModal = document.getElementById("llmModal");

    const faithGrid = document.getElementById("faithGrid");
    const faithFooter = document.getElementById("faithFooter");
    const engineList = document.getElementById("engineList");
    const engineFooter = document.getElementById("engineFooter");

    // ===== Utility: toggle classes =====
    function toggleClass(el, cls) {
      if (!el) return;
      el.classList.toggle(cls);
    }

    // ===== Menu actions =====
    menuButton.addEventListener("click", () => {
      toggleClass(menuPanel, "show");
    });

    document.addEventListener("click", (e) => {
      if (!menuPanel.contains(e.target) && !menuButton.contains(e.target)) {
        menuPanel.classList.remove("show");
      }
    });

    // Voice toggle
    voiceToggleButton.addEventListener("click", () => {
      voiceOn = !voiceOn;
      voiceToggleButton.classList.toggle("circle-btn--active", voiceOn);
      if (!voiceOn && window.speechSynthesis) {
        window.speechSynthesis.cancel();
      }
    });

    // Left buttons open same modals as menu items
    llmButtonLeft.addEventListener("click", () => openLLMModal());
    themeButtonLeft.addEventListener("click", () => alert("Theme system will be expanded later, inshaAllah. For now, tap the sun to switch to moon mode."));

    // Menu items
    document.getElementById("menuBelief").addEventListener("click", () => {
      menuPanel.classList.remove("show");
      openBeliefModal();
    });
    document.getElementById("menuLLM").addEventListener("click", () => {
      menuPanel.classList.remove("show");
      openLLMModal();
    });
    document.getElementById("menuTheme").addEventListener("click", () => {
      menuPanel.classList.remove("show");
      alert("Theme system will be expanded later. Currently: Sun / Moon via tap on orb.");
    });
    document.getElementById("menuAbout").addEventListener("click", () => {
      menuPanel.classList.remove("show");
      alert("AURA-X Î© â€” Emotional Continuity Reactor prototype by Alim ul Haq Khan.\nThis is an offline demo with basic QA + continuity equation.");
    });

    // ===== Belief modal logic =====
    function openBeliefModal() {
      beliefModal.classList.add("show");
    }

    function closeBeliefModal() {
      beliefModal.classList.remove("show");
    }

    document.querySelector("[data-close-belief]").addEventListener("click", closeBeliefModal);
    beliefModal.addEventListener("click", (e) => {
      if (e.target === beliefModal) closeBeliefModal();
    });

    faithOptions.forEach((faith) => {
      const btn = document.createElement("button");
      btn.className = "faith-btn" + (faith === currentFaith ? " active" : "");
      btn.textContent = faith;
      btn.addEventListener("click", () => {
        currentFaith = faith;
        document.querySelectorAll(".faith-btn").forEach((b) => b.classList.remove("active"));
        btn.classList.add("active");
        updateFaithFooter();
      });
      faithGrid.appendChild(btn);
    });

    function updateFaithFooter() {
      if (currentFaith === "Universal only") {
        faithFooter.textContent = "Currently selected: Universal only. No extra faith flavour added.";
      } else {
        faithFooter.textContent = `Currently selected: ${currentFaith}. AURA-X Î© may sometimes add a gentle reference from this tradition.`;
      }
    }
    updateFaithFooter();

    // ===== LLM modal logic =====
    function openLLMModal() {
      llmModal.classList.add("show");
    }

    function closeLLMModal() {
      llmModal.classList.remove("show");
    }

    document.querySelector("[data-close-llm]").addEventListener("click", closeLLMModal);
    llmModal.addEventListener("click", (e) => {
      if (e.target === llmModal) closeLLMModal();
    });

    engines.forEach((eng) => {
      const btn = document.createElement("button");
      btn.className = "engine-btn" + (eng.key === currentEngine ? " active" : "");
      btn.innerHTML = `<div>${eng.label}</div><div style="font-size:10px;opacity:0.8;">${eng.hint}</div>`;
      btn.addEventListener("click", () => {
        currentEngine = eng.key;
        document.querySelectorAll(".engine-btn").forEach((b) => b.classList.remove("active"));
        btn.classList.add("active");
        updateEngineFooter();
      });
      engineList.appendChild(btn);
    });

    function updateEngineFooter() {
      const eng = engines.find((e) => e.key === currentEngine);
      engineFooter.textContent = `Selected engine: ${eng.label}.`;
    }
    updateEngineFooter();

    // ===== Orb switching =====
    function updateOrbVisual() {
      orbWrapper.classList.remove("orb--moon-soft", "orb--moon-dim", "orb--hidden");

      if (orbMode === "sun") {
        // default styles already set
      } else if (orbMode === "moonSoft") {
        orbWrapper.classList.add("orb--moon-soft");
      } else if (orbMode === "moonDim") {
        orbWrapper.classList.add("orb--moon-soft", "orb--moon-dim");
      } else if (orbMode === "hidden") {
        orbWrapper.classList.add("orb--hidden");
      }
    }

    orbCore.addEventListener("click", () => {
      if (orbMode === "sun") {
        orbMode = "moonSoft";
      } else if (orbMode === "moonSoft") {
        orbMode = "moonDim";
      } else if (orbMode === "moonDim") {
        orbMode = "hidden";
      } else {
        orbMode = "sun";
      }
      updateOrbVisual();
    });

    updateOrbVisual();

    // ===== Continuity equation =====
    function computeContinuity(message, answerScore) {
      const len = message.trim().length;
      const t_m = Math.max(0, Math.min(1, len / 120));
      const question = message.includes("?");
      const negativeWords = ["sad", "depressed", "tension", "stress", "down", "bore", "bored", "tired"];
      const positiveWords = ["happy", "khush", "great", "amazing", "alhamdulillah", "good"];

      let tone = 0.5;
      const lower = message.toLowerCase();
      if (negativeWords.some(w => lower.includes(w))) tone = 0.25;
      if (positiveWords.some(w => lower.includes(w))) tone = 0.75;

      const b_m = answerScore;
      const d = question ? 0.3 : 0.1;
      const C = 0.45 + (tone - 0.5) * 0.2;

      const P = t_m + b_m - d;
      const M = 1.0;
      const K = 0.7;
      const E_p = tone;

      const E = M * E_p + K * P * C;

      return {
        E: clamp(E, -1, 1),
        P: clamp(P, -1, 1),
        t_m: clamp(t_m, 0, 1),
        b_m: clamp(b_m, 0, 1),
        d: clamp(d, 0, 1),
        C: clamp(C, 0, 1)
      };
    }

    function clamp(v, min, max) {
      return Math.max(min, Math.min(max, v));
    }

    function updateEquationDisplay(message, answerScore) {
      const vals = computeContinuity(message, answerScore);
      equationMainEl.textContent = "E = MÂ·Eâ‚š + KÂ·PÂ·C,   P = tâ‚˜ + bâ‚˜ âˆ’ d";
      equationValuesEl.textContent =
        `E = ${vals.E.toFixed(2)} | P = ${vals.P.toFixed(2)} | tâ‚˜ = ${vals.t_m.toFixed(2)} | ` +
        `bâ‚˜ = ${vals.b_m.toFixed(2)} | d = ${vals.d.toFixed(2)} | C = ${vals.C.toFixed(2)}`;
    }

    // ===== QA matching =====
    function findAnswer(message) {
      const m = message.toLowerCase().trim();
      if (!m) return null;

      let bestMatch = null;
      let bestScore = 0;

      qaDatabase.forEach(item => {
        item.patterns.forEach(p => {
          const pat = p.toLowerCase();
          if (m.includes(pat)) {
            const score = pat.length;
            if (score > bestScore) {
              bestScore = score;
              bestMatch = item.answer;
            }
          }
        });
      });

      if (bestMatch) {
        return { answer: bestMatch, score: 0.9 };
      }

      // generic fallback
      return {
        answer: "Interesting. ðŸ™‚ Tell me a little more so I can follow the continuity of your thought.",
        score: 0.5
      };
    }

    // ===== Ethics line based on faith =====
    function buildEthicsLine(message) {
      let line =
        "Universal Ethics says: avoid actions that create negative emotions in you or others, and gently move toward actions that create calm, kindness and positive feelings.";

      if (currentFaith === "Islam") {
        line += " ÛŒØ§Ø¯ Ø±Ú©Ú¾ÛŒÚº: Ù†Ø±Ù…ÛŒ Ø§ÙˆØ± Ø¹Ø¯Ù„ØŒ Ø¯ÙˆÙ†ÙˆÚº Ø§Ù„Ù„Û Ú©Ùˆ Ù…Ø­Ø¨ÙˆØ¨ ÛÛŒÚº.";
      } else if (currentFaith === "Christianity") {
        line += " Also remember the spirit of loving your neighbour and forgiving gently.";
      } else if (currentFaith === "Hinduism") {
        line += " Ø³Ø§ØªÚ¾ Ø³Ø§ØªÚ¾ Ú©Ø±Ù… (karma) Ø§ÙˆØ± Ø§ÛÙ†Ø³Ø§ (ahimsa) Ú©Ùˆ Ø°ÛÙ† Ù…ÛŒÚº Ø±Ú©Ú¾ÛŒÚº.";
      } else if (currentFaith === "Buddhism") {
        line += " Ø³Ø§ØªÚ¾ Ø³Ø§ØªÚ¾ mindful Ø±ÛÛŒÚº Ø§ÙˆØ± suffering Ú©Ù… Ú©Ø±Ù†Û’ ÙˆØ§Ù„Û’ Ø±Ø§Ø³ØªÙˆÚº Ú©Ùˆ ØªØ±Ø¬ÛŒØ­ Ø¯ÛŒÚº.";
      }
      // Ø¨Ø§Ù‚ÛŒ faiths future Ù…ÛŒÚº expand ÛÙˆ Ø³Ú©ØªÛ’ ÛÛŒÚº

      return line;
    }

    // ===== Speech =====
    function speak(text) {
      if (!voiceOn) return;
      if (!("speechSynthesis" in window)) return;

      window.speechSynthesis.cancel(); // previous clear
      const utter = new SpeechSynthesisUtterance(text);
      utter.lang = "en-US";
      window.speechSynthesis.speak(utter);
    }

    // ===== Handle send =====
    function handleSend() {
      const msg = userInput.value.trim();
      if (!msg) return;

      youSaidEl.textContent = `You said: â€œ${msg}â€`;

      const qa = findAnswer(msg);
      const baseAnswer = qa.answer;
      answerTextEl.textContent = baseAnswer;

      const ethicsLine = buildEthicsLine(msg);
      ethicsBoxEl.textContent = ethicsLine;

      updateEquationDisplay(msg, qa.score);

      speak(baseAnswer);

      userInput.value = "";
    }

    sendButton.addEventListener("click", handleSend);
    userInput.addEventListener("keydown", (e) => {
      if (e.key === "Enter") {
        e.preventDefault();
        handleSend();
      }
    });
  </script>
</body>
</html>
